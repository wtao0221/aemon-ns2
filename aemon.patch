diff -uNr ./ns-allinone-2.34/ns-2.34/autoconf.h ./ori-ns-allinone-2.34/ns-2.34/autoconf.h
--- ./ns-allinone-2.34/ns-2.34/autoconf.h	2017-02-22 17:05:35.022233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/autoconf.h	1970-01-01 08:00:00.000000000 +0800
@@ -1,98 +0,0 @@
-/* autoconf.h.  Generated from autoconf.h.in by configure.  */
-/* -*-	Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t -*- */
-/*
- * Copyright (c) 1997 University of Southern California.
- * All rights reserved.                                            
- *                                                                
- * Redistribution and use in source and binary forms are permitted
- * provided that the above copyright notice and this paragraph are
- * duplicated in all such forms and that any documentation, advertising
- * materials, and other materials related to such distribution and use
- * acknowledge that the software was developed by the University of
- * Southern California, Information Sciences Institute.  The name of the
- * University may not be used to endorse or promote products derived from
- * this software without specific prior written permission.
- * 
- * THIS SOFTWARE IS PROVIDED "AS IS" AND WITHOUT ANY EXPRESS OR IMPLIED
- * WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
- * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
- *
- */
-
-/* This file should contain variables changed only by autoconf. */
-
-#define NSPERL_PATH "@PERL@"
-#define NSTCLSH_PATH "@V_TCLSH@"
-
-/* If you need these from tcl, see the file tcl/lib/ns-autoconf.tcl.in */
-
-/*
- * Put autoconf #define's here to keep them off the command line.
- * see autoconf.info(Header Templates) in the autoconf docs.
- */
-
-#define _GNU_SOURCE 1
-
-/* what does random(3) return? */
-#define RANDOM_RETURN_TYPE long
-
-/* type definitions */
-/* #undef int8_t */
-/* #undef int16_t */
-/* #undef int32_t */
-/* #undef u_int8_t */
-/* #undef u_int16_t */
-/* #undef u_int32_t */
-
-/* 64-bits */
-#define HAVE_INT64 1
-#define SIZEOF_LONG 8
-/* #undef int64_t */
-
-/* socklen_t (for nse) */
-#define HAVE_SOCKLEN_T 1
-
-/* functions */
-#define HAVE_BCOPY 1
-#define HAVE_BZERO 1
-#define HAVE_GETRUSAGE 1
-#define HAVE_SBRK 1
-#define HAVE_SNPRINTF 1
-#define HAVE_STRTOLL 1
-#define HAVE_STRTOQ 1
-/* #undef HAVE_ADDR2ASCII */
-#define HAVE_FEENABLEEXCEPT 1
-
-/* headers */
-#define STDC_HEADERS 1
-#define HAVE_STRING_H 1
-#define HAVE_STRINGS_H 1
-#define HAVE_ARPA_INET_H 1
-#define HAVE_NETINET_IN_H 1
-#define HAVE_NET_ETHERNET_H 1
-#define HAVE_FENV_H 1
-
-/* structures */
-#define HAVE_ETHER_HEADER_STRUCT 1
-#define HAVE_ETHER_ADDRESS_STRUCT 1
-
-/* constants */
-#define HAVE_SIOCGIFHWADDR 1
-
-
-/* stl */
-#ifdef __cplusplus
-#define HAVE_STL 1
-
-#define CPP_REQUIRES_NAMESPACE 1
-#ifdef CPP_REQUIRES_NAMESPACE
-
-#ifndef CPP_NAMESPACE
-#define CPP_NAMESPACE std
-#endif
-
-
-using namespace CPP_NAMESPACE;
-#endif /* CPP_NAMESPACE */
-#endif /* __cplusplus */
-
diff -uNr ./ns-allinone-2.34/ns-2.34/classifier/classifier-mpath.cc ./ori-ns-allinone-2.34/ns-2.34/classifier/classifier-mpath.cc
--- ./ns-allinone-2.34/ns-2.34/classifier/classifier-mpath.cc	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/classifier/classifier-mpath.cc	2017-06-17 16:05:28.594083572 +0800
@@ -1,5 +1,4 @@
-/* -*- Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t
-              -*- */
+/* -*-	Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t -*- */
 
 /*
  * Copyright (C) 1997 by the University of Southern California
@@ -51,106 +50,21 @@
 #endif
 
 #include "classifier.h"
-#include "ip.h"
 
 class MultiPathForwarder : public Classifier {
 public:
-  MultiPathForwarder() : ns_(0), nodeid_(0), nodetype_(0), perflow_(0), checkpathid_(0) {
-		bind("nodeid_", &nodeid_); 
-		bind("nodetype_", &nodetype_);
-		bind("perflow_", &perflow_);
-		bind("checkpathid_", &checkpathid_);
-	} 
-	virtual int classify(Packet* p) {
-      		int cl;
-		hdr_ip* h = hdr_ip::access(p);
-		// Mohammad: multipath support
-		// fprintf(stdout, "perflow_ = %d, rcv packet in classifier\n", perflow_);
-		if (perflow_ || checkpathid_) {		  
-		  /*if (h->flowid() >= 10000000) {
-		  	int fail = ns_;
-			do {
-			  cl = ns_++;
-			  ns_ %= (maxslot_ + 1);
-			} while (slot_[cl] == 0 && ns_ != fail);		
-			return cl;
-			}*/
-		  
-		struct hkey {
-			int nodeid;
-       			nsaddr_t src, dst;
-			int fid;
-		};
-		struct hkey buf_;		
-		buf_.nodeid = nodeid_;
-		buf_.src = mshift(h->saddr());
-		buf_.dst = mshift(h->daddr());
-		buf_.fid = h->flowid();
-		/*if (checkpathid_)
-			buf_.prio = h->prio();
-		else
-		buf_.prio = 0;*/
-		char* bufString = (char*) &buf_;
-		int length = sizeof(hkey);
-
-		unsigned int ms_ = (unsigned int) HashString(bufString, length);
-		if (checkpathid_) {
-		  int pathNum = h->prio();
-		  int pathDig;
-		  for (int i = 0; i < nodetype_; i++) {
-		    pathDig = pathNum % 8;
-		    pathNum /= 8;
-		  }
-		  //printf("%d: %d->%d\n", nodetype_, h->prio(), pathDig);
-		  ms_ += h->prio(); //pathDig;
-		}
-		ms_ %= (maxslot_ + 1);
-		//printf("nodeid = %d, pri = %d, ms = %d\n", nodeid_, buf_.prio, ms_);
-		int fail = ms_;
-		do {
-			cl = ms_++;
-			ms_ %= (maxslot_ + 1);
-		} while (slot_[cl] == 0 && ms_ != fail);
-		//printf("nodeid = %d, pri = %d, cl = %d\n", nodeid_, h->prio(), cl);
-		}
-
-		else {
-		  //hdr_ip* h = hdr_ip::access(p);
-		  //if (h->flowid() == 45) {
-		  //cl = h->prio() % (maxslot_ + 1); 
-		  //}
-		  //else {
+	MultiPathForwarder() : ns_(0) {} 
+	virtual int classify(Packet*) {
+		int cl;
 		int fail = ns_;
 		do {
 			cl = ns_++;
 			ns_ %= (maxslot_ + 1);
 		} while (slot_[cl] == 0 && ns_ != fail);
-		}
-		//}
-	
-		
 		return cl;
 	}
 private:
 	int ns_;
-	// Mohamamd: adding support for perflow multipath
-	int nodeid_;
-        int nodetype_;
-	int perflow_;
-	int checkpathid_;
-
-	static unsigned int
-	HashString(register const char *bytes,int length)
-	{
-		register unsigned int result;
-		register int i;
-
-		result = 0;
-		for (i = 0;  i < length;  i++) {
-			result += (result<<3) + *bytes++;
-		}
-		return result;
-	}
 };
 
 static class MultiPathClass : public TclClass {
diff -uNr ./ns-allinone-2.34/ns-2.34/common/ip.h ./ori-ns-allinone-2.34/ns-2.34/common/ip.h
--- ./ns-allinone-2.34/ns-2.34/common/ip.h	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/common/ip.h	2017-06-17 16:05:28.642059568 +0800
@@ -61,14 +61,6 @@
 	ns_addr_t	dst_;
 	int		ttl_;
 
-	/* Mohammad: flag to indicate 
-	 * the last TCP ack for this flow 
-	 * had EcnEcho set. This is used by 
-	 * TBF to determin if flow should be 
-	 *paced. */
-	int             gotecnecho;
-	//abd
-
 	/* Monarch extn */
 // 	u_int16_t	sport_;
 // 	u_int16_t	dport_;
@@ -76,7 +68,6 @@
 	/* IPv6 */
 	int		fid_;	/* flow id */
 	int		prio_;
-	int 	prio_type_; //Shuang
 
 	static int offset_;
 	inline static int& offset() { return offset_; }
@@ -96,7 +87,6 @@
 	/* ipv6 fields */
 	int& flowid() { return (fid_); }
 	int& prio() { return (prio_); }
-	int& prio_type() {return (prio_type_); }
 };
 
 #endif
Binary files ./ns-allinone-2.34/ns-2.34/common/main-monolithic.o and ./ori-ns-allinone-2.34/ns-2.34/common/main-monolithic.o differ
diff -uNr ./ns-allinone-2.34/ns-2.34/config.log ./ori-ns-allinone-2.34/ns-2.34/config.log
--- ./ns-allinone-2.34/ns-2.34/config.log	2017-02-22 17:05:35.066233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/config.log	1970-01-01 08:00:00.000000000 +0800
@@ -1,2367 +0,0 @@
-This file contains any messages produced by compilers while
-running configure, to aid debugging if configure makes a mistake.
-
-It was created by configure, which was
-generated by GNU Autoconf 2.63.  Invocation command line was
-
-  $ ./configure --with-otcl=../otcl-1.13 --with-tclcl=../tclcl-1.19
-
-## --------- ##
-## Platform. ##
-## --------- ##
-
-hostname = vb
-uname -m = x86_64
-uname -r = 3.16.0-77-generic
-uname -s = Linux
-uname -v = #99~14.04.1-Ubuntu SMP Tue Jun 28 19:17:10 UTC 2016
-
-/usr/bin/uname -p = unknown
-/bin/uname -X     = unknown
-
-/bin/arch              = unknown
-/usr/bin/arch -k       = unknown
-/usr/convex/getsysinfo = unknown
-/usr/bin/hostinfo      = unknown
-/bin/machine           = unknown
-/usr/bin/oslevel       = unknown
-/bin/universe          = unknown
-
-PATH: /home/wtao/project-dct-build/ns-allinone-2.34/tcl8.4.18/unix
-PATH: /home/wtao/project-dct-build/ns-allinone-2.34/tk8.4.18/unix
-PATH: /home/wtao/project-dct-build/ns-allinone-2.34/bin
-PATH: /usr/local/sbin
-PATH: /usr/local/bin
-PATH: /usr/sbin
-PATH: /usr/bin
-PATH: /sbin
-PATH: /bin
-PATH: /usr/games
-PATH: /usr/local/games
-PATH: /home/wtao/project-dct-build/ns-allinone-2.34/bin
-PATH: /home/wtao/project-dct-build/ns-allinone-2.34/tcl8.4.18/unix
-PATH: /home/wtao/project-dct-build/ns-allinone-2.34/tk8.4.18/unix
-
-
-## ----------- ##
-## Core tests. ##
-## ----------- ##
-
-configure:1933: checking for gcc
-configure:1949: found /usr/bin/gcc
-configure:1960: result: gcc
-configure:2192: checking for C compiler version
-configure:2200: gcc --version >&5
-gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4
-Copyright (C) 2013 Free Software Foundation, Inc.
-This is free software; see the source for copying conditions.  There is NO
-warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-
-configure:2204: $? = 0
-configure:2211: gcc -v >&5
-Using built-in specs.
-COLLECT_GCC=gcc
-COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
-Target: x86_64-linux-gnu
-Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.8.4-2ubuntu1~14.04.3' --with-bugurl=file:///usr/share/doc/gcc-4.8/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.8 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.8 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-libmudflap --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.8-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
-Thread model: posix
-gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3) 
-configure:2215: $? = 0
-configure:2222: gcc -V >&5
-gcc: error: unrecognized command line option '-V'
-gcc: fatal error: no input files
-compilation terminated.
-configure:2226: $? = 4
-configure:2249: checking for C compiler default output file name
-configure:2271: gcc    conftest.c  >&5
-configure:2275: $? = 0
-configure:2313: result: a.out
-configure:2332: checking whether the C compiler works
-configure:2342: ./a.out
-configure:2346: $? = 0
-configure:2365: result: yes
-configure:2372: checking whether we are cross compiling
-configure:2374: result: no
-configure:2377: checking for suffix of executables
-configure:2384: gcc -o conftest    conftest.c  >&5
-configure:2388: $? = 0
-configure:2414: result: 
-configure:2420: checking for suffix of object files
-configure:2446: gcc -c   conftest.c >&5
-configure:2450: $? = 0
-configure:2475: result: o
-configure:2479: checking whether we are using the GNU C compiler
-configure:2508: gcc -c   conftest.c >&5
-configure:2515: $? = 0
-configure:2532: result: yes
-configure:2541: checking whether gcc accepts -g
-configure:2571: gcc -c -g  conftest.c >&5
-configure:2578: $? = 0
-configure:2679: result: yes
-configure:2696: checking for gcc option to accept ISO C89
-configure:2770: gcc  -c -g -O2  conftest.c >&5
-configure:2777: $? = 0
-configure:2800: result: none needed
-configure:2824: checking how to run the C preprocessor
-configure:2864: gcc -E  conftest.c
-configure:2871: $? = 0
-configure:2902: gcc -E  conftest.c
-conftest.c:8:28: fatal error: ac_nonexistent.h: No such file or directory
- #include <ac_nonexistent.h>
-                            ^
-compilation terminated.
-configure:2909: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| /* end confdefs.h.  */
-| #include <ac_nonexistent.h>
-configure:2942: result: gcc -E
-configure:2971: gcc -E  conftest.c
-configure:2978: $? = 0
-configure:3009: gcc -E  conftest.c
-conftest.c:8:28: fatal error: ac_nonexistent.h: No such file or directory
- #include <ac_nonexistent.h>
-                            ^
-compilation terminated.
-configure:3016: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| /* end confdefs.h.  */
-| #include <ac_nonexistent.h>
-configure:3056: checking for grep that handles long lines and -e
-configure:3116: result: /bin/grep
-configure:3121: checking for egrep
-configure:3185: result: /bin/grep -E
-configure:3190: checking for ANSI C header files
-configure:3220: gcc -c -g -O2  conftest.c >&5
-configure:3227: $? = 0
-configure:3326: gcc -o conftest -g -O2   conftest.c  >&5
-configure:3330: $? = 0
-configure:3336: ./conftest
-configure:3340: $? = 0
-configure:3358: result: yes
-configure:3382: checking for sys/types.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for sys/stat.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for stdlib.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for string.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for memory.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for strings.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for inttypes.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for stdint.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3382: checking for unistd.h
-configure:3403: gcc -c -g -O2  conftest.c >&5
-configure:3410: $? = 0
-configure:3427: result: yes
-configure:3452: checking minix/config.h usability
-configure:3469: gcc -c -g -O2  conftest.c >&5
-conftest.c:51:26: fatal error: minix/config.h: No such file or directory
- #include <minix/config.h>
-                          ^
-compilation terminated.
-configure:3476: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| #include <minix/config.h>
-configure:3490: result: no
-configure:3494: checking minix/config.h presence
-configure:3509: gcc -E  conftest.c
-conftest.c:18:26: fatal error: minix/config.h: No such file or directory
- #include <minix/config.h>
-                          ^
-compilation terminated.
-configure:3516: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| /* end confdefs.h.  */
-| #include <minix/config.h>
-configure:3530: result: no
-configure:3558: checking for minix/config.h
-configure:3565: result: no
-configure:3596: checking whether it is safe to define __EXTENSIONS__
-configure:3624: gcc -c -g -O2  conftest.c >&5
-configure:3631: $? = 0
-configure:3646: result: yes
-configure:3785: checking build system type
-configure:3803: result: x86_64-unknown-linux-gnu
-configure:3825: checking host system type
-configure:3840: result: x86_64-unknown-linux-gnu
-configure:3862: checking target system type
-configure:3877: result: x86_64-unknown-linux-gnu
-configure:3954: checking for gcc
-configure:3981: result: gcc
-configure:4213: checking for C compiler version
-configure:4221: gcc --version >&5
-gcc (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4
-Copyright (C) 2013 Free Software Foundation, Inc.
-This is free software; see the source for copying conditions.  There is NO
-warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-
-configure:4225: $? = 0
-configure:4232: gcc -v >&5
-Using built-in specs.
-COLLECT_GCC=gcc
-COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
-Target: x86_64-linux-gnu
-Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.8.4-2ubuntu1~14.04.3' --with-bugurl=file:///usr/share/doc/gcc-4.8/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.8 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.8 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-libmudflap --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.8-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
-Thread model: posix
-gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3) 
-configure:4236: $? = 0
-configure:4243: gcc -V >&5
-gcc: error: unrecognized command line option '-V'
-gcc: fatal error: no input files
-compilation terminated.
-configure:4247: $? = 4
-configure:4250: checking whether we are using the GNU C compiler
-configure:4303: result: yes
-configure:4312: checking whether gcc accepts -g
-configure:4450: result: yes
-configure:4467: checking for gcc option to accept ISO C89
-configure:4571: result: none needed
-configure:4647: checking for g++
-configure:4663: found /usr/bin/g++
-configure:4674: result: g++
-configure:4701: checking for C++ compiler version
-configure:4709: g++ --version >&5
-g++ (Ubuntu 4.8.4-2ubuntu1~14.04.3) 4.8.4
-Copyright (C) 2013 Free Software Foundation, Inc.
-This is free software; see the source for copying conditions.  There is NO
-warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
-
-configure:4713: $? = 0
-configure:4720: g++ -v >&5
-Using built-in specs.
-COLLECT_GCC=g++
-COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/4.8/lto-wrapper
-Target: x86_64-linux-gnu
-Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.8.4-2ubuntu1~14.04.3' --with-bugurl=file:///usr/share/doc/gcc-4.8/README.Bugs --enable-languages=c,c++,java,go,d,fortran,objc,obj-c++ --prefix=/usr --program-suffix=-4.8 --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --with-gxx-include-dir=/usr/include/c++/4.8 --libdir=/usr/lib --enable-nls --with-sysroot=/ --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --enable-gnu-unique-object --disable-libmudflap --enable-plugin --with-system-zlib --disable-browser-plugin --enable-java-awt=gtk --enable-gtk-cairo --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64/jre --enable-java-home --with-jvm-root-dir=/usr/lib/jvm/java-1.5.0-gcj-4.8-amd64 --with-jvm-jar-dir=/usr/lib/jvm-exports/java-1.5.0-gcj-4.8-amd64 --with-arch-directory=amd64 --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --enable-objc-gc --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --with-tune=generic --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
-Thread model: posix
-gcc version 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3) 
-configure:4724: $? = 0
-configure:4731: g++ -V >&5
-g++: error: unrecognized command line option '-V'
-g++: fatal error: no input files
-compilation terminated.
-configure:4735: $? = 4
-configure:4738: checking whether we are using the GNU C++ compiler
-configure:4767: g++ -c   conftest.cpp >&5
-configure:4774: $? = 0
-configure:4791: result: yes
-configure:4800: checking whether g++ accepts -g
-configure:4830: g++ -c -g  conftest.cpp >&5
-configure:4837: $? = 0
-configure:4938: result: yes
-configure:4961: checking for ANSI C header files
-configure:5129: result: yes
-configure:5144: checking for string.h
-configure:5151: result: yes
-configure:5295: checking for main in -lXbsd
-configure:5324: gcc -o conftest -g -O2   conftest.c -lXbsd   >&5
-/usr/bin/ld: cannot find -lXbsd
-collect2: error: ld returned 1 exit status
-configure:5331: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| /* end confdefs.h.  */
-| 
-| 
-| int
-| main ()
-| {
-| return main ();
-|   ;
-|   return 0;
-| }
-configure:5352: result: no
-configure:5358: checking for socket in -lsocket
-configure:5393: gcc -o conftest -g -O2   conftest.c -lsocket   >&5
-/usr/bin/ld: cannot find -lsocket
-collect2: error: ld returned 1 exit status
-configure:5400: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| /* end confdefs.h.  */
-| 
-| /* Override any GCC internal prototype to avoid an error.
-|    Use char because int might match the return type of a GCC
-|    builtin and then its argument prototype would still apply.  */
-| #ifdef __cplusplus
-| extern "C"
-| #endif
-| char socket ();
-| int
-| main ()
-| {
-| return socket ();
-|   ;
-|   return 0;
-| }
-configure:5421: result: no
-configure:5427: checking for gethostbyname in -lnsl
-configure:5462: gcc -o conftest -g -O2   conftest.c -lnsl   >&5
-configure:5469: $? = 0
-configure:5490: result: yes
-configure:5496: checking for dcgettext in -lintl
-configure:5531: gcc -o conftest -g -O2   conftest.c -lintl   >&5
-conftest.c:32:6: warning: conflicting types for built-in function 'dcgettext' [enabled by default]
- char dcgettext ();
-      ^
-/usr/bin/ld: cannot find -lintl
-collect2: error: ld returned 1 exit status
-configure:5538: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| /* end confdefs.h.  */
-| 
-| /* Override any GCC internal prototype to avoid an error.
-|    Use char because int might match the return type of a GCC
-|    builtin and then its argument prototype would still apply.  */
-| #ifdef __cplusplus
-| extern "C"
-| #endif
-| char dcgettext ();
-| int
-| main ()
-| {
-| return dcgettext ();
-|   ;
-|   return 0;
-| }
-configure:5559: result: no
-configure:5565: checking for getnodebyname in -ldnet_stub
-configure:5600: gcc -o conftest -g -O2   conftest.c -ldnet_stub   >&5
-/usr/bin/ld: cannot find -ldnet_stub
-collect2: error: ld returned 1 exit status
-configure:5607: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| /* end confdefs.h.  */
-| 
-| /* Override any GCC internal prototype to avoid an error.
-|    Use char because int might match the return type of a GCC
-|    builtin and then its argument prototype would still apply.  */
-| #ifdef __cplusplus
-| extern "C"
-| #endif
-| char getnodebyname ();
-| int
-| main ()
-| {
-| return getnodebyname ();
-|   ;
-|   return 0;
-| }
-configure:5628: result: no
-configure:5674: checking that g++ can handle -O2
-configure:5705: gcc -c -g -O2  conftest.c >&5
-configure:5712: $? = 0
-configure:5717: result: yes
-configure:5841: checking if C++ libraries work without any namespace
-configure:5867: g++ -c -g -O2  conftest.cpp >&5
-conftest.cpp: In function 'int main()':
-conftest.cpp:30:1: error: 'cout' was not declared in this scope
- cout.fail();
- ^
-conftest.cpp:30:1: note: suggested alternative:
-In file included from conftest.cpp:25:0:
-/usr/include/c++/4.8/iostream:61:18: note:   'std::cout'
-   extern ostream cout;  /// Linked to standard output
-                  ^
-configure:5874: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| /* end confdefs.h.  */
-| #include <iostream>
-| 
-| int
-| main ()
-| {
-| cout.fail();
-| 
-|   ;
-|   return 0;
-| }
-configure:5887: result: no
-configure:5896: checking if C++ libraries work with namespace std
-configure:5922: g++ -c -g -O2  conftest.cpp >&5
-configure:5929: $? = 0
-configure:5934: result: yes
-configure:5952: checking if STL works without any namespace
-configure:5977: g++ -c -g -O2  conftest.cpp >&5
-conftest.cpp: In function 'int main()':
-conftest.cpp:30:1: error: 'list' was not declared in this scope
- list<int> test;
- ^
-conftest.cpp:30:1: note: suggested alternative:
-In file included from /usr/include/c++/4.8/list:63:0,
-                 from conftest.cpp:25:
-/usr/include/c++/4.8/bits/stl_list.h:438:11: note:   'std::list'
-     class list : protected _List_base<_Tp, _Alloc>
-           ^
-conftest.cpp:30:6: error: expected primary-expression before 'int'
- list<int> test;
-      ^
-conftest.cpp:30:6: error: expected ';' before 'int'
-configure:5984: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| /* end confdefs.h.  */
-| #include <list>
-| 
-| int
-| main ()
-| {
-| list<int> test;
-| 
-|   ;
-|   return 0;
-| }
-configure:5997: result: no
-configure:6006: checking if STL works with namespace std
-configure:6032: g++ -c -g -O2  conftest.cpp >&5
-configure:6039: $? = 0
-configure:6044: result: yes
-configure:6123: checking should use STL
-configure:6147: result: yes
-configure:6394: checking for tcl.h
-configure:6447: result: -I../include
-configure:6453: checking for tclInt.h
-configure:6506: result: -I../include
-configure:6512: checking for libtcl8.4
-configure:6576: result: -L../lib -ltcl8.4
-configure:6582: checking for init.tcl
-configure:6621: result: ../lib/tcl8.4
-configure:6638: checking for http.tcl
-configure:6677: result: ../lib/tcl8.4/http1.0
-configure:6682: checking Tcl http.tcl library
-configure:6686: result: yes
-configure:6709: checking for tclsh8.4.18
-configure:6742: result: no
-configure:6709: checking for tclsh8.4
-configure:6727: found ../bin/tclsh8.4
-configure:6739: result: ../bin/tclsh8.4
-configure:6979: checking for tk.h
-configure:7032: result: -I../include
-configure:7038: checking for libtk8.4
-configure:7102: result: -L../lib -ltk8.4
-configure:7108: checking for tk.tcl
-configure:7147: result: ../lib/tk8.4
-configure:7246: checking for otcl.h
-configure:7299: result: -I../otcl-1.13
-configure:7305: checking for libotcl1.13
-configure:7369: result: -L../otcl-1.13 -lotcl
-configure:7496: checking for tclcl.h
-configure:7549: result: -I../tclcl-1.19
-configure:7555: checking for libtclcl
-configure:7619: result: -L../tclcl-1.19 -ltclcl
-configure:7625: checking for tcl2c++
-configure:7664: result: ../tclcl-1.19
-configure:7872: gcc -E  conftest.c
-configure:7879: $? = 0
-configure:7913: checking for XOpenDisplay in -lX11
-configure:7948: gcc -o conftest -g -O2   conftest.c -lX11   >&5
-configure:7955: $? = 0
-configure:7976: result: yes
-configure:8002: checking for XShmAttach in -lXext
-configure:8037: gcc -o conftest -g -O2   conftest.c -lXext -lX11  >&5
-configure:8044: $? = 0
-configure:8065: result: yes
-configure:8136: checking for libtcldbg
-configure:8181: result: no
-configure:8291: checking dmalloc
-configure:8293: result: not requested with --with-dmalloc
-configure:8574: checking for perl
-configure:8613: result: /usr/bin
-/usr/bin/perl -e require 5.002
-configure:8722: checking for ANSI C header files
-configure:8890: result: yes
-configure:8924: checking arpa/inet.h usability
-configure:8941: gcc -c -g -O2  conftest.c >&5
-configure:8948: $? = 0
-configure:8962: result: yes
-configure:8966: checking arpa/inet.h presence
-configure:8981: gcc -E  conftest.c
-configure:8988: $? = 0
-configure:9002: result: yes
-configure:9030: checking for arpa/inet.h
-configure:9039: result: yes
-configure:8924: checking fenv.h usability
-configure:8941: gcc -c -g -O2  conftest.c >&5
-configure:8948: $? = 0
-configure:8962: result: yes
-configure:8966: checking fenv.h presence
-configure:8981: gcc -E  conftest.c
-configure:8988: $? = 0
-configure:9002: result: yes
-configure:9030: checking for fenv.h
-configure:9039: result: yes
-configure:8924: checking netinet/in.h usability
-configure:8941: gcc -c -g -O2  conftest.c >&5
-configure:8948: $? = 0
-configure:8962: result: yes
-configure:8966: checking netinet/in.h presence
-configure:8981: gcc -E  conftest.c
-configure:8988: $? = 0
-configure:9002: result: yes
-configure:9030: checking for netinet/in.h
-configure:9039: result: yes
-configure:8913: checking for string.h
-configure:8920: result: yes
-configure:8913: checking for strings.h
-configure:8920: result: yes
-configure:8924: checking time.h usability
-configure:8941: gcc -c -g -O2  conftest.c >&5
-configure:8948: $? = 0
-configure:8962: result: yes
-configure:8966: checking time.h presence
-configure:8981: gcc -E  conftest.c
-configure:8988: $? = 0
-configure:9002: result: yes
-configure:9030: checking for time.h
-configure:9039: result: yes
-configure:8913: checking for unistd.h
-configure:8920: result: yes
-configure:8924: checking net/ethernet.h usability
-configure:8941: gcc -c -g -O2  conftest.c >&5
-configure:8948: $? = 0
-configure:8962: result: yes
-configure:8966: checking net/ethernet.h presence
-configure:8981: gcc -E  conftest.c
-configure:8988: $? = 0
-configure:9002: result: yes
-configure:9030: checking for net/ethernet.h
-configure:9039: result: yes
-configure:9055: checking for main in -lm
-configure:9084: gcc -o conftest -g -O2   conftest.c -lm   >&5
-configure:9091: $? = 0
-configure:9112: result: yes
-configure:9137: checking for bcopy
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-conftest.c:69:6: warning: conflicting types for built-in function 'bcopy' [enabled by default]
- char bcopy ();
-      ^
-configure:9200: $? = 0
-configure:9222: result: yes
-configure:9137: checking for bzero
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-conftest.c:70:6: warning: conflicting types for built-in function 'bzero' [enabled by default]
- char bzero ();
-      ^
-configure:9200: $? = 0
-configure:9222: result: yes
-configure:9137: checking for fesetprecision
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-/tmp/ccHFaWbR.o: In function `main':
-/home/wtao/project-dct-build/ns-allinone-2.34/ns-2.34/conftest.c:82: undefined reference to `fesetprecision'
-collect2: error: ld returned 1 exit status
-configure:9200: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| /* end confdefs.h.  */
-| /* Define fesetprecision to an innocuous variant, in case <limits.h> declares fesetprecision.
-|    For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-| #define fesetprecision innocuous_fesetprecision
-| 
-| /* System header to define __stub macros and hopefully few prototypes,
-|     which can conflict with char fesetprecision (); below.
-|     Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-|     <limits.h> exists even on freestanding compilers.  */
-| 
-| #ifdef __STDC__
-| # include <limits.h>
-| #else
-| # include <assert.h>
-| #endif
-| 
-| #undef fesetprecision
-| 
-| /* Override any GCC internal prototype to avoid an error.
-|    Use char because int might match the return type of a GCC
-|    builtin and then its argument prototype would still apply.  */
-| #ifdef __cplusplus
-| extern "C"
-| #endif
-| char fesetprecision ();
-| /* The GNU C library defines this for functions which it implements
-|     to always fail with ENOSYS.  Some functions are actually named
-|     something starting with __ and the normal name is an alias.  */
-| #if defined __stub_fesetprecision || defined __stub___fesetprecision
-| choke me
-| #endif
-| 
-| int
-| main ()
-| {
-| return fesetprecision ();
-|   ;
-|   return 0;
-| }
-configure:9222: result: no
-configure:9137: checking for feenableexcept
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:9200: $? = 0
-configure:9222: result: yes
-configure:9137: checking for getrusage
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:9200: $? = 0
-configure:9222: result: yes
-configure:9137: checking for sbrk
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:9200: $? = 0
-configure:9222: result: yes
-configure:9137: checking for snprintf
-configure:9193: gcc -o conftest -g -O2   conftest.c -lm  >&5
-conftest.c:74:6: warning: conflicting types for built-in function 'snprintf' [enabled by default]
- char snprintf ();
-      ^
-configure:9200: $? = 0
-configure:9222: result: yes
-configure:9235: checking return type of random
-configure:9265: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:9269: $? = 0
-configure:9275: ./conftest
-configure:9279: $? = 0
-configure:9281: result: long
-configure:9308: checking for int8_t
-configure:9336: gcc -c -g -O2  conftest.c >&5
-configure:9343: $? = 0
-configure:9370: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:21: error: expected expression before ')' token
- if (sizeof ((int8_t)))
-                     ^
-configure:9377: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((int8_t)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:9400: result: yes
-configure:9412: checking for int16_t
-configure:9440: gcc -c -g -O2  conftest.c >&5
-configure:9447: $? = 0
-configure:9474: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:22: error: expected expression before ')' token
- if (sizeof ((int16_t)))
-                      ^
-configure:9481: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((int16_t)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:9504: result: yes
-configure:9516: checking for int32_t
-configure:9544: gcc -c -g -O2  conftest.c >&5
-configure:9551: $? = 0
-configure:9578: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:22: error: expected expression before ')' token
- if (sizeof ((int32_t)))
-                      ^
-configure:9585: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((int32_t)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:9608: result: yes
-configure:9620: checking for u_int8_t
-configure:9648: gcc -c -g -O2  conftest.c >&5
-configure:9655: $? = 0
-configure:9682: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:23: error: expected expression before ')' token
- if (sizeof ((u_int8_t)))
-                       ^
-configure:9689: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((u_int8_t)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:9712: result: yes
-configure:9724: checking for u_int16_t
-configure:9752: gcc -c -g -O2  conftest.c >&5
-configure:9759: $? = 0
-configure:9786: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:24: error: expected expression before ')' token
- if (sizeof ((u_int16_t)))
-                        ^
-configure:9793: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((u_int16_t)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:9816: result: yes
-configure:9828: checking for u_int32_t
-configure:9856: gcc -c -g -O2  conftest.c >&5
-configure:9863: $? = 0
-configure:9890: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:24: error: expected expression before ')' token
- if (sizeof ((u_int32_t)))
-                        ^
-configure:9897: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((u_int32_t)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:9920: result: yes
-configure:9932: checking for u_char
-configure:9960: gcc -c -g -O2  conftest.c >&5
-configure:9967: $? = 0
-configure:9994: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:21: error: expected expression before ')' token
- if (sizeof ((u_char)))
-                     ^
-configure:10001: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((u_char)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:10024: result: yes
-configure:10036: checking for u_int
-configure:10064: gcc -c -g -O2  conftest.c >&5
-configure:10071: $? = 0
-configure:10098: gcc -c -g -O2  conftest.c >&5
-conftest.c: In function 'main':
-conftest.c:89:20: error: expected expression before ')' token
- if (sizeof ((u_int)))
-                    ^
-configure:10105: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| /* end confdefs.h.  */
-| #include <stdio.h>
-| #ifdef HAVE_SYS_TYPES_H
-| # include <sys/types.h>
-| #endif
-| #ifdef HAVE_SYS_STAT_H
-| # include <sys/stat.h>
-| #endif
-| #ifdef STDC_HEADERS
-| # include <stdlib.h>
-| # include <stddef.h>
-| #else
-| # ifdef HAVE_STDLIB_H
-| #  include <stdlib.h>
-| # endif
-| #endif
-| #ifdef HAVE_STRING_H
-| # if !defined STDC_HEADERS && defined HAVE_MEMORY_H
-| #  include <memory.h>
-| # endif
-| # include <string.h>
-| #endif
-| #ifdef HAVE_STRINGS_H
-| # include <strings.h>
-| #endif
-| #ifdef HAVE_INTTYPES_H
-| # include <inttypes.h>
-| #endif
-| #ifdef HAVE_STDINT_H
-| # include <stdint.h>
-| #endif
-| #ifdef HAVE_UNISTD_H
-| # include <unistd.h>
-| #endif
-| int
-| main ()
-| {
-| if (sizeof ((u_int)))
-| 	  return 0;
-|   ;
-|   return 0;
-| }
-configure:10128: result: yes
-configure:10147: checking for strtoq
-configure:10203: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:10210: $? = 0
-configure:10232: result: yes
-configure:10147: checking for strtoll
-configure:10203: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:10210: $? = 0
-configure:10232: result: yes
-configure:10253: checking size of long
-configure:10558: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:10562: $? = 0
-configure:10568: ./conftest
-configure:10572: $? = 0
-configure:10598: result: 8
-configure:10611: checking for strtol
-configure:10667: gcc -o conftest -g -O2   conftest.c -lm  >&5
-configure:10674: $? = 0
-configure:10694: result: yes
-configure:10699: checking for __int64_t
-configure:10724: gcc -o conftest -g -O2   conftest.c -lm  >&5
-conftest.c: In function 'main':
-conftest.c:57:10: error: unknown type name '__int64_t'
- main() { __int64_t x; exit (sizeof(x) >= 8 ? 0 : 1); }
-          ^
-conftest.c:57:23: warning: incompatible implicit declaration of built-in function 'exit' [enabled by default]
- main() { __int64_t x; exit (sizeof(x) >= 8 ? 0 : 1); }
-                       ^
-configure:10728: $? = 1
-configure: program exited with status 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| #define HAVE_STRTOQ 1
-| #define HAVE_STRTOLL 1
-| #define SIZEOF_LONG 8
-| /* end confdefs.h.  */
-| 
-| main() { __int64_t x; exit (sizeof(x) >= 8 ? 0 : 1); }
-| 
-configure:10755: result: no
-configure:10761: checking for long long
-configure:10786: gcc -o conftest -g -O2   conftest.c -lm  >&5
-conftest.c: In function 'main':
-conftest.c:57:23: warning: incompatible implicit declaration of built-in function 'exit' [enabled by default]
- main() { long long x; exit (sizeof(x) >= 8 ? 0 : 1); }
-                       ^
-configure:10790: $? = 0
-configure:10796: ./conftest
-configure:10800: $? = 0
-configure:10817: result: yes
-configure:10825: checking for int64_t
-configure:10851: result: yes
-configure:10862: checking which kind of 64-bit int to use
-configure:10875: result: int64_t
-configure:10948: checking system version (for dynamic loading)
-configure:10968: result: Linux-3.16.0-77-generic
-configure:10976: checking for dlopen in -ldl
-configure:11011: gcc -o conftest -g -O2   conftest.c -ldl  -lm  >&5
-configure:11018: $? = 0
-configure:11039: result: yes
-configure:11777: checking dlfcn.h usability
-configure:11794: gcc -c -g -O2  conftest.c >&5
-configure:11801: $? = 0
-configure:11815: result: yes
-configure:11819: checking dlfcn.h presence
-configure:11834: gcc -E  conftest.c
-configure:11841: $? = 0
-configure:11855: result: yes
-configure:11883: checking for dlfcn.h
-configure:11890: result: yes
-configure:11903: checking for ns library name
-configure:11906: result: libns.so
-configure:11916: checking for struct ether_header
-configure:11949: gcc -c -g -O2  conftest.c >&5
-configure:11956: $? = 0
-configure:11966: result: found
-configure:11982: checking for struct ether_addr
-configure:12015: gcc -c -g -O2  conftest.c >&5
-configure:12022: $? = 0
-configure:12032: result: found
-configure:12052: checking for addr2ascii
-configure:12108: gcc -o conftest -g -O2   -Wl,-export-dynamic conftest.c -lm  >&5
-/tmp/ccaZ4QyB.o: In function `main':
-/home/wtao/project-dct-build/ns-allinone-2.34/ns-2.34/conftest.c:93: undefined reference to `addr2ascii'
-collect2: error: ld returned 1 exit status
-configure:12115: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| #define HAVE_STRTOQ 1
-| #define HAVE_STRTOLL 1
-| #define SIZEOF_LONG 8
-| #define HAVE_INT64 1
-| #define HAVE_ETHER_HEADER_STRUCT 1
-| #define HAVE_ETHER_ADDRESS_STRUCT 1
-| /* end confdefs.h.  */
-| /* Define addr2ascii to an innocuous variant, in case <limits.h> declares addr2ascii.
-|    For example, HP-UX 11i <limits.h> declares gettimeofday.  */
-| #define addr2ascii innocuous_addr2ascii
-| 
-| /* System header to define __stub macros and hopefully few prototypes,
-|     which can conflict with char addr2ascii (); below.
-|     Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
-|     <limits.h> exists even on freestanding compilers.  */
-| 
-| #ifdef __STDC__
-| # include <limits.h>
-| #else
-| # include <assert.h>
-| #endif
-| 
-| #undef addr2ascii
-| 
-| /* Override any GCC internal prototype to avoid an error.
-|    Use char because int might match the return type of a GCC
-|    builtin and then its argument prototype would still apply.  */
-| #ifdef __cplusplus
-| extern "C"
-| #endif
-| char addr2ascii ();
-| /* The GNU C library defines this for functions which it implements
-|     to always fail with ENOSYS.  Some functions are actually named
-|     something starting with __ and the normal name is an alias.  */
-| #if defined __stub_addr2ascii || defined __stub___addr2ascii
-| choke me
-| #endif
-| 
-| int
-| main ()
-| {
-| return addr2ascii ();
-|   ;
-|   return 0;
-| }
-configure:12137: result: no
-configure:12175: gcc -o conftest -g -O2   -Wl,-export-dynamic conftest.c -lm  >&5
-configure:12179: $? = 0
-configure:12185: ./conftest
-configure:12189: $? = 0
-configure:12210: checking for Linux compliant tcphdr
-configure:12244: gcc -c -g -O2  conftest.c >&5
-configure:12251: $? = 0
-configure:12258: result: found
-configure:12274: checking for BSD compliant tcphdr
-configure:12308: gcc -c -g -O2  conftest.c >&5
-configure:12315: $? = 0
-configure:12321: result: found
-configure:12337: checking for socklen_t
-configure:12365: gcc -c -g -O2  conftest.c >&5
-configure:12372: $? = 0
-configure:12388: result: yes
-configure:12401: checking for main in -lpcap
-configure:12430: gcc -o conftest -g -O2   -Wl,-export-dynamic conftest.c -lpcap  -lm  >&5
-/usr/bin/ld: cannot find -lpcap
-collect2: error: ld returned 1 exit status
-configure:12437: $? = 1
-configure: failed program was:
-| /* confdefs.h.  */
-| #define PACKAGE_NAME ""
-| #define PACKAGE_TARNAME ""
-| #define PACKAGE_VERSION ""
-| #define PACKAGE_STRING ""
-| #define PACKAGE_BUGREPORT ""
-| #define STDC_HEADERS 1
-| #define HAVE_SYS_TYPES_H 1
-| #define HAVE_SYS_STAT_H 1
-| #define HAVE_STDLIB_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_MEMORY_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_INTTYPES_H 1
-| #define HAVE_STDINT_H 1
-| #define HAVE_UNISTD_H 1
-| #define __EXTENSIONS__ 1
-| #define _ALL_SOURCE 1
-| #define _GNU_SOURCE 1
-| #define _POSIX_PTHREAD_SEMANTICS 1
-| #define _TANDEM_SOURCE 1
-| #define STDC_HEADERS 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STL 1
-| #define CPP_REQUIRES_NAMESPACE 1
-| #define HAVE_TCL_H 1
-| #define HAVE_TCLINT_H 1
-| #define HAVE_LIBTCL8_4 1
-| #define HAVE_TK_H 1
-| #define HAVE_LIBTK8_4 1
-| #define HAVE_OTCL_H 1
-| #define HAVE_LIBOTCL1_13 1
-| #define HAVE_TCLCL_H 1
-| #define HAVE_LIBTCLCL 1
-| #define STDC_HEADERS 1
-| #define HAVE_ARPA_INET_H 1
-| #define HAVE_FENV_H 1
-| #define HAVE_NETINET_IN_H 1
-| #define HAVE_STRING_H 1
-| #define HAVE_STRINGS_H 1
-| #define HAVE_TIME_H 1
-| #define HAVE_UNISTD_H 1
-| #define HAVE_NET_ETHERNET_H 1
-| #define HAVE_LIBM 1
-| #define HAVE_BCOPY 1
-| #define HAVE_BZERO 1
-| #define HAVE_FEENABLEEXCEPT 1
-| #define HAVE_GETRUSAGE 1
-| #define HAVE_SBRK 1
-| #define HAVE_SNPRINTF 1
-| #define RANDOM_RETURN_TYPE long
-| #define HAVE_STRTOQ 1
-| #define HAVE_STRTOLL 1
-| #define SIZEOF_LONG 8
-| #define HAVE_INT64 1
-| #define HAVE_ETHER_HEADER_STRUCT 1
-| #define HAVE_ETHER_ADDRESS_STRUCT 1
-| #define HAVE_SIOCGIFHWADDR 1
-| #define HAVE_SOCKLEN_T 1
-| /* end confdefs.h.  */
-| 
-| 
-| int
-| main ()
-| {
-| return main ();
-|   ;
-|   return 0;
-| }
-configure:12458: result: no
-configure:12467: checking to make nse
-configure:12475: result: no
-configure:12523: checking for dlopen in -ldl
-configure:12586: result: yes
-configure:12787: checking for a BSD-compatible install
-configure:12855: result: /usr/bin/install -c
-configure:12972: creating ./config.status
-
-## ---------------------- ##
-## Running config.status. ##
-## ---------------------- ##
-
-This file was extended by config.status, which was
-generated by GNU Autoconf 2.63.  Invocation command line was
-
-  CONFIG_FILES    = 
-  CONFIG_HEADERS  = 
-  CONFIG_LINKS    = 
-  CONFIG_COMMANDS = 
-  $ ./config.status 
-
-on vb
-
-config.status:839: creating Makefile
-config.status:839: creating tcl/lib/ns-autoconf.tcl
-config.status:839: creating indep-utils/webtrace-conv/ucb/Makefile
-config.status:839: creating indep-utils/webtrace-conv/dec/Makefile
-config.status:839: creating indep-utils/webtrace-conv/nlanr/Makefile
-config.status:839: creating indep-utils/webtrace-conv/epa/Makefile
-config.status:839: creating indep-utils/cmu-scen-gen/setdest/Makefile
-config.status:839: creating autoconf.h
-
-## ---------------- ##
-## Cache variables. ##
-## ---------------- ##
-
-ac_cv_build=x86_64-unknown-linux-gnu
-ac_cv_c_compiler_gnu=yes
-ac_cv_cxx_compiler_gnu=yes
-ac_cv_env_CCC_set=
-ac_cv_env_CCC_value=
-ac_cv_env_CC_set=
-ac_cv_env_CC_value=
-ac_cv_env_CFLAGS_set=
-ac_cv_env_CFLAGS_value=
-ac_cv_env_CPPFLAGS_set=
-ac_cv_env_CPPFLAGS_value=
-ac_cv_env_CPP_set=
-ac_cv_env_CPP_value=
-ac_cv_env_CXXFLAGS_set=
-ac_cv_env_CXXFLAGS_value=
-ac_cv_env_CXX_set=
-ac_cv_env_CXX_value=
-ac_cv_env_LDFLAGS_set=
-ac_cv_env_LDFLAGS_value=
-ac_cv_env_LIBS_set=
-ac_cv_env_LIBS_value=
-ac_cv_env_build_alias_set=
-ac_cv_env_build_alias_value=
-ac_cv_env_host_alias_set=
-ac_cv_env_host_alias_value=
-ac_cv_env_target_alias_set=
-ac_cv_env_target_alias_value=
-ac_cv_func_addr2ascii=no
-ac_cv_func_bcopy=yes
-ac_cv_func_bzero=yes
-ac_cv_func_feenableexcept=yes
-ac_cv_func_fesetprecision=no
-ac_cv_func_getrusage=yes
-ac_cv_func_sbrk=yes
-ac_cv_func_snprintf=yes
-ac_cv_func_strtol=yes
-ac_cv_func_strtoll=yes
-ac_cv_func_strtoq=yes
-ac_cv_header_arpa_inet_h=yes
-ac_cv_header_dlfcn_h=yes
-ac_cv_header_fenv_h=yes
-ac_cv_header_inttypes_h=yes
-ac_cv_header_memory_h=yes
-ac_cv_header_minix_config_h=no
-ac_cv_header_net_ethernet_h=yes
-ac_cv_header_netinet_in_h=yes
-ac_cv_header_stdc=yes
-ac_cv_header_stdint_h=yes
-ac_cv_header_stdlib_h=yes
-ac_cv_header_string_h=yes
-ac_cv_header_strings_h=yes
-ac_cv_header_sys_stat_h=yes
-ac_cv_header_sys_types_h=yes
-ac_cv_header_time_h=yes
-ac_cv_header_unistd_h=yes
-ac_cv_host=x86_64-unknown-linux-gnu
-ac_cv_lib_X11_XOpenDisplay=yes
-ac_cv_lib_Xbsd_main=no
-ac_cv_lib_Xext_XShmAttach=yes
-ac_cv_lib_dl_dlopen=yes
-ac_cv_lib_dnet_stub_getnodebyname=no
-ac_cv_lib_intl_dcgettext=no
-ac_cv_lib_m_main=yes
-ac_cv_lib_nsl_gethostbyname=yes
-ac_cv_lib_pcap_main=no
-ac_cv_lib_socket_socket=no
-ac_cv_objext=o
-ac_cv_path_EGREP='/bin/grep -E'
-ac_cv_path_GREP=/bin/grep
-ac_cv_path_V_TCLSH=../bin/tclsh8.4
-ac_cv_path_install='/usr/bin/install -c'
-ac_cv_prog_CPP='gcc -E'
-ac_cv_prog_ac_ct_CC=gcc
-ac_cv_prog_ac_ct_CXX=g++
-ac_cv_prog_cc_c89=
-ac_cv_prog_cc_g=yes
-ac_cv_prog_cxx_g=yes
-ac_cv_safe_to_define___extensions__=yes
-ac_cv_sizeof_long=8
-ac_cv_target=x86_64-unknown-linux-gnu
-ac_cv_type_int16_t=yes
-ac_cv_type_int32_t=yes
-ac_cv_type_int64_t=yes
-ac_cv_type_int8_t=yes
-ac_cv_type_socklen_t=yes
-ac_cv_type_u_char=yes
-ac_cv_type_u_int16_t=yes
-ac_cv_type_u_int32_t=yes
-ac_cv_type_u_int8_t=yes
-ac_cv_type_u_int=yes
-nsnam_cv_int64_t_HAVE_LONG_LONG=yes
-nsnam_cv_int64_t_HAVE___INT64_T=no
-
-## ----------------- ##
-## Output variables. ##
-## ----------------- ##
-
-CC='gcc'
-CFLAGS='-g -O2'
-CPP='gcc -E'
-CPPFLAGS=''
-CPP_NAMESPACE='std'
-CXX='g++'
-CXXFLAGS='-g -O2'
-DEFS='-DHAVE_CONFIG_H'
-DL_LD_FLAGS='-rdynamic'
-DL_LD_SEARCH_FLAGS=''
-DL_LIBS='-ldl'
-ECHO_C=''
-ECHO_N='-n'
-ECHO_T=''
-EGREP='/bin/grep -E'
-EXEEXT=''
-GREP='/bin/grep'
-INSTALL_DATA='${INSTALL} -m 644'
-INSTALL_PROGRAM='${INSTALL}'
-INSTALL_SCRIPT='${INSTALL}'
-LDFLAGS=' -Wl,-export-dynamic'
-LIBOBJS=''
-LIBS='-lm '
-LTLIBOBJS=''
-NSLIB='libns.so'
-OBJEXT='o'
-PACKAGE_BUGREPORT=''
-PACKAGE_NAME=''
-PACKAGE_STRING=''
-PACKAGE_TARNAME=''
-PACKAGE_VERSION=''
-PATH_SEPARATOR=':'
-PERL='/usr/bin/perl'
-PKG_SHLIB_CFLAGS=''
-SHELL='/bin/bash'
-SHLIB_CFLAGS='-fPIC'
-SHLIB_LD='gcc -shared'
-SHLIB_LD_LIBS=''
-SHLIB_SUFFIX='.so'
-V_ALL=''
-V_AR='ar cr'
-V_BROKEN_OBJ=''
-V_CCOPT='-O2 -Wall -Wno-write-strings'
-V_DEFINE='-DTCLCL_CLASSINSTVAR  -DNDEBUG -DLINUX_TCP_HEADER -DUSE_SHM'
-V_DEFINES='-DHAVE_LIBTCLCL -DHAVE_TCLCL_H -DHAVE_LIBOTCL1_13 -DHAVE_OTCL_H -DHAVE_LIBTK8_4 -DHAVE_TK_H -DHAVE_LIBTCL8_4 -DHAVE_TCLINT_H -DHAVE_TCL_H '
-V_IMPORT_LIBS=''
-V_INCLUDE=''
-V_INCLUDES='-I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/include/pcap'
-V_INCLUDE_X11=''
-V_LIB=' -lnsl -ldl'
-V_LIBRARY_TCL='../lib/tcl8.4'
-V_LIBRARY_TK='../lib/tk8.4'
-V_LIBS='-L/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -ltclcl -L/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -lotcl -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltk8.4 -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4'
-V_LIB_OTCL='-L/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -lotcl'
-V_LIB_TCL='-L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4'
-V_LIB_TCLCL='-L/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -ltclcl'
-V_LIB_TK='-L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltk8.4'
-V_LIB_X11='-lXext -lX11'
-V_LSSCRIPT=''
-V_NS_TCL_LIB_STL='$(NS_TCL_LIB_STL)'
-V_OBJ=''
-V_OBJ_CRYPT=''
-V_RANLIB='ranlib'
-V_SHELL=''
-V_SIGRET='void'
-V_STATIC=''
-V_STLOBJ='$(OBJ_STL)'
-V_TARCMD='tar cfh'
-V_TAR_EXTRA=''
-V_TAR_TARGET='linux-gnu'
-V_TCL2CPP='../tclcl-1.19/tcl2c++'
-V_TCLSH='/home/wtao/project-dct-build/ns-allinone-2.34/bin/tclsh8.4'
-V_TCL_LIBRARY_FILES='$(TCL_BASE_LIBRARY_FILES) ../lib/tcl8.4/http1.0/http.tcl'
-V_TKDOSNAMES='$(LIBRARY_TK)/optMenu.tcl $(LIBRARY_TK)/scrlbar.tcl'
-ac_ct_CC='gcc'
-ac_ct_CXX='g++'
-bindir='${exec_prefix}/bin'
-build='x86_64-unknown-linux-gnu'
-build_alias=''
-build_cpu='x86_64'
-build_nse=''
-build_os='linux-gnu'
-build_vendor='unknown'
-datadir='${datarootdir}'
-datarootdir='${prefix}/share'
-docdir='${datarootdir}/doc/${PACKAGE}'
-dvidir='${docdir}'
-exec_prefix='${prefix}'
-host='x86_64-unknown-linux-gnu'
-host_alias=''
-host_cpu='x86_64'
-host_os='linux-gnu'
-host_vendor='unknown'
-htmldir='${docdir}'
-includedir='${prefix}/include'
-infodir='${datarootdir}/info'
-libdir='${exec_prefix}/lib'
-libexecdir='${exec_prefix}/libexec'
-localedir='${datarootdir}/locale'
-localstatedir='${prefix}/var'
-mandir='${datarootdir}/man'
-oldincludedir='/usr/include'
-pdfdir='${docdir}'
-prefix='/usr/local'
-program_transform_name='s,x,x,'
-psdir='${docdir}'
-sbindir='${exec_prefix}/sbin'
-sharedstatedir='${prefix}/com'
-sysconfdir='${prefix}/etc'
-target='x86_64-unknown-linux-gnu'
-target_alias=''
-target_cpu='x86_64'
-target_os='linux-gnu'
-target_vendor='unknown'
-
-## ----------- ##
-## confdefs.h. ##
-## ----------- ##
-
-#define PACKAGE_NAME ""
-#define PACKAGE_TARNAME ""
-#define PACKAGE_VERSION ""
-#define PACKAGE_STRING ""
-#define PACKAGE_BUGREPORT ""
-#define STDC_HEADERS 1
-#define HAVE_SYS_TYPES_H 1
-#define HAVE_SYS_STAT_H 1
-#define HAVE_STDLIB_H 1
-#define HAVE_STRING_H 1
-#define HAVE_MEMORY_H 1
-#define HAVE_STRINGS_H 1
-#define HAVE_INTTYPES_H 1
-#define HAVE_STDINT_H 1
-#define HAVE_UNISTD_H 1
-#define __EXTENSIONS__ 1
-#define _ALL_SOURCE 1
-#define _GNU_SOURCE 1
-#define _POSIX_PTHREAD_SEMANTICS 1
-#define _TANDEM_SOURCE 1
-#define STDC_HEADERS 1
-#define HAVE_STRING_H 1
-#define HAVE_STL 1
-#define CPP_REQUIRES_NAMESPACE 1
-#define HAVE_TCL_H 1
-#define HAVE_TCLINT_H 1
-#define HAVE_LIBTCL8_4 1
-#define HAVE_TK_H 1
-#define HAVE_LIBTK8_4 1
-#define HAVE_OTCL_H 1
-#define HAVE_LIBOTCL1_13 1
-#define HAVE_TCLCL_H 1
-#define HAVE_LIBTCLCL 1
-#define STDC_HEADERS 1
-#define HAVE_ARPA_INET_H 1
-#define HAVE_FENV_H 1
-#define HAVE_NETINET_IN_H 1
-#define HAVE_STRING_H 1
-#define HAVE_STRINGS_H 1
-#define HAVE_TIME_H 1
-#define HAVE_UNISTD_H 1
-#define HAVE_NET_ETHERNET_H 1
-#define HAVE_LIBM 1
-#define HAVE_BCOPY 1
-#define HAVE_BZERO 1
-#define HAVE_FEENABLEEXCEPT 1
-#define HAVE_GETRUSAGE 1
-#define HAVE_SBRK 1
-#define HAVE_SNPRINTF 1
-#define RANDOM_RETURN_TYPE long
-#define HAVE_STRTOQ 1
-#define HAVE_STRTOLL 1
-#define SIZEOF_LONG 8
-#define HAVE_INT64 1
-#define HAVE_ETHER_HEADER_STRUCT 1
-#define HAVE_ETHER_ADDRESS_STRUCT 1
-#define HAVE_SIOCGIFHWADDR 1
-#define HAVE_SOCKLEN_T 1
-
-configure: exit 0
diff -uNr ./ns-allinone-2.34/ns-2.34/config.status ./ori-ns-allinone-2.34/ns-2.34/config.status
--- ./ns-allinone-2.34/ns-2.34/config.status	2017-02-22 17:05:34.846233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/config.status	1970-01-01 08:00:00.000000000 +0800
@@ -1,1079 +0,0 @@
-#! /bin/bash
-# Generated by configure.
-# Run this file to recreate the current configuration.
-# Compiler output produced by configure, useful for debugging
-# configure, is in config.log if it exists.
-
-debug=false
-ac_cs_recheck=false
-ac_cs_silent=false
-SHELL=${CONFIG_SHELL-/bin/bash}
-## --------------------- ##
-## M4sh Initialization.  ##
-## --------------------- ##
-
-# Be more Bourne compatible
-DUALCASE=1; export DUALCASE # for MKS sh
-if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then
-  emulate sh
-  NULLCMD=:
-  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
-  # is contrary to our usage.  Disable this feature.
-  alias -g '${1+"$@"}'='"$@"'
-  setopt NO_GLOB_SUBST
-else
-  case `(set -o) 2>/dev/null` in
-  *posix*) set -o posix ;;
-esac
-
-fi
-
-
-
-
-# PATH needs CR
-# Avoid depending upon Character Ranges.
-as_cr_letters='abcdefghijklmnopqrstuvwxyz'
-as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
-as_cr_Letters=$as_cr_letters$as_cr_LETTERS
-as_cr_digits='0123456789'
-as_cr_alnum=$as_cr_Letters$as_cr_digits
-
-as_nl='
-'
-export as_nl
-# Printing a long string crashes Solaris 7 /usr/bin/printf.
-as_echo='\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\'
-as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo
-as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo$as_echo
-if (test "X`printf %s $as_echo`" = "X$as_echo") 2>/dev/null; then
-  as_echo='printf %s\n'
-  as_echo_n='printf %s'
-else
-  if test "X`(/usr/ucb/echo -n -n $as_echo) 2>/dev/null`" = "X-n $as_echo"; then
-    as_echo_body='eval /usr/ucb/echo -n "$1$as_nl"'
-    as_echo_n='/usr/ucb/echo -n'
-  else
-    as_echo_body='eval expr "X$1" : "X\\(.*\\)"'
-    as_echo_n_body='eval
-      arg=$1;
-      case $arg in
-      *"$as_nl"*)
-	expr "X$arg" : "X\\(.*\\)$as_nl";
-	arg=`expr "X$arg" : ".*$as_nl\\(.*\\)"`;;
-      esac;
-      expr "X$arg" : "X\\(.*\\)" | tr -d "$as_nl"
-    '
-    export as_echo_n_body
-    as_echo_n='sh -c $as_echo_n_body as_echo'
-  fi
-  export as_echo_body
-  as_echo='sh -c $as_echo_body as_echo'
-fi
-
-# The user is always right.
-if test "${PATH_SEPARATOR+set}" != set; then
-  PATH_SEPARATOR=:
-  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
-    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
-      PATH_SEPARATOR=';'
-  }
-fi
-
-# Support unset when possible.
-if ( (MAIL=60; unset MAIL) || exit) >/dev/null 2>&1; then
-  as_unset=unset
-else
-  as_unset=false
-fi
-
-
-# IFS
-# We need space, tab and new line, in precisely that order.  Quoting is
-# there to prevent editors from complaining about space-tab.
-# (If _AS_PATH_WALK were called with IFS unset, it would disable word
-# splitting by setting IFS to empty value.)
-IFS=" ""	$as_nl"
-
-# Find who we are.  Look in the path if we contain no directory separator.
-case $0 in
-  *[\\/]* ) as_myself=$0 ;;
-  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
-done
-IFS=$as_save_IFS
-
-     ;;
-esac
-# We did not find ourselves, most probably we were run as `sh COMMAND'
-# in which case we are not to be found in the path.
-if test "x$as_myself" = x; then
-  as_myself=$0
-fi
-if test ! -f "$as_myself"; then
-  $as_echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
-  { (exit 1); exit 1; }
-fi
-
-# Work around bugs in pre-3.0 UWIN ksh.
-for as_var in ENV MAIL MAILPATH
-do ($as_unset $as_var) >/dev/null 2>&1 && $as_unset $as_var
-done
-PS1='$ '
-PS2='> '
-PS4='+ '
-
-# NLS nuisances.
-LC_ALL=C
-export LC_ALL
-LANGUAGE=C
-export LANGUAGE
-
-# Required to use basename.
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
-  as_basename=basename
-else
-  as_basename=false
-fi
-
-
-# Name of the executable.
-as_me=`$as_basename -- "$0" ||
-$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
-	 X"$0" : 'X\(//\)$' \| \
-	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X/"$0" |
-    sed '/^.*\/\([^/][^/]*\)\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\/\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-
-# CDPATH.
-$as_unset CDPATH
-
-
-
-  as_lineno_1=$LINENO
-  as_lineno_2=$LINENO
-  test "x$as_lineno_1" != "x$as_lineno_2" &&
-  test "x`expr $as_lineno_1 + 1`" = "x$as_lineno_2" || {
-
-  # Create $as_me.lineno as a copy of $as_myself, but with $LINENO
-  # uniformly replaced by the line number.  The first 'sed' inserts a
-  # line-number line after each line using $LINENO; the second 'sed'
-  # does the real work.  The second script uses 'N' to pair each
-  # line-number line with the line containing $LINENO, and appends
-  # trailing '-' during substitution so that $LINENO is not a special
-  # case at line end.
-  # (Raja R Harinath suggested sed '=', and Paul Eggert wrote the
-  # scripts with optimization help from Paolo Bonzini.  Blame Lee
-  # E. McMahon (1931-1989) for sed's syntax.  :-)
-  sed -n '
-    p
-    /[$]LINENO/=
-  ' <$as_myself |
-    sed '
-      s/[$]LINENO.*/&-/
-      t lineno
-      b
-      :lineno
-      N
-      :loop
-      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
-      t loop
-      s/-\n.*//
-    ' >$as_me.lineno &&
-  chmod +x "$as_me.lineno" ||
-    { $as_echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2
-   { (exit 1); exit 1; }; }
-
-  # Don't try to exec as it changes $[0], causing all sort of problems
-  # (the dirname of $[0] is not the place where we might find the
-  # original and so on.  Autoconf is especially sensitive to this).
-  . "./$as_me.lineno"
-  # Exit status is that of the last command.
-  exit
-}
-
-
-if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
-  as_dirname=dirname
-else
-  as_dirname=false
-fi
-
-ECHO_C= ECHO_N= ECHO_T=
-case `echo -n x` in
--n*)
-  case `echo 'x\c'` in
-  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
-  *)   ECHO_C='\c';;
-  esac;;
-*)
-  ECHO_N='-n';;
-esac
-if expr a : '\(a\)' >/dev/null 2>&1 &&
-   test "X`expr 00001 : '.*\(...\)'`" = X001; then
-  as_expr=expr
-else
-  as_expr=false
-fi
-
-rm -f conf$$ conf$$.exe conf$$.file
-if test -d conf$$.dir; then
-  rm -f conf$$.dir/conf$$.file
-else
-  rm -f conf$$.dir
-  mkdir conf$$.dir 2>/dev/null
-fi
-if (echo >conf$$.file) 2>/dev/null; then
-  if ln -s conf$$.file conf$$ 2>/dev/null; then
-    as_ln_s='ln -s'
-    # ... but there are two gotchas:
-    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
-    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
-    # In both cases, we have to default to `cp -p'.
-    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
-      as_ln_s='cp -p'
-  elif ln conf$$.file conf$$ 2>/dev/null; then
-    as_ln_s=ln
-  else
-    as_ln_s='cp -p'
-  fi
-else
-  as_ln_s='cp -p'
-fi
-rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
-rmdir conf$$.dir 2>/dev/null
-
-if mkdir -p . 2>/dev/null; then
-  as_mkdir_p=:
-else
-  test -d ./-p && rmdir ./-p
-  as_mkdir_p=false
-fi
-
-if test -x / >/dev/null 2>&1; then
-  as_test_x='test -x'
-else
-  if ls -dL / >/dev/null 2>&1; then
-    as_ls_L_option=L
-  else
-    as_ls_L_option=
-  fi
-  as_test_x='
-    eval sh -c '\''
-      if test -d "$1"; then
-	test -d "$1/.";
-      else
-	case $1 in
-	-*)set "./$1";;
-	esac;
-	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in
-	???[sx]*):;;*)false;;esac;fi
-    '\'' sh
-  '
-fi
-as_executable_p=$as_test_x
-
-# Sed expression to map a string onto a valid CPP name.
-as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
-
-# Sed expression to map a string onto a valid variable name.
-as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
-
-
-exec 6>&1
-
-# Save the log message, to keep $[0] and so on meaningful, and to
-# report actual input values of CONFIG_FILES etc. instead of their
-# values after options handling.
-ac_log="
-This file was extended by $as_me, which was
-generated by GNU Autoconf 2.63.  Invocation command line was
-
-  CONFIG_FILES    = $CONFIG_FILES
-  CONFIG_HEADERS  = $CONFIG_HEADERS
-  CONFIG_LINKS    = $CONFIG_LINKS
-  CONFIG_COMMANDS = $CONFIG_COMMANDS
-  $ $0 $@
-
-on `(hostname || uname -n) 2>/dev/null | sed 1q`
-"
-
-# Files that config.status was made for.
-config_files=" Makefile tcl/lib/ns-autoconf.tcl indep-utils/webtrace-conv/ucb/Makefile indep-utils/webtrace-conv/dec/Makefile indep-utils/webtrace-conv/nlanr/Makefile indep-utils/webtrace-conv/epa/Makefile indep-utils/cmu-scen-gen/setdest/Makefile"
-config_headers=" autoconf.h"
-
-ac_cs_usage="\
-\`$as_me' instantiates files from templates according to the
-current configuration.
-
-Usage: $0 [OPTION]... [FILE]...
-
-  -h, --help       print this help, then exit
-  -V, --version    print version number and configuration settings, then exit
-  -q, --quiet, --silent
-                   do not print progress messages
-  -d, --debug      don't remove temporary files
-      --recheck    update $as_me by reconfiguring in the same conditions
-      --file=FILE[:TEMPLATE]
-                   instantiate the configuration file FILE
-      --header=FILE[:TEMPLATE]
-                   instantiate the configuration header FILE
-
-Configuration files:
-$config_files
-
-Configuration headers:
-$config_headers
-
-Report bugs to <bug-autoconf@gnu.org>."
-
-ac_cs_version="\
-config.status
-configured by ./configure, generated by GNU Autoconf 2.63,
-  with options \"'--with-otcl=../otcl-1.13' '--with-tclcl=../tclcl-1.19'\"
-
-Copyright (C) 2008 Free Software Foundation, Inc.
-This config.status script is free software; the Free Software Foundation
-gives unlimited permission to copy, distribute and modify it."
-
-ac_pwd='/home/wtao/project-dct-build/ns-allinone-2.34/ns-2.34'
-srcdir='.'
-INSTALL='/usr/bin/install -c'
-test -n "$AWK" || AWK=awk
-# The default lists apply if the user does not specify any file.
-ac_need_defaults=:
-while test $# != 0
-do
-  case $1 in
-  --*=*)
-    ac_option=`expr "X$1" : 'X\([^=]*\)='`
-    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
-    ac_shift=:
-    ;;
-  *)
-    ac_option=$1
-    ac_optarg=$2
-    ac_shift=shift
-    ;;
-  esac
-
-  case $ac_option in
-  # Handling of the options.
-  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
-    ac_cs_recheck=: ;;
-  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
-    $as_echo "$ac_cs_version"; exit ;;
-  --debug | --debu | --deb | --de | --d | -d )
-    debug=: ;;
-  --file | --fil | --fi | --f )
-    $ac_shift
-    case $ac_optarg in
-    *\'*) ac_optarg=`$as_echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    CONFIG_FILES="$CONFIG_FILES '$ac_optarg'"
-    ac_need_defaults=false;;
-  --header | --heade | --head | --hea )
-    $ac_shift
-    case $ac_optarg in
-    *\'*) ac_optarg=`$as_echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
-    esac
-    CONFIG_HEADERS="$CONFIG_HEADERS '$ac_optarg'"
-    ac_need_defaults=false;;
-  --he | --h)
-    # Conflict between --help and --header
-    { $as_echo "$as_me: error: ambiguous option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; };;
-  --help | --hel | -h )
-    $as_echo "$ac_cs_usage"; exit ;;
-  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
-  | -silent | --silent | --silen | --sile | --sil | --si | --s)
-    ac_cs_silent=: ;;
-
-  # This is an error.
-  -*) { $as_echo "$as_me: error: unrecognized option: $1
-Try \`$0 --help' for more information." >&2
-   { (exit 1); exit 1; }; } ;;
-
-  *) ac_config_targets="$ac_config_targets $1"
-     ac_need_defaults=false ;;
-
-  esac
-  shift
-done
-
-ac_configure_extra_args=
-
-if $ac_cs_silent; then
-  exec 6>/dev/null
-  ac_configure_extra_args="$ac_configure_extra_args --silent"
-fi
-
-if $ac_cs_recheck; then
-  set X '/bin/bash' './configure'  '--with-otcl=../otcl-1.13' '--with-tclcl=../tclcl-1.19' $ac_configure_extra_args --no-create --no-recursion
-  shift
-  $as_echo "running CONFIG_SHELL=/bin/bash $*" >&6
-  CONFIG_SHELL='/bin/bash'
-  export CONFIG_SHELL
-  exec "$@"
-fi
-
-exec 5>>config.log
-{
-  echo
-  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
-## Running $as_me. ##
-_ASBOX
-  $as_echo "$ac_log"
-} >&5
-
-
-# Handling of arguments.
-for ac_config_target in $ac_config_targets
-do
-  case $ac_config_target in
-    "autoconf.h") CONFIG_HEADERS="$CONFIG_HEADERS autoconf.h" ;;
-    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-    "tcl/lib/ns-autoconf.tcl") CONFIG_FILES="$CONFIG_FILES tcl/lib/ns-autoconf.tcl" ;;
-    "indep-utils/webtrace-conv/ucb/Makefile") CONFIG_FILES="$CONFIG_FILES indep-utils/webtrace-conv/ucb/Makefile" ;;
-    "indep-utils/webtrace-conv/dec/Makefile") CONFIG_FILES="$CONFIG_FILES indep-utils/webtrace-conv/dec/Makefile" ;;
-    "indep-utils/webtrace-conv/nlanr/Makefile") CONFIG_FILES="$CONFIG_FILES indep-utils/webtrace-conv/nlanr/Makefile" ;;
-    "indep-utils/webtrace-conv/epa/Makefile") CONFIG_FILES="$CONFIG_FILES indep-utils/webtrace-conv/epa/Makefile" ;;
-    "indep-utils/cmu-scen-gen/setdest/Makefile") CONFIG_FILES="$CONFIG_FILES indep-utils/cmu-scen-gen/setdest/Makefile" ;;
-
-  *) { { $as_echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
-$as_echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
-   { (exit 1); exit 1; }; };;
-  esac
-done
-
-
-# If the user did not use the arguments to specify the items to instantiate,
-# then the envvar interface is used.  Set only those that are not.
-# We use the long form for the default assignment because of an extremely
-# bizarre bug on SunOS 4.1.3.
-if $ac_need_defaults; then
-  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
-  test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
-fi
-
-# Have a temporary directory for convenience.  Make it in the build tree
-# simply because there is no reason against having it here, and in addition,
-# creating and moving files from /tmp can sometimes cause problems.
-# Hook for its removal unless debugging.
-# Note that there is a small window in which the directory will not be cleaned:
-# after its creation but before its name has been assigned to `$tmp'.
-$debug ||
-{
-  tmp=
-  trap 'exit_status=$?
-  { test -z "$tmp" || test ! -d "$tmp" || rm -fr "$tmp"; } && exit $exit_status
-' 0
-  trap '{ (exit 1); exit 1; }' 1 2 13 15
-}
-# Create a (secure) tmp directory for tmp files.
-
-{
-  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
-  test -n "$tmp" && test -d "$tmp"
-}  ||
-{
-  tmp=./conf$$-$RANDOM
-  (umask 077 && mkdir "$tmp")
-} ||
-{
-   $as_echo "$as_me: cannot create a temporary directory in ." >&2
-   { (exit 1); exit 1; }
-}
-
-# Set up the scripts for CONFIG_FILES section.
-# No need to generate them if there are no CONFIG_FILES.
-# This happens for instance with `./config.status config.h'.
-if test -n "$CONFIG_FILES"; then
-
-
-ac_cr=''
-ac_cs_awk_cr=`$AWK 'BEGIN { print "a\rb" }' </dev/null 2>/dev/null`
-if test "$ac_cs_awk_cr" = "a${ac_cr}b"; then
-  ac_cs_awk_cr='\\r'
-else
-  ac_cs_awk_cr=$ac_cr
-fi
-
-echo 'BEGIN {' >"$tmp/subs1.awk" &&
-cat >>"$tmp/subs1.awk" <<\_ACAWK &&
-S["LTLIBOBJS"]=""
-S["LIBOBJS"]=""
-S["INSTALL_DATA"]="${INSTALL} -m 644"
-S["INSTALL_SCRIPT"]="${INSTALL}"
-S["INSTALL_PROGRAM"]="${INSTALL}"
-S["V_LSSCRIPT"]=""
-S["V_NS_TCL_LIB_STL"]="$(NS_TCL_LIB_STL)"
-S["V_STLOBJ"]="$(OBJ_STL)"
-S["V_AR"]="ar cr"
-S["V_RANLIB"]="ranlib"
-S["V_OBJ_CRYPT"]=""
-S["V_BROKEN_OBJ"]=""
-S["V_OBJ"]=""
-S["V_INCLUDE"]=""
-S["V_TARCMD"]="tar cfh"
-S["V_SHELL"]=""
-S["V_SIGRET"]="void"
-S["V_DEFINE"]="-DTCLCL_CLASSINSTVAR  -DNDEBUG -DLINUX_TCP_HEADER -DUSE_SHM"
-S["V_LIB"]=" -lnsl -ldl"
-S["V_TAR_EXTRA"]=""
-S["V_CCOPT"]="-O2 -Wall -Wno-write-strings"
-S["V_ALL"]=""
-S["V_LIB_TK"]="-L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltk8.4"
-S["V_LIB_TCL"]="-L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4"
-S["V_LIB_OTCL"]="-L/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -lotcl"
-S["V_LIB_TCLCL"]="-L/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -ltclcl"
-S["V_TAR_TARGET"]="linux-gnu"
-S["V_STATIC"]=""
-S["V_DEFINES"]="-DHAVE_LIBTCLCL -DHAVE_TCLCL_H -DHAVE_LIBOTCL1_13 -DHAVE_OTCL_H -DHAVE_LIBTK8_4 -DHAVE_TK_H -DHAVE_LIBTCL8_4 -DHAVE_TCLINT_H -DHAVE_TCL_H "
-S["V_LIBS"]="-L/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -ltclcl -L/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -lotcl -L/home/wtao/pro"\
-"ject-dct-build/ns-allinone-2.34/lib -ltk8.4 -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4"
-S["V_INCLUDES"]="-I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/"\
-"ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/incl"\
-"ude/pcap"
-S["build_nse"]=""
-S["NSLIB"]="libns.so"
-S["PKG_SHLIB_CFLAGS"]=""
-S["SHLIB_SUFFIX"]=".so"
-S["SHLIB_LD_LIBS"]=""
-S["SHLIB_LD"]="gcc -shared"
-S["SHLIB_CFLAGS"]="-fPIC"
-S["DL_LD_SEARCH_FLAGS"]=""
-S["DL_LD_FLAGS"]="-rdynamic"
-S["DL_LIBS"]="-ldl"
-S["V_IMPORT_LIBS"]=""
-S["PERL"]="/usr/bin/perl"
-S["V_LIB_X11"]="-lXext -lX11"
-S["V_INCLUDE_X11"]=""
-S["V_TCL2CPP"]="../tclcl-1.19/tcl2c++"
-S["V_LIBRARY_TK"]="../lib/tk8.4"
-S["V_TKDOSNAMES"]="$(LIBRARY_TK)/optMenu.tcl $(LIBRARY_TK)/scrlbar.tcl"
-S["V_LIBRARY_TCL"]="../lib/tcl8.4"
-S["V_TCLSH"]="/home/wtao/project-dct-build/ns-allinone-2.34/bin/tclsh8.4"
-S["V_TCL_LIBRARY_FILES"]="$(TCL_BASE_LIBRARY_FILES) ../lib/tcl8.4/http1.0/http.tcl"
-S["CPP_NAMESPACE"]="std"
-S["ac_ct_CXX"]="g++"
-S["CXXFLAGS"]="-g -O2"
-S["CXX"]="g++"
-S["target_os"]="linux-gnu"
-S["target_vendor"]="unknown"
-S["target_cpu"]="x86_64"
-S["target"]="x86_64-unknown-linux-gnu"
-S["host_os"]="linux-gnu"
-S["host_vendor"]="unknown"
-S["host_cpu"]="x86_64"
-S["host"]="x86_64-unknown-linux-gnu"
-S["build_os"]="linux-gnu"
-S["build_vendor"]="unknown"
-S["build_cpu"]="x86_64"
-S["build"]="x86_64-unknown-linux-gnu"
-S["EGREP"]="/bin/grep -E"
-S["GREP"]="/bin/grep"
-S["CPP"]="gcc -E"
-S["OBJEXT"]="o"
-S["EXEEXT"]=""
-S["ac_ct_CC"]="gcc"
-S["CPPFLAGS"]=""
-S["LDFLAGS"]=" -Wl,-export-dynamic"
-S["CFLAGS"]="-g -O2"
-S["CC"]="gcc"
-S["target_alias"]=""
-S["host_alias"]=""
-S["build_alias"]=""
-S["LIBS"]="-lm "
-S["ECHO_T"]=""
-S["ECHO_N"]="-n"
-S["ECHO_C"]=""
-S["DEFS"]="-DHAVE_CONFIG_H"
-S["mandir"]="${datarootdir}/man"
-S["localedir"]="${datarootdir}/locale"
-S["libdir"]="${exec_prefix}/lib"
-S["psdir"]="${docdir}"
-S["pdfdir"]="${docdir}"
-S["dvidir"]="${docdir}"
-S["htmldir"]="${docdir}"
-S["infodir"]="${datarootdir}/info"
-S["docdir"]="${datarootdir}/doc/${PACKAGE}"
-S["oldincludedir"]="/usr/include"
-S["includedir"]="${prefix}/include"
-S["localstatedir"]="${prefix}/var"
-S["sharedstatedir"]="${prefix}/com"
-S["sysconfdir"]="${prefix}/etc"
-S["datadir"]="${datarootdir}"
-S["datarootdir"]="${prefix}/share"
-S["libexecdir"]="${exec_prefix}/libexec"
-S["sbindir"]="${exec_prefix}/sbin"
-S["bindir"]="${exec_prefix}/bin"
-S["program_transform_name"]="s,x,x,"
-S["prefix"]="/usr/local"
-S["exec_prefix"]="${prefix}"
-S["PACKAGE_BUGREPORT"]=""
-S["PACKAGE_STRING"]=""
-S["PACKAGE_VERSION"]=""
-S["PACKAGE_TARNAME"]=""
-S["PACKAGE_NAME"]=""
-S["PATH_SEPARATOR"]=":"
-S["SHELL"]="/bin/bash"
-_ACAWK
-cat >>"$tmp/subs1.awk" <<_ACAWK &&
-  for (key in S) S_is_set[key] = 1
-  FS = ""
-
-}
-{
-  line = $ 0
-  nfields = split(line, field, "@")
-  substed = 0
-  len = length(field[1])
-  for (i = 2; i < nfields; i++) {
-    key = field[i]
-    keylen = length(key)
-    if (S_is_set[key]) {
-      value = S[key]
-      line = substr(line, 1, len) "" value "" substr(line, len + keylen + 3)
-      len += length(value) + length(field[++i])
-      substed = 1
-    } else
-      len += 1 + keylen
-  }
-
-  print line
-}
-
-_ACAWK
-if sed "s/$ac_cr//" < /dev/null > /dev/null 2>&1; then
-  sed "s/$ac_cr\$//; s/$ac_cr/$ac_cs_awk_cr/g"
-else
-  cat
-fi < "$tmp/subs1.awk" > "$tmp/subs.awk" \
-  || { { $as_echo "$as_me:$LINENO: error: could not setup config files machinery" >&5
-$as_echo "$as_me: error: could not setup config files machinery" >&2;}
-   { (exit 1); exit 1; }; }
-fi # test -n "$CONFIG_FILES"
-
-# Set up the scripts for CONFIG_HEADERS section.
-# No need to generate them if there are no CONFIG_HEADERS.
-# This happens for instance with `./config.status Makefile'.
-if test -n "$CONFIG_HEADERS"; then
-cat >"$tmp/defines.awk" <<\_ACAWK ||
-BEGIN {
-D["PACKAGE_NAME"]=" \"\""
-D["PACKAGE_TARNAME"]=" \"\""
-D["PACKAGE_VERSION"]=" \"\""
-D["PACKAGE_STRING"]=" \"\""
-D["PACKAGE_BUGREPORT"]=" \"\""
-D["STDC_HEADERS"]=" 1"
-D["HAVE_SYS_TYPES_H"]=" 1"
-D["HAVE_SYS_STAT_H"]=" 1"
-D["HAVE_STDLIB_H"]=" 1"
-D["HAVE_STRING_H"]=" 1"
-D["HAVE_MEMORY_H"]=" 1"
-D["HAVE_STRINGS_H"]=" 1"
-D["HAVE_INTTYPES_H"]=" 1"
-D["HAVE_STDINT_H"]=" 1"
-D["HAVE_UNISTD_H"]=" 1"
-D["__EXTENSIONS__"]=" 1"
-D["_ALL_SOURCE"]=" 1"
-D["_GNU_SOURCE"]=" 1"
-D["_POSIX_PTHREAD_SEMANTICS"]=" 1"
-D["_TANDEM_SOURCE"]=" 1"
-D["STDC_HEADERS"]=" 1"
-D["HAVE_STRING_H"]=" 1"
-D["HAVE_STL"]=" 1"
-D["CPP_REQUIRES_NAMESPACE"]=" 1"
-D["HAVE_TCL_H"]=" 1"
-D["HAVE_TCLINT_H"]=" 1"
-D["HAVE_LIBTCL8_4"]=" 1"
-D["HAVE_TK_H"]=" 1"
-D["HAVE_LIBTK8_4"]=" 1"
-D["HAVE_OTCL_H"]=" 1"
-D["HAVE_LIBOTCL1_13"]=" 1"
-D["HAVE_TCLCL_H"]=" 1"
-D["HAVE_LIBTCLCL"]=" 1"
-D["STDC_HEADERS"]=" 1"
-D["HAVE_ARPA_INET_H"]=" 1"
-D["HAVE_FENV_H"]=" 1"
-D["HAVE_NETINET_IN_H"]=" 1"
-D["HAVE_STRING_H"]=" 1"
-D["HAVE_STRINGS_H"]=" 1"
-D["HAVE_TIME_H"]=" 1"
-D["HAVE_UNISTD_H"]=" 1"
-D["HAVE_NET_ETHERNET_H"]=" 1"
-D["HAVE_LIBM"]=" 1"
-D["HAVE_BCOPY"]=" 1"
-D["HAVE_BZERO"]=" 1"
-D["HAVE_FEENABLEEXCEPT"]=" 1"
-D["HAVE_GETRUSAGE"]=" 1"
-D["HAVE_SBRK"]=" 1"
-D["HAVE_SNPRINTF"]=" 1"
-D["RANDOM_RETURN_TYPE"]=" long"
-D["HAVE_STRTOQ"]=" 1"
-D["HAVE_STRTOLL"]=" 1"
-D["SIZEOF_LONG"]=" 8"
-D["HAVE_INT64"]=" 1"
-D["HAVE_ETHER_HEADER_STRUCT"]=" 1"
-D["HAVE_ETHER_ADDRESS_STRUCT"]=" 1"
-D["HAVE_SIOCGIFHWADDR"]=" 1"
-D["HAVE_SOCKLEN_T"]=" 1"
-  for (key in D) D_is_set[key] = 1
-  FS = ""
-}
-/^[\t ]*#[\t ]*(define|undef)[\t ]+[_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ][_abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789]*([\t (]|$)/ {
-  line = $ 0
-  split(line, arg, " ")
-  if (arg[1] == "#") {
-    defundef = arg[2]
-    mac1 = arg[3]
-  } else {
-    defundef = substr(arg[1], 2)
-    mac1 = arg[2]
-  }
-  split(mac1, mac2, "(") #)
-  macro = mac2[1]
-  prefix = substr(line, 1, index(line, defundef) - 1)
-  if (D_is_set[macro]) {
-    # Preserve the white space surrounding the "#".
-    print prefix "define", macro P[macro] D[macro]
-    next
-  } else {
-    # Replace #undef with comments.  This is necessary, for example,
-    # in the case of _POSIX_SOURCE, which is predefined and required
-    # on some systems where configure will not decide to define it.
-    if (defundef == "undef") {
-      print "/*", prefix defundef, macro, "*/"
-      next
-    }
-  }
-}
-{ print }
-_ACAWK
-  { { $as_echo "$as_me:$LINENO: error: could not setup config headers machinery" >&5
-$as_echo "$as_me: error: could not setup config headers machinery" >&2;}
-   { (exit 1); exit 1; }; }
-fi # test -n "$CONFIG_HEADERS"
-
-
-eval set X "  :F $CONFIG_FILES  :H $CONFIG_HEADERS    "
-shift
-for ac_tag
-do
-  case $ac_tag in
-  :[FHLC]) ac_mode=$ac_tag; continue;;
-  esac
-  case $ac_mode$ac_tag in
-  :[FHL]*:*);;
-  :L* | :C*:*) { { $as_echo "$as_me:$LINENO: error: invalid tag $ac_tag" >&5
-$as_echo "$as_me: error: invalid tag $ac_tag" >&2;}
-   { (exit 1); exit 1; }; };;
-  :[FH]-) ac_tag=-:-;;
-  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
-  esac
-  ac_save_IFS=$IFS
-  IFS=:
-  set x $ac_tag
-  IFS=$ac_save_IFS
-  shift
-  ac_file=$1
-  shift
-
-  case $ac_mode in
-  :L) ac_source=$1;;
-  :[FH])
-    ac_file_inputs=
-    for ac_f
-    do
-      case $ac_f in
-      -) ac_f="$tmp/stdin";;
-      *) # Look for the file first in the build tree, then in the source tree
-	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
-	 # because $ac_f cannot contain `:'.
-	 test -f "$ac_f" ||
-	   case $ac_f in
-	   [\\/$]*) false;;
-	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
-	   esac ||
-	   { { $as_echo "$as_me:$LINENO: error: cannot find input file: $ac_f" >&5
-$as_echo "$as_me: error: cannot find input file: $ac_f" >&2;}
-   { (exit 1); exit 1; }; };;
-      esac
-      case $ac_f in *\'*) ac_f=`$as_echo "$ac_f" | sed "s/'/'\\\\\\\\''/g"`;; esac
-      ac_file_inputs="$ac_file_inputs '$ac_f'"
-    done
-
-    # Let's still pretend it is `configure' which instantiates (i.e., don't
-    # use $as_me), people would be surprised to read:
-    #    /* config.h.  Generated by config.status.  */
-    configure_input='Generated from '`
-	  $as_echo "$*" | sed 's|^[^:]*/||;s|:[^:]*/|, |g'
-	`' by configure.'
-    if test x"$ac_file" != x-; then
-      configure_input="$ac_file.  $configure_input"
-      { $as_echo "$as_me:$LINENO: creating $ac_file" >&5
-$as_echo "$as_me: creating $ac_file" >&6;}
-    fi
-    # Neutralize special characters interpreted by sed in replacement strings.
-    case $configure_input in #(
-    *\&* | *\|* | *\\* )
-       ac_sed_conf_input=`$as_echo "$configure_input" |
-       sed 's/[\\\\&|]/\\\\&/g'`;; #(
-    *) ac_sed_conf_input=$configure_input;;
-    esac
-
-    case $ac_tag in
-    *:-:* | *:-) cat >"$tmp/stdin" \
-      || { { $as_echo "$as_me:$LINENO: error: could not create $ac_file" >&5
-$as_echo "$as_me: error: could not create $ac_file" >&2;}
-   { (exit 1); exit 1; }; } ;;
-    esac
-    ;;
-  esac
-
-  ac_dir=`$as_dirname -- "$ac_file" ||
-$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$ac_file" : 'X\(//\)[^/]' \| \
-	 X"$ac_file" : 'X\(//\)$' \| \
-	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X"$ac_file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-  { as_dir="$ac_dir"
-  case $as_dir in #(
-  -*) as_dir=./$as_dir;;
-  esac
-  test -d "$as_dir" || { $as_mkdir_p && mkdir -p "$as_dir"; } || {
-    as_dirs=
-    while :; do
-      case $as_dir in #(
-      *\'*) as_qdir=`$as_echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
-      *) as_qdir=$as_dir;;
-      esac
-      as_dirs="'$as_qdir' $as_dirs"
-      as_dir=`$as_dirname -- "$as_dir" ||
-$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-	 X"$as_dir" : 'X\(//\)[^/]' \| \
-	 X"$as_dir" : 'X\(//\)$' \| \
-	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
-$as_echo X"$as_dir" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)[^/].*/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\/\)$/{
-	    s//\1/
-	    q
-	  }
-	  /^X\(\/\).*/{
-	    s//\1/
-	    q
-	  }
-	  s/.*/./; q'`
-      test -d "$as_dir" && break
-    done
-    test -z "$as_dirs" || eval "mkdir $as_dirs"
-  } || test -d "$as_dir" || { { $as_echo "$as_me:$LINENO: error: cannot create directory $as_dir" >&5
-$as_echo "$as_me: error: cannot create directory $as_dir" >&2;}
-   { (exit 1); exit 1; }; }; }
-  ac_builddir=.
-
-case "$ac_dir" in
-.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
-*)
-  ac_dir_suffix=/`$as_echo "$ac_dir" | sed 's|^\.[\\/]||'`
-  # A ".." for each directory in $ac_dir_suffix.
-  ac_top_builddir_sub=`$as_echo "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
-  case $ac_top_builddir_sub in
-  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
-  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
-  esac ;;
-esac
-ac_abs_top_builddir=$ac_pwd
-ac_abs_builddir=$ac_pwd$ac_dir_suffix
-# for backward compatibility:
-ac_top_builddir=$ac_top_build_prefix
-
-case $srcdir in
-  .)  # We are building in place.
-    ac_srcdir=.
-    ac_top_srcdir=$ac_top_builddir_sub
-    ac_abs_top_srcdir=$ac_pwd ;;
-  [\\/]* | ?:[\\/]* )  # Absolute name.
-    ac_srcdir=$srcdir$ac_dir_suffix;
-    ac_top_srcdir=$srcdir
-    ac_abs_top_srcdir=$srcdir ;;
-  *) # Relative name.
-    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
-    ac_top_srcdir=$ac_top_build_prefix$srcdir
-    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
-esac
-ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
-
-
-  case $ac_mode in
-  :F)
-  #
-  # CONFIG_FILE
-  #
-
-  case $INSTALL in
-  [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
-  *) ac_INSTALL=$ac_top_build_prefix$INSTALL ;;
-  esac
-# If the template does not know about datarootdir, expand it.
-# FIXME: This hack should be removed a few years after 2.60.
-ac_datarootdir_hack=; ac_datarootdir_seen=
-
-ac_sed_dataroot='
-/datarootdir/ {
-  p
-  q
-}
-/@datadir@/p
-/@docdir@/p
-/@infodir@/p
-/@localedir@/p
-/@mandir@/p
-'
-case `eval "sed -n \"\$ac_sed_dataroot\" $ac_file_inputs"` in
-*datarootdir*) ac_datarootdir_seen=yes;;
-*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
-  { $as_echo "$as_me:$LINENO: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
-$as_echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
-  ac_datarootdir_hack='
-  s&@datadir@&${datarootdir}&g
-  s&@docdir@&${datarootdir}/doc/${PACKAGE}&g
-  s&@infodir@&${datarootdir}/info&g
-  s&@localedir@&${datarootdir}/locale&g
-  s&@mandir@&${datarootdir}/man&g
-    s&\${datarootdir}&${prefix}/share&g' ;;
-esac
-ac_sed_extra="/^[	 ]*VPATH[	 ]*=/{
-s/:*\$(srcdir):*/:/
-s/:*\${srcdir}:*/:/
-s/:*@srcdir@:*/:/
-s/^\([^=]*=[	 ]*\):*/\1/
-s/:*$//
-s/^[^=]*=[	 ]*$//
-}
-
-:t
-/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
-s|@configure_input@|$ac_sed_conf_input|;t t
-s&@top_builddir@&$ac_top_builddir_sub&;t t
-s&@top_build_prefix@&$ac_top_build_prefix&;t t
-s&@srcdir@&$ac_srcdir&;t t
-s&@abs_srcdir@&$ac_abs_srcdir&;t t
-s&@top_srcdir@&$ac_top_srcdir&;t t
-s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
-s&@builddir@&$ac_builddir&;t t
-s&@abs_builddir@&$ac_abs_builddir&;t t
-s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
-s&@INSTALL@&$ac_INSTALL&;t t
-$ac_datarootdir_hack
-"
-eval sed \"\$ac_sed_extra\" "$ac_file_inputs" | $AWK -f "$tmp/subs.awk" >$tmp/out \
-  || { { $as_echo "$as_me:$LINENO: error: could not create $ac_file" >&5
-$as_echo "$as_me: error: could not create $ac_file" >&2;}
-   { (exit 1); exit 1; }; }
-
-test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
-  { ac_out=`sed -n '/\${datarootdir}/p' "$tmp/out"`; test -n "$ac_out"; } &&
-  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' "$tmp/out"`; test -z "$ac_out"; } &&
-  { $as_echo "$as_me:$LINENO: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&5
-$as_echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
-which seems to be undefined.  Please make sure it is defined." >&2;}
-
-  rm -f "$tmp/stdin"
-  case $ac_file in
-  -) cat "$tmp/out" && rm -f "$tmp/out";;
-  *) rm -f "$ac_file" && mv "$tmp/out" "$ac_file";;
-  esac \
-  || { { $as_echo "$as_me:$LINENO: error: could not create $ac_file" >&5
-$as_echo "$as_me: error: could not create $ac_file" >&2;}
-   { (exit 1); exit 1; }; }
- ;;
-  :H)
-  #
-  # CONFIG_HEADER
-  #
-  if test x"$ac_file" != x-; then
-    {
-      $as_echo "/* $configure_input  */" \
-      && eval '$AWK -f "$tmp/defines.awk"' "$ac_file_inputs"
-    } >"$tmp/config.h" \
-      || { { $as_echo "$as_me:$LINENO: error: could not create $ac_file" >&5
-$as_echo "$as_me: error: could not create $ac_file" >&2;}
-   { (exit 1); exit 1; }; }
-    if diff "$ac_file" "$tmp/config.h" >/dev/null 2>&1; then
-      { $as_echo "$as_me:$LINENO: $ac_file is unchanged" >&5
-$as_echo "$as_me: $ac_file is unchanged" >&6;}
-    else
-      rm -f "$ac_file"
-      mv "$tmp/config.h" "$ac_file" \
-	|| { { $as_echo "$as_me:$LINENO: error: could not create $ac_file" >&5
-$as_echo "$as_me: error: could not create $ac_file" >&2;}
-   { (exit 1); exit 1; }; }
-    fi
-  else
-    $as_echo "/* $configure_input  */" \
-      && eval '$AWK -f "$tmp/defines.awk"' "$ac_file_inputs" \
-      || { { $as_echo "$as_me:$LINENO: error: could not create -" >&5
-$as_echo "$as_me: error: could not create -" >&2;}
-   { (exit 1); exit 1; }; }
-  fi
- ;;
-
-
-  esac
-
-done # for ac_tag
-
-
-{ (exit 0); exit 0; }
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/calcdest and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/calcdest differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/calcdest.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/calcdest.o differ
diff -uNr ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/Makefile ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/Makefile
--- ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/Makefile	2017-02-22 17:05:35.010233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/Makefile	1970-01-01 08:00:00.000000000 +0800
@@ -1,90 +0,0 @@
-# 
-#  Copyright (c) 1999 by the University of Southern California
-#  All rights reserved.
-# 
-#  This program is free software; you can redistribute it and/or
-#  modify it under the terms of the GNU General Public License,
-#  version 2, as published by the Free Software Foundation.
-#
-#  This program is distributed in the hope that it will be useful,
-#  but WITHOUT ANY WARRANTY; without even the implied warranty of
-#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#  GNU General Public License for more details.
-#
-#  You should have received a copy of the GNU General Public License along
-#  with this program; if not, write to the Free Software Foundation, Inc.,
-#  59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
-#
-#  The copyright of this module includes the following
-#  linking-with-specific-other-licenses addition:
-#
-#  In addition, as a special exception, the copyright holders of
-#  this module give you permission to combine (via static or
-#  dynamic linking) this module with free software programs or
-#  libraries that are released under the GNU LGPL and with code
-#  included in the standard release of ns-2 under the Apache 2.0
-#  license or under otherwise-compatible licenses with advertising
-#  requirements (or modified versions of such code, with unchanged
-#  license).  You may copy and distribute such a system following the
-#  terms of the GNU GPL for this module and the licenses of the
-#  other code concerned, provided that you include the source code of
-#  that other code when and as the GNU GPL requires distribution of
-#  source code.
-#
-#  Note that people who make modified versions of this module
-#  are not obligated to grant this special exception for their
-#  modified versions; it is their choice whether to do so.  The GNU
-#  General Public License gives permission to release a modified
-#  version without this exception; this exception also makes it
-#  possible to release a modified version which carries forward this
-#  exception.
-#
-# Makefile for CMU mobile code scenario generation.
-#
-# $Header: /cvsroot/nsnam/ns-2/indep-utils/cmu-scen-gen/setdest/Makefile.in,v 1.12 2005/09/16 03:05:40 tomh Exp $
-
-# Top level hierarchy
-prefix	= /usr/local
-# Pathname of directory to install the binary
-BINDEST	= /usr/local/bin
-
-CCX = g++
-CC = gcc
-MKDEP	= ../../../conf/mkdep
-
-# when including files from ns, we need to take care STL_NAMESPACE
-DEFINE = -Dstand_alone -DSTL_NAMESPACE=@STL_NAMESPACE@ -DCPP_NAMESPACE=std
-CFLAGS = -O2 -Wall -Wno-write-strings 
-LDFLAGS = 
-LIBS =  -lnsl -ldl -lm -lm 
-INSTALL = /usr/bin/install -c
-
-all: setdest calcdest
-
-install: setdest calcdest
-	$(INSTALL) -m 555 -o bin -g bin setdest $(DESTDIR)$(BINDEST)
-	$(INSTALL) -m 555 -o bin -g bin calcdest $(DESTDIR)$(BINDEST)
-
-setdest: rng.o setdest.o
-	$(CCX) -o setdest $@.o rng.o $(DEFINE) $(LDFLAGS) $(CFLAGS) \
-	$(LIBS)
-
-calcdest: rng.o calcdest.o
-	$(CCX) -o calcdest $@.o rng.o $(DEFINE) $(LDFLAGS) $(CFLAGS) \
-	$(LIBS)
-
-rng.o:
-	@rm -f $@
-	$(CCX) -c $(DEFINE) -I../../.. -o $@ ../../../tools/rng.cc
-
-setbox: setbox.o
-	$(CCX) -o setbox $@.o $(LDFLAGS) $(CFLAGS) $(LIBS)
-
-clean:
-	@rm -f setdest setbox *.o *.core
-
-.SUFFIXES: .cc
-
-.cc.o:
-	$(CCX) -c $(DEFINE) $(CFLAGS) -o $@ $*.cc
-
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/rng.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/rng.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/setdest and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/setdest differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/setdest.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/cmu-scen-gen/setdest/setdest.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/dec-tr-stat and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/dec-tr-stat differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/formsquid.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/formsquid.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/formtxt.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/formtxt.o differ
diff -uNr ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/Makefile ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/Makefile
--- ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/Makefile	2017-02-22 17:05:34.946233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/Makefile	1970-01-01 08:00:00.000000000 +0800
@@ -1,83 +0,0 @@
-# 
-#  Copyright (c) 1999 by the University of Southern California
-#  All rights reserved.
-# 
-#  This program is free software; you can redistribute it and/or
-#  modify it under the terms of the GNU General Public License,
-#  version 2, as published by the Free Software Foundation.
-#
-#  This program is distributed in the hope that it will be useful,
-#  but WITHOUT ANY WARRANTY; without even the implied warranty of
-#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#  GNU General Public License for more details.
-#
-#  You should have received a copy of the GNU General Public License along
-#  with this program; if not, write to the Free Software Foundation, Inc.,
-#  59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
-#
-#  The copyright of this module includes the following
-#  linking-with-specific-other-licenses addition:
-#
-#  In addition, as a special exception, the copyright holders of
-#  this module give you permission to combine (via static or
-#  dynamic linking) this module with free software programs or
-#  libraries that are released under the GNU LGPL and with code
-#  included in the standard release of ns-2 under the Apache 2.0
-#  license or under otherwise-compatible licenses with advertising
-#  requirements (or modified versions of such code, with unchanged
-#  license).  You may copy and distribute such a system following the
-#  terms of the GNU GPL for this module and the licenses of the
-#  other code concerned, provided that you include the source code of
-#  that other code when and as the GNU GPL requires distribution of
-#  source code.
-#
-#  Note that people who make modified versions of this module
-#  are not obligated to grant this special exception for their
-#  modified versions; it is their choice whether to do so.  The GNU
-#  General Public License gives permission to release a modified
-#  version without this exception; this exception also makes it
-#  possible to release a modified version which carries forward this
-#  exception.
-# 
-# Makefile for DEC trace parsing.
-# (ftp://ftp.digital.com/pub/DEC/traces/proxy/webtraces.html)
-# 
-# Taken from Alex Rousskov's originial code. 
-#
-# $Header: /cvsroot/nsnam/ns-2/indep-utils/webtrace-conv/dec/Makefile.in,v 1.7 2005/09/16 03:05:40 tomh Exp $
-
-# Top level hierarchy
-prefix  = /usr/local
-# Pathname of directory to install the binary
-BINDEST = /usr/local/bin
-
-CC = g++
-INCLUDE = -I. -I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/include/pcap
-CFLAGS = -O2 -Wall -Wno-write-strings -DCPP_NAMESPACE=std
-LDFLAGS = 
-LIBS = -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4  -lnsl -ldl -lm 
-INSTALL = /usr/bin/install -c
-
-SRC = proxytrace.cc formsquid.cc formtxt.cc my-endian.cc \
-	proxytrace2any.cc tr-stat.cc
-OBJ = $(SRC:.cc=.o)
-
-all: dec-tr-stat
-
-install: dec-tr-stat
-	$(INSTALL) -m 555 -o bin -g bin dec-tr-stat $(DESTDIR)$(BINDEST)
-
-dec-tr-stat: $(OBJ)
-	$(CC) $(LDFLAGS) $(CFLAGS) -o $@ $(OBJ) $(LIBS)
-
-.SUFFIXES: .cc
-
-.cc.o: 
-	@rm -f $@
-	$(CC) -c $(CFLAGS) $(INCLUDE) -o $@ $*.cc
-
-clean: 
-	rm -f *.o *~ dec-tr-stat *core
-
-depend: $(SRC)
-	$(MKDEP) $(CFLAGS) $(INCLUDES) $(SRC)
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/my-endian.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/my-endian.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/proxytrace2any.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/proxytrace2any.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/proxytrace.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/proxytrace.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/tr-stat.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/dec/tr-stat.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/epa-tr-stat and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/epa-tr-stat differ
diff -uNr ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/Makefile ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/Makefile
--- ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/Makefile	2017-02-22 17:05:34.986233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/Makefile	1970-01-01 08:00:00.000000000 +0800
@@ -1,79 +0,0 @@
-# 
-#  Copyright (c) 1999 by the University of Southern California
-#  All rights reserved.
-# 
-#  This program is free software; you can redistribute it and/or
-#  modify it under the terms of the GNU General Public License,
-#  version 2, as published by the Free Software Foundation.
-#
-#  This program is distributed in the hope that it will be useful,
-#  but WITHOUT ANY WARRANTY; without even the implied warranty of
-#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#  GNU General Public License for more details.
-#
-#  You should have received a copy of the GNU General Public License along
-#  with this program; if not, write to the Free Software Foundation, Inc.,
-#  59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
-#
-#  The copyright of this module includes the following
-#  linking-with-specific-other-licenses addition:
-#
-#  In addition, as a special exception, the copyright holders of
-#  this module give you permission to combine (via static or
-#  dynamic linking) this module with free software programs or
-#  libraries that are released under the GNU LGPL and with code
-#  included in the standard release of ns-2 under the Apache 2.0
-#  license or under otherwise-compatible licenses with advertising
-#  requirements (or modified versions of such code, with unchanged
-#  license).  You may copy and distribute such a system following the
-#  terms of the GNU GPL for this module and the licenses of the
-#  other code concerned, provided that you include the source code of
-#  that other code when and as the GNU GPL requires distribution of
-#  source code.
-#
-#  Note that people who make modified versions of this module
-#  are not obligated to grant this special exception for their
-#  modified versions; it is their choice whether to do so.  The GNU
-#  General Public License gives permission to release a modified
-#  version without this exception; this exception also makes it
-#  possible to release a modified version which carries forward this
-#  exception.
-#
-# $Header: /cvsroot/nsnam/ns-2/indep-utils/webtrace-conv/epa/Makefile.in,v 1.6 2005/09/16 03:05:40 tomh Exp $
-
-# Top level hierarchy
-prefix  = /usr/local
-# Pathname of directory to install the binary
-BINDEST = /usr/local/bin
-
-CC = g++
-MKDEP	= ../../../conf/mkdep
-
-INCLUDE = -I. -I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/include/pcap
-CFLAGS = -O2 -Wall -Wno-write-strings -DCPP_NAMESPACE=std
-LDFLAGS = 
-LIBS = -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4  -lnsl -ldl -lm 
-INSTALL = /usr/bin/install -c
-
-SRC = tr-stat.cc
-OBJ = $(SRC:.cc=.o)
-
-all: epa-tr-stat
-
-epa-tr-stat: $(OBJ)
-	$(CC) -o $@ $(LDFLAGS) $(CFLAGS) $(INCLUDE) $(OBJ) $(LIBS)
-
-install: epa-tr-stat
-	$(INSTALL) -m 555 -o bin -g bin epa-tr-stat $(DESTDIR)$(BINDEST)
-
-.SUFFIXES: .cc
-
-.cc.o: 
-	@rm -f $@
-	$(CC) -c $(CFLAGS) $(INCLUDE) -o $@ $*.cc
-
-clean: 
-	@rm -f *~ *.o epa-tr-stat *core
-
-depend: $(SRC)
-	$(MKDEP) $(CFLAGS) $(INCLUDE) $(SRC)
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/tr-stat.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/epa/tr-stat.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/logparse.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/logparse.o differ
diff -uNr ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/Makefile ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/Makefile
--- ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/Makefile	2017-02-22 17:05:34.966233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/Makefile	1970-01-01 08:00:00.000000000 +0800
@@ -1,79 +0,0 @@
-# 
-#  Copyright (c) 1999 by the University of Southern California
-#  All rights reserved.
-# 
-#  This program is free software; you can redistribute it and/or
-#  modify it under the terms of the GNU General Public License,
-#  version 2, as published by the Free Software Foundation.
-#
-#  This program is distributed in the hope that it will be useful,
-#  but WITHOUT ANY WARRANTY; without even the implied warranty of
-#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-#  GNU General Public License for more details.
-#
-#  You should have received a copy of the GNU General Public License along
-#  with this program; if not, write to the Free Software Foundation, Inc.,
-#  59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
-#
-#  The copyright of this module includes the following
-#  linking-with-specific-other-licenses addition:
-#
-#  In addition, as a special exception, the copyright holders of
-#  this module give you permission to combine (via static or
-#  dynamic linking) this module with free software programs or
-#  libraries that are released under the GNU LGPL and with code
-#  included in the standard release of ns-2 under the Apache 2.0
-#  license or under otherwise-compatible licenses with advertising
-#  requirements (or modified versions of such code, with unchanged
-#  license).  You may copy and distribute such a system following the
-#  terms of the GNU GPL for this module and the licenses of the
-#  other code concerned, provided that you include the source code of
-#  that other code when and as the GNU GPL requires distribution of
-#  source code.
-#
-#  Note that people who make modified versions of this module
-#  are not obligated to grant this special exception for their
-#  modified versions; it is their choice whether to do so.  The GNU
-#  General Public License gives permission to release a modified
-#  version without this exception; this exception also makes it
-#  possible to release a modified version which carries forward this
-#  exception.
-#
-# Makefile for NLANR web cache trace processing (http://ircache.nlanr.org).
-#
-# $Header: /cvsroot/nsnam/ns-2/indep-utils/webtrace-conv/nlanr/Makefile.in,v 1.8 2005/09/16 03:05:41 tomh Exp $
-
-# Top level hierarchy
-prefix  = /usr/local
-# Pathname of directory to install the binary
-BINDEST = /usr/local/bin
-
-CC = g++
-INCLUDE = -I. -I../../.. -I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/include/pcap
-CFLAGS = -O2 -Wall -Wno-write-strings -DCPP_NAMESPACE=std
-LDFLAGS = 
-LIBS = -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4  -lnsl -ldl -lm 
-INSTALL = /usr/bin/install -c
-
-SRC = tr-stat.cc logparse.cc
-OBJ = $(SRC:.cc=.o)
-
-all: nlanr-tr-stat
-
-nlanr-tr-stat: $(OBJ)
-	$(CC) $(LDFLAGS) $(CFLAGS) -o $@ $(OBJ) $(LIBS)
-
-install: nlanr-tr-stat
-	$(INSTALL) -m 555 -o bin -g bin nlanr-tr-stat $(DESTDIR)$(BINDEST)
-
-.SUFFIXES: .cc 
-
-.cc.o: 
-	@rm -f $@
-	$(CC) -c $(CFLAGS) $(INCLUDE) -o $@ $*.cc
-
-clean: 
-	rm -f *.o *~ nlanr-tr-stat *core
-
-depend: $(SRC)
-	$(MKDEP) $(CFLAGS) $(INCLUDE) $(SRC)
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/nlanr-tr-stat and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/nlanr-tr-stat differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/tr-stat.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/nlanr/tr-stat.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/logparse.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/logparse.o differ
diff -uNr ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/Makefile ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/Makefile
--- ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/Makefile	2017-02-22 17:05:34.922233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/Makefile	1970-01-01 08:00:00.000000000 +0800
@@ -1,60 +0,0 @@
-# COPYRIGHT AND DISCLAIMER
-# 
-# Copyright (C) 1996-1997 by the Regents of the University of California.
-# Copyright (c) 1999 by the University of Southern California
-#
-# IN NO EVENT SHALL THE AUTHORS OR DISTRIBUTORS BE LIABLE TO ANY PARTY FOR
-# DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES ARISING OUT
-# OF THE USE OF THIS SOFTWARE, ITS DOCUMENTATION, OR ANY DERIVATIVES THEREOF,
-# EVEN IF THE AUTHORS HAVE BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-# 
-# THE AUTHORS AND DISTRIBUTORS SPECIFICALLY DISCLAIM ANY WARRANTIES,
-# INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
-# FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT. THIS SOFTWARE IS
-# PROVIDED ON AN "AS IS" BASIS, AND THE AUTHORS AND DISTRIBUTORS HAVE NO
-# OBLIGATION TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR
-# MODIFICATIONS.
-#
-# Taken from the UCB Home-IP trace by Steve Gribble <gribble@cs.berkeley.edu>
-#
-# $Header: /cvsroot/nsnam/ns-2/indep-utils/webtrace-conv/ucb/Makefile.in,v 1.4 2004/05/18 15:10:42 johnh Exp $
-
-# Top level hierarchy
-prefix  = /usr/local
-# Pathname of directory to install the binary
-BINDEST = /usr/local/bin
-
-CC = g++
-MKDEP	= ../../../conf/mkdep
-
-INCLUDE = -I. -I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/include/pcap
-CFLAGS = -O2 -Wall -Wno-write-strings -DCPP_NAMESPACE=std
-LDFLAGS = 
-LIBS = -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4  -lnsl -ldl -lm 
-INSTALL = /usr/bin/install -c
-
-SRC = tr-stat.cc logparse.cc utils.cc
-OBJ = $(SRC:.cc=.o)
-
-all: ucb-tr-stat
-
-ucb-tr-stat: $(OBJ)
-	$(CC) $(LDFLAGS) $(CFLAGS) -o $@ $(OBJ) $(LIBS)
-
-install: ucb-tr-stat
-	$(INSTALL) -m 555 -o bin -g bin ucb-tr-stat $(DESTDIR)$(BINDEST)
-
-.SUFFIXES: .cc
-
-.cc.o: 
-	@rm -f $@
-	$(CC) -c $(CFLAGS) $(INCLUDE) -o $@ $*.cc
-
-clean:
-	-/bin/rm -f *.o *~ ucb-tr-stat *core
-
-FORCE:
-	;
-
-depend: $(SRC)
-	$(MKDEP) $(CFLAGS) $(INCLUDE) $(SRC)
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/tr-stat.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/tr-stat.o differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/ucb-tr-stat and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/ucb-tr-stat differ
Binary files ./ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/utils.o and ./ori-ns-allinone-2.34/ns-2.34/indep-utils/webtrace-conv/ucb/utils.o differ
diff -uNr ./ns-allinone-2.34/ns-2.34/linkstate/ls.h ./ori-ns-allinone-2.34/ns-2.34/linkstate/ls.h
--- ./ns-allinone-2.34/ns-2.34/linkstate/ls.h	2017-02-11 21:08:39.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/linkstate/ls.h	2017-06-17 16:05:28.594083572 +0800
@@ -134,7 +134,7 @@
 		return ib.second ? ib.first : baseMap::end();
 	}
 
-	void eraseAll() { this->erase(baseMap::begin(), baseMap::end()); }
+	void eraseAll() { erase(baseMap::begin(), baseMap::end()); }
 	T* findPtr(Key key) {
 		iterator it = baseMap::find(key);
 		return (it == baseMap::end()) ? (T *)NULL : &((*it).second);
diff -uNr ./ns-allinone-2.34/ns-2.34/mac/mac-802_11Ext.h ./ori-ns-allinone-2.34/ns-2.34/mac/mac-802_11Ext.h
--- ./ns-allinone-2.34/ns-2.34/mac/mac-802_11Ext.h	2017-02-11 21:08:39.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/mac/mac-802_11Ext.h	2017-06-17 16:05:28.594083572 +0800
@@ -62,7 +62,6 @@
 #define GET_ETHER_TYPE(x)		GET2BYTE((x))
 #define SET_ETHER_TYPE(x,y)            {u_int16_t t = (y); STORE2BYTE(x,&t);}
 #include "wireless-phyExt.h"
-#include <stddef.h>
 
 /* ======================================================================
  Frame Formats
diff -uNr ./ns-allinone-2.34/ns-2.34/Makefile ./ori-ns-allinone-2.34/ns-2.34/Makefile
--- ./ns-allinone-2.34/ns-2.34/Makefile	2017-02-22 17:09:33.278233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/Makefile	1970-01-01 08:00:00.000000000 +0800
@@ -1,611 +0,0 @@
-#  Copyright (c) 1994, 1995, 1996
-# 	The Regents of the University of California.  All rights reserved.
-#
-#  Redistribution and use in source and binary forms, with or without
-#  modification, are permitted provided that: (1) source code distributions
-#  retain the above copyright notice and this paragraph in its entirety, (2)
-#  distributions including binary code include the above copyright notice and
-#  this paragraph in its entirety in the documentation or other materials
-#  provided with the distribution, and (3) all advertising materials mentioning
-#  features or use of this software display the following acknowledgement:
-#  ``This product includes software developed by the University of California,
-#  Lawrence Berkeley Laboratory and its contributors.'' Neither the name of
-#  the University nor the names of its contributors may be used to endorse
-#  or promote products derived from this software without specific prior
-#  written permission.
-#  THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED
-#  WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
-#  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
-#
-# @(#) $Header: 2002/10/09 15:34:11
-
-#
-# Various configurable paths (remember to edit Makefile.in, not Makefile)
-#
-
-# Top level hierarchy
-prefix	= /usr/local
-# Pathname of directory to install the binary
-BINDEST	= /usr/local/bin
-# Pathname of directory to install the man page
-MANDEST	= /usr/local/man
-
-BLANK	= # make a blank space.  DO NOT add anything to this line
-
-# The following will be redefined under Windows (see WIN32 lable below)
-CC	= gcc
-CPP	= g++
-LINK	= $(CPP)
-LINK_SHLIB = gcc -shared
-MKDEP	= ./conf/mkdep
-TCLSH	= /home/wtao/project-dct-build/ns-allinone-2.34/bin/tclsh8.4
-TCL2C	= ../tclcl-1.19/tcl2c++
-AR	= ar rc $(BLANK)
-
-RANLIB	= ranlib
-INSTALL	= /usr/bin/install -c
-LN	= ln
-TEST	= test
-RM	= rm -f
-MV      = mv
-PERL	= /usr/bin/perl
-
-# for diffusion
-#DIFF_INCLUDES = "./diffusion3/main ./diffusion3/lib ./diffusion3/nr ./diffusion3/ns"
-
-CCOPT	= -O2 -Wall -Wno-write-strings -g 
-STATIC	= 
-#LDFLAGS	= $(STATIC)
-LDFLAGS	=  -Wl,-export-dynamic 
-LDOUT	= -o $(BLANK)
-
-#DEFINE	= -DTCP_DELAY_BIND_ALL -DNO_TK -DTCLCL_CLASSINSTVAR  -DNDEBUG -DLINUX_TCP_HEADER -DUSE_SHM -DHAVE_LIBTCLCL -DHAVE_TCLCL_H -DHAVE_LIBOTCL1_13 -DHAVE_OTCL_H -DHAVE_LIBTK8_4 -DHAVE_TK_H -DHAVE_LIBTCL8_4 -DHAVE_TCLINT_H -DHAVE_TCL_H  -DHAVE_CONFIG_H -DNS_DIFFUSION -DSMAC_NO_SYNC -DCPP_NAMESPACE=std -DUSE_SINGLE_ADDRESS_SPACE -Drng_test -DNDEBUG -DDEBUG
-DEFINE	= -DTCP_DELAY_BIND_ALL -DNO_TK -DTCLCL_CLASSINSTVAR  -DNDEBUG -DLINUX_TCP_HEADER -DUSE_SHM -DHAVE_LIBTCLCL -DHAVE_TCLCL_H -DHAVE_LIBOTCL1_13 -DHAVE_OTCL_H -DHAVE_LIBTK8_4 -DHAVE_TK_H -DHAVE_LIBTCL8_4 -DHAVE_TCLINT_H -DHAVE_TCL_H  -DHAVE_CONFIG_H -DNS_DIFFUSION -DSMAC_NO_SYNC -DCPP_NAMESPACE=std -DUSE_SINGLE_ADDRESS_SPACE -Drng_test
-
-INCLUDES = \
-	-I.  \
-	-I. \
-	-I/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -I/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/home/wtao/project-dct-build/ns-allinone-2.34/include -I/usr/include/pcap \
-	-I./tcp -I./sctp -I./common -I./link -I./queue \
-	-I./adc -I./apps -I./mac -I./mobile -I./trace \
-	-I./routing -I./tools -I./classifier -I./mcast \
-	-I./diffusion3/lib/main -I./diffusion3/lib \
-	-I./diffusion3/lib/nr -I./diffusion3/ns \
-	-I./diffusion3/filter_core -I./asim/ -I./qs \
-	-I./diffserv -I./satellite \
-	-I./wpan
-
-
-LIB	= \
-	-L/home/wtao/project-dct-build/ns-allinone-2.34/tclcl-1.19 -ltclcl -L/home/wtao/project-dct-build/ns-allinone-2.34/otcl-1.13 -lotcl -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltk8.4 -L/home/wtao/project-dct-build/ns-allinone-2.34/lib -ltcl8.4 \
-	-lXext -lX11 \
-	 -lnsl -ldl \
-	-lm -lm 
-#	-L${exec_prefix}/lib \
-
-CFLAGS	+= $(CCOPT) $(DEFINE) 
-
-# Explicitly define compilation rules since SunOS 4's make doesn't like gcc.
-# Also, gcc does not remove the .o before forking 'as', which can be a
-# problem if you don't own the file but can write to the directory.
-.SUFFIXES: .cc	# $(.SUFFIXES)
-
-.cc.o:
-	@rm -f $@
-	$(CPP) -c $(CFLAGS) $(INCLUDES) -o $@ $*.cc
-
-.c.o:
-	@rm -f $@
-	$(CC) -c $(CFLAGS) $(INCLUDES) -o $@ $*.c
-
-
-GEN_DIR	= gen/
-LIB_DIR	= lib/
-NS	= ns
-NSLIB   = libns.so
-NSX	= nsx
-NSE	= nse
-NSTK = nstk
-
-# To allow conf/makefile.win overwrite this macro
-# We will set these two macros to empty in conf/makefile.win since VC6.0
-# does not seem to support the STL in gcc 2.8 and up. 
-OBJ_STL = diffusion3/lib/nr/nr.o diffusion3/lib/dr.o \
-	diffusion3/filters/diffusion/one_phase_pull.o \
-	diffusion3/filters/diffusion/two_phase_pull.o \
-	diffusion3/lib/diffapp.o \
-	diffusion3/ns/diffagent.o diffusion3/ns/diffrtg.o \
-	diffusion3/ns/difftimer.o \
-	diffusion3/filter_core/filter_core.o \
-	diffusion3/filter_core/iolog.o \
-	diffusion3/filter_core/iostats.o \
-	diffusion3/lib/main/attrs.o \
-	diffusion3/lib/main/events.o \
-	diffusion3/lib/main/iodev.o \
-	diffusion3/lib/main/iohook.o \
-	diffusion3/lib/main/timers.o \
-	diffusion3/lib/main/message.o \
-	diffusion3/lib/main/tools.o \
-	diffusion3/apps/gear_examples/gear_common.o \
-	diffusion3/apps/gear_examples/gear_receiver.o \
-	diffusion3/apps/gear_examples/gear_sender.o \
-	diffusion3/apps/rmst_examples/rmst_sink.o \
-	diffusion3/apps/rmst_examples/rmst_source.o \
-	diffusion3/apps/ping/1pp_ping_sender.o \
-	diffusion3/apps/ping/1pp_ping_receiver.o \
-	diffusion3/apps/ping/2pp_ping_sender.o \
-	diffusion3/apps/ping/2pp_ping_receiver.o \
-	diffusion3/apps/ping/ping_common.o \
-	diffusion3/apps/ping/push_receiver.o \
-	diffusion3/apps/ping/push_sender.o \
-	diffusion3/filters/gear/gear_attr.o \
-	diffusion3/filters/gear/gear.o \
-	diffusion3/filters/gear/gear_tools.o \
-	diffusion3/filters/misc/log.o \
-	diffusion3/filters/misc/srcrt.o \
-	diffusion3/filters/misc/tag.o \
-	diffusion3/filters/rmst/rmst.o \
-	diffusion3/filters/rmst/rmst_filter.o \
-	delaybox/delaybox.o \
-	packmime/packmime_HTTP.o packmime/packmime_HTTP_rng.o \
-	packmime/packmime_OL.o packmime/packmime_OL_ranvar.o\
-	packmime/packmime_ranvar.o \
-	tmix/tmix.o tmix/tmix_delaybox.o
-
-NS_TCL_LIB_STL = tcl/lib/ns-diffusion.tcl \
-	tcl/delaybox/delaybox.tcl \
-	tcl/packmime/packmime.tcl \
-	tcl/tmix/tmix.tcl \
-	tcl/tmix/tmix_delaybox.tcl
-
-
-# WIN32: uncomment the following line to include specific make for VC++
-# !include <conf/makefile.win>
-
-OBJ_CC = \
-	tools/random.o tools/rng.o tools/ranvar.o common/misc.o common/timer-handler.o \
-	common/scheduler.o common/object.o common/packet.o \
-	common/ip.o routing/route.o common/connector.o common/ttl.o \
-	trace/trace.o trace/trace-ip.o \
-	classifier/classifier.o classifier/classifier-addr.o \
-	classifier/classifier-hash.o \
-	classifier/classifier-virtual.o \
-	classifier/classifier-mcast.o \
-	classifier/classifier-bst.o \
-	classifier/classifier-mpath.o mcast/replicator.o \
-	classifier/classifier-mac.o \
-	classifier/classifier-qs.o \
-	classifier/classifier-port.o src_rtg/classifier-sr.o \
-        src_rtg/sragent.o src_rtg/hdr_src.o adc/ump.o \
-	qs/qsagent.o qs/hdr_qs.o \
-	apps/app.o apps/telnet.o tcp/tcplib-telnet.o \
-	tools/trafgen.o trace/traffictrace.o tools/pareto.o \
-	tools/expoo.o tools/cbr_traffic.o \
-	adc/tbf.o adc/resv.o adc/sa.o tcp/saack.o \
-	tools/measuremod.o adc/estimator.o adc/adc.o adc/ms-adc.o \
-	adc/timewindow-est.o adc/acto-adc.o \
-        adc/pointsample-est.o adc/salink.o adc/actp-adc.o \
-	adc/hb-adc.o adc/expavg-est.o\
-	adc/param-adc.o adc/null-estimator.o \
-	adc/adaptive-receiver.o apps/vatrcvr.o adc/consrcvr.o \
-	common/agent.o common/message.o apps/udp.o \
-	common/session-rtp.o apps/rtp.o tcp/rtcp.o \
-	common/ivs.o \
-	common/messpass.o common/tp.o common/tpm.o apps/worm.o \
-	tcp/tcp.o tcp/tcp-sink.o tcp/tcp-reno.o \
-	tcp/tcp-newreno.o \
-	tcp/tcp-vegas.o tcp/tcp-rbp.o tcp/tcp-full.o tcp/rq.o \
-	baytcp/tcp-full-bay.o baytcp/ftpc.o baytcp/ftps.o \
-	tcp/scoreboard.o tcp/scoreboard-rq.o tcp/tcp-sack1.o tcp/tcp-fack.o \
-	tcp/linux/tcp_naivereno.o\
-	tcp/linux/src/tcp_cong.o\
-	tcp/linux/src/tcp_highspeed.o tcp/linux/src/tcp_bic.o tcp/linux/src/tcp_htcp.o tcp/linux/src/tcp_scalable.o tcp/linux/src/tcp_cubic.o\
-	tcp/linux/src/tcp_westwood.o tcp/linux/src/tcp_vegas.o tcp/linux/src/tcp_hybla.o\
-	tcp/linux/src/tcp_illinois.o tcp/linux/src/tcp_yeah.o \
-	tcp/linux/src/tcp_veno.o tcp/linux/src/tcp_compound.o tcp/linux/src/tcp_lp.o\
-	tcp/scoreboard1.o tcp/tcp-linux.o tcp/linux/ns-linux-util.o tcp/linux/ns-linux-c.o tcp/linux/ns-linux-param.o\
-	tcp/tcp-asym.o tcp/tcp-asym-sink.o tcp/tcp-fs.o \
-	tcp/tcp-asym-fs.o \
-	tcp/tcp-int.o tcp/chost.o tcp/tcp-session.o \
-	tcp/nilist.o \
-	sctp/sctp.o apps/sctp_app1.o\
-	sctp/sctp-timestamp.o sctp/sctp-hbAfterRto.o \
-	sctp/sctp-multipleFastRtx.o sctp/sctp-mfrHbAfterRto.o \
-	sctp/sctp-mfrTimestamp.o \
-	sctp/sctp-cmt.o \
-	sctp/sctpDebug.o \
-	tools/integrator.o tools/queue-monitor.o \
-	tools/flowmon.o tools/loss-monitor.o \
-	queue/queue.o queue/drop-tail.o queue/prioqueue.o queue/edf-queue.o \
-	adc/simple-intserv-sched.o queue/red.o \
-	queue/semantic-packetqueue.o queue/semantic-red.o \
-	tcp/ack-recons.o \
-	queue/sfq.o queue/fq.o queue/drr.o queue/srr.o queue/cbq.o \
-	queue/jobs.o queue/marker.o queue/demarker.o \
-	link/hackloss.o queue/errmodel.o queue/fec.o\
-	link/delay.o tcp/snoop.o \
-	gaf/gaf.o \
-	link/dynalink.o routing/rtProtoDV.o common/net-interface.o \
-	mcast/ctrMcast.o mcast/mcast_ctrl.o mcast/srm.o \
-	common/sessionhelper.o queue/delaymodel.o \
-	mcast/srm-ssm.o mcast/srm-topo.o \
-	routing/alloc-address.o routing/address.o \
-	$(LIB_DIR)int.Vec.o $(LIB_DIR)int.RVec.o \
-	$(LIB_DIR)dmalloc_support.o \
-	webcache/http.o webcache/tcp-simple.o webcache/pagepool.o \
-	webcache/inval-agent.o webcache/tcpapp.o webcache/http-aux.o \
-	webcache/mcache.o webcache/webtraf.o \
-	webcache/webserver.o \
-	webcache/logweb.o \
-	empweb/empweb.o \
-	empweb/empftp.o \
-	realaudio/realaudio.o \
-	mac/lanRouter.o classifier/filter.o \
-	common/pkt-counter.o \
-	common/Decapsulator.o common/Encapsulator.o \
-	common/encap.o \
-	mac/channel.o mac/mac.o mac/ll.o mac/mac-802_11.o \
-	mac/mac-802_11Ext.o \
-	mac/mac-802_3.o mac/mac-tdma.o mac/smac.o \
-	mobile/mip.o mobile/mip-reg.o mobile/gridkeeper.o \
-	mobile/propagation.o mobile/tworayground.o \
-	mobile/nakagami.o \
-	mobile/antenna.o mobile/omni-antenna.o \
-	mobile/shadowing.o mobile/shadowing-vis.o mobile/dumb-agent.o \
-	common/bi-connector.o common/node.o \
-	common/mobilenode.o \
-	mac/arp.o mobile/god.o mobile/dem.o \
-	mobile/topography.o mobile/modulation.o \
-	queue/priqueue.o queue/dsr-priqueue.o \
-	mac/phy.o mac/wired-phy.o mac/wireless-phy.o \
-	mac/wireless-phyExt.o \
-	mac/mac-timers.o trace/cmu-trace.o mac/varp.o \
-	mac/mac-simple.o \
-	satellite/sat-hdlc.o \
-	dsdv/dsdv.o dsdv/rtable.o queue/rtqueue.o \
-	routing/rttable.o \
-	imep/imep.o imep/dest_queue.o imep/imep_api.o \
-	imep/imep_rt.o imep/rxmit_queue.o imep/imep_timers.o \
-	imep/imep_util.o imep/imep_io.o \
-	tora/tora.o tora/tora_api.o tora/tora_dest.o \
-	tora/tora_io.o tora/tora_logs.o tora/tora_neighbor.o \
-	dsr/dsragent.o dsr/hdr_sr.o dsr/mobicache.o dsr/path.o \
-	dsr/requesttable.o dsr/routecache.o dsr/add_sr.o \
-	dsr/dsr_proto.o dsr/flowstruct.o dsr/linkcache.o \
-	dsr/simplecache.o dsr/sr_forwarder.o \
-	aodv/aodv_logs.o aodv/aodv.o \
-	aodv/aodv_rtable.o aodv/aodv_rqueue.o \
-	aomdv/aomdv_logs.o aomdv/aomdv.o \
-	aomdv/aomdv_rtable.o aomdv/aomdv_rqueue.o \
-	common/ns-process.o \
-	satellite/satgeometry.o satellite/sathandoff.o \
-	satellite/satlink.o satellite/satnode.o \
-	satellite/satposition.o satellite/satroute.o \
-	satellite/sattrace.o \
-	rap/raplist.o rap/rap.o rap/media-app.o rap/utilities.o \
-	common/fsm.o tcp/tcp-abs.o \
-	diffusion/diffusion.o diffusion/diff_rate.o diffusion/diff_prob.o \
-	diffusion/diff_sink.o diffusion/flooding.o diffusion/omni_mcast.o \
-	diffusion/hash_table.o diffusion/routing_table.o diffusion/iflist.o \
-	tcp/tfrc.o tcp/tfrc-sink.o mobile/energy-model.o apps/ping.o tcp/tcp-rfc793edu.o \
-	queue/rio.o queue/semantic-rio.o tcp/tcp-sack-rh.o tcp/scoreboard-rh.o \
-	plm/loss-monitor-plm.o plm/cbr-traffic-PP.o \
-	linkstate/hdr-ls.o \
-	mpls/classifier-addr-mpls.o mpls/ldp.o mpls/mpls-module.o \
-	routing/rtmodule.o classifier/classifier-hier.o \
-	routing/addr-params.o \
-         nix/hdr_nv.o nix/classifier-nix.o \
-         nix/nixnode.o \
-         routealgo/rnode.o \
-         routealgo/bfs.o \
-         routealgo/rbitmap.o \
-         routealgo/rlookup.o \
-         routealgo/routealgo.o \
-         nix/nixvec.o \
-	nix/nixroute.o \
-	diffserv/dsred.o diffserv/dsredq.o \
-	diffserv/dsEdge.o diffserv/dsCore.o \
-	diffserv/dsPolicy.o diffserv/ew.o diffserv/dewp.o \
-	queue/red-pd.o queue/pi.o queue/vq.o queue/rem.o \
-	queue/gk.o \
-	pushback/rate-limit.o pushback/rate-limit-strategy.o \
-	pushback/ident-tree.o pushback/agg-spec.o \
-	pushback/logging-data-struct.o \
-	pushback/rate-estimator.o \
-	pushback/pushback-queue.o pushback/pushback.o \
-	common/parentnode.o trace/basetrace.o \
-	common/simulator.o asim/asim.o \
-	common/scheduler-map.o common/splay-scheduler.o \
-	linkstate/ls.o linkstate/rtProtoLS.o \
-	pgm/classifier-pgm.o pgm/pgm-agent.o pgm/pgm-sender.o \
-	pgm/pgm-receiver.o mcast/rcvbuf.o \
-	mcast/classifier-lms.o mcast/lms-agent.o mcast/lms-receiver.o \
-	mcast/lms-sender.o \
-	queue/delayer.o \
-	xcp/xcpq.o xcp/xcp.o xcp/xcp-end-sys.o \
-	wpan/p802_15_4csmaca.o wpan/p802_15_4fail.o \
-	wpan/p802_15_4hlist.o wpan/p802_15_4mac.o \
-	wpan/p802_15_4nam.o wpan/p802_15_4phy.o \
-	wpan/p802_15_4sscs.o wpan/p802_15_4timer.o \
-	wpan/p802_15_4trace.o wpan/p802_15_4transac.o \
-	apps/pbc.o \
-	$(OBJ_STL)
-
-
-# don't allow comments to follow continuation lines
-
-#  mac-csma.o mac-multihop.o\
-#	sensor-nets/landmark.o mac-simple-wireless.o \
-#	sensor-nets/tags.o sensor-nets/sensor-query.o \
-#	sensor-nets/flood-agent.o \
-
-# what was here before is now in emulate/
-OBJ_C =
-
-OBJ_COMPAT = $(OBJ_GETOPT) common/win32.o
-#XXX compat/win32x.o compat/tkConsole.o
-
-OBJ_EMULATE_CC = \
-	emulate/net-ip.o \
-	emulate/net.o \
-	emulate/tap.o \
-	emulate/ether.o \
-	emulate/internet.o \
-	emulate/ping_responder.o \
-	emulate/arp.o \
-	emulate/icmp.o \
-	emulate/net-pcap.o \
-	emulate/nat.o  \
-	emulate/iptap.o \
-	emulate/tcptap.o
-
-OBJ_EMULATE_C = \
-	emulate/inet.o
-
-OBJ_GEN = $(GEN_DIR)version.o $(GEN_DIR)ns_tcl.o $(GEN_DIR)ptypes.o
-
-SRC =	$(OBJ_C:.o=.c) $(OBJ_CC:.o=.cc) \
-	$(OBJ_EMULATE_C:.o=.c) $(OBJ_EMULATE_CC:.o=.cc) \
-	common/tclAppInit.cc common/tkAppInit.cc 
-
-OBJ =	$(OBJ_C) $(OBJ_CC) $(OBJ_GEN) $(OBJ_COMPAT)
-
-CLEANFILES = ns nse nsx ns.dyn $(OBJ) $(OBJ_EMULATE_CC) \
-	$(OBJ_EMULATE_C) common/tclAppInit.o \
-	common/tkAppInit.o nstk \
-	$(GEN_DIR)* $(NS).core core core.$(NS) core.$(NSX) core.$(NSE) \
-	common/ptypes2tcl common/ptypes2tcl.o 
-
-SUBDIRS=\
-	indep-utils/cmu-scen-gen/setdest \
-	indep-utils/webtrace-conv/dec \
-	indep-utils/webtrace-conv/epa \
-	indep-utils/webtrace-conv/nlanr \
-	indep-utils/webtrace-conv/ucb
-
-BUILD_NSE = 
-
-all: $(NS) $(BUILD_NSE) $(NSTK) all-recursive Makefile
-
-
-all-recursive:
-	for i in $(SUBDIRS); do ( cd $$i; $(MAKE) all; ) done
-
-
-
-
-ifeq ($(NSLIB),libns.dll)
-
-# This is for cygwin
-
-NS_CPPFLAGS = -DNSLIBNAME=\"$(NSLIB)\" 
-NS_LIBS =  -ldl
-
-$(NSLIB): $(OBJ) common/tclAppInit.o 
-	$(LINK) -shared $(LDFLAGS) \
-		$(LDOUT)$@  \
-		-Wl,--export-all-symbols \
-		-Wl,--enable-auto-import \
-		-Wl,--out-implib=$@.a \
-		-Wl,--whole-archive $^ \
-		-Wl,--no-whole-archive  
-
-$(NS): $(NSLIB) common/main-modular.cc 
-	$(LINK) $(NS_CPPFLAGS) $(LDFLAGS) $(LDOUT)$@ common/main-modular.cc $(NS_LIBS)
-
-else 
-
-# default for all systems but cygwin
-
-$(NS): $(OBJ) common/tclAppInit.o common/main-monolithic.o
-	$(LINK) $(LDFLAGS) $(LDOUT)$@ $^ $(LIB)
-
-endif 
-
-
-
-Makefile: Makefile.in
-	@echo "Makefile.in is newer than Makefile."
-	@echo "You need to re-run configure."
-	false
-
-$(NSE): $(OBJ) common/tclAppInit.o common/main-monolithic.o $(OBJ_EMULATE_CC) $(OBJ_EMULATE_C)
-	$(LINK) $(LDFLAGS) $(LDOUT)$@ $^ $(LIB) 
-
-$(NSTK): $(OBJ) common/tkAppInit.o 
-	$(LINK) $(LDFLAGS) $(LDOUT)$@ $^ $(LIB)
-
-ns.dyn: $(OBJ) common/tclAppInit.o common/main-monolithic.o 
-	$(LINK) $(LDFLAGS) -o $@ $^ $(LIB)
-
-PURIFY	= purify -cache-dir=/tmp
-ns-pure: $(OBJ) common/tclAppInit.o common/main-monolithic.o 
-	$(PURIFY) $(LINK) $(LDFLAGS) -o $@ $^ $(LIB)
-
-NS_TCL_LIB = \
-	tcl/lib/ns-compat.tcl \
-	tcl/lib/ns-default.tcl \
-	tcl/lib/ns-errmodel.tcl \
-	tcl/lib/ns-lib.tcl \
-	tcl/lib/ns-link.tcl \
-	tcl/lib/ns-mobilenode.tcl \
-	tcl/lib/ns-sat.tcl \
-	tcl/lib/ns-cmutrace.tcl \
-	tcl/lib/ns-node.tcl \
-	tcl/lib/ns-rtmodule.tcl \
-	tcl/lib/ns-hiernode.tcl \
-	tcl/lib/ns-packet.tcl \
-	tcl/lib/ns-queue.tcl \
-	tcl/lib/ns-source.tcl \
-	tcl/lib/ns-nam.tcl \
-	tcl/lib/ns-trace.tcl \
-	tcl/lib/ns-agent.tcl \
-	tcl/lib/ns-random.tcl \
-	tcl/lib/ns-namsupp.tcl \
-	tcl/lib/ns-address.tcl \
-	tcl/lib/ns-intserv.tcl \
-	tcl/lib/ns-autoconf.tcl \
-	tcl/rtp/session-rtp.tcl \
-	tcl/lib/ns-mip.tcl \
-	tcl/rtglib/dynamics.tcl \
-	tcl/rtglib/route-proto.tcl \
-	tcl/rtglib/algo-route-proto.tcl \
-	tcl/rtglib/ns-rtProtoLS.tcl \
-        tcl/interface/ns-iface.tcl \
-	tcl/mcast/BST.tcl \
-        tcl/mcast/ns-mcast.tcl \
-        tcl/mcast/McastProto.tcl \
-        tcl/mcast/DM.tcl \
-	tcl/mcast/srm.tcl \
-	tcl/mcast/srm-adaptive.tcl \
-	tcl/mcast/srm-ssm.tcl \
-	tcl/mcast/timer.tcl \
-	tcl/mcast/McastMonitor.tcl \
-	tcl/mobility/dsdv.tcl \
-	tcl/mobility/dsr.tcl \
-        tcl/ctr-mcast/CtrMcast.tcl \
-        tcl/ctr-mcast/CtrMcastComp.tcl \
-        tcl/ctr-mcast/CtrRPComp.tcl \
-	tcl/rlm/rlm.tcl \
-	tcl/rlm/rlm-ns.tcl \
-	tcl/session/session.tcl \
-	tcl/lib/ns-route.tcl \
-	tcl/emulate/ns-emulate.tcl \
-	tcl/lan/vlan.tcl \
-	tcl/lan/abslan.tcl \
-	tcl/lan/ns-ll.tcl \
-	tcl/lan/ns-mac.tcl \
-	tcl/webcache/http-agent.tcl \
-	tcl/webcache/http-server.tcl \
-	tcl/webcache/http-cache.tcl \
-	tcl/webcache/http-mcache.tcl \
-	tcl/webcache/webtraf.tcl \
-	tcl/webcache/empweb.tcl \
-	tcl/webcache/empftp.tcl \
-	tcl/plm/plm.tcl \
-	tcl/plm/plm-ns.tcl \
-	tcl/plm/plm-topo.tcl \
-	tcl/mpls/ns-mpls-classifier.tcl \
-	tcl/mpls/ns-mpls-ldpagent.tcl \
-	tcl/mpls/ns-mpls-node.tcl \
-	tcl/mpls/ns-mpls-simulator.tcl \
-	tcl/lib/ns-pushback.tcl \
-	tcl/lib/ns-srcrt.tcl \
-	tcl/mcast/ns-lms.tcl \
-	tcl/lib/ns-qsnode.tcl \
-	$(NS_TCL_LIB_STL)
-
-$(GEN_DIR)ns_tcl.cc: $(NS_TCL_LIB)
-	$(TCLSH) bin/tcl-expand.tcl tcl/lib/ns-lib.tcl $(NS_TCL_LIB_STL) | $(TCL2C) et_ns_lib > $@
-
-$(GEN_DIR)version.c: VERSION
-	$(RM) $@
-	$(TCLSH) bin/string2c.tcl version_string < VERSION > $@
-
-$(GEN_DIR)ptypes.cc: common/ptypes2tcl common/packet.h
-	./common/ptypes2tcl > $@
-
-common/ptypes2tcl: common/ptypes2tcl.o
-	$(LINK) $(LDFLAGS) $(LDOUT)$@ common/ptypes2tcl.o
-
-common/ptypes2tcl.o: common/ptypes2tcl.cc common/packet.h
-
-dirs:
-	for d in $(DESTDIR)$(MANDEST)/man1; do \
-		if [ ! -d $$d ]; then \
-			mkdir -p $$d ;\
-		fi;\
-	done
-
-
-install: dirs force install-ns install-man
-
-install-ns: force
-	$(INSTALL) -m 755 ns $(DESTDIR)$(BINDEST)
-
-install-man: force
-	$(INSTALL) -m 644 ns.1 $(DESTDIR)$(MANDEST)/man1
-
-install-recursive: force
-	for i in $(SUBDIRS); do ( cd $$i; $(MAKE) install; ) done
-
-clean:
-	$(RM) $(CLEANFILES)
-
-AUTOCONF_GEN = tcl/lib/ns-autoconf.tcl
-distclean: distclean-recursive
-	$(RM) $(CLEANFILES) Makefile config.cache config.log config.status \
-	    autoconf.h gnuc.h os-proto.h $(AUTOCONF_GEN); \
-	$(MV) .configure .configure- ;\
-	echo "Moved .configure to .configure-"
-
-distclean-recursive:
-	for i in $(SUBDIRS); do ( cd $$i; $(MAKE) clean; $(RM) Makefile; ) done
-
-tags:	force
-	ctags -wtd *.cc *.h webcache/*.cc webcache/*.h dsdv/*.cc dsdv/*.h \
-	dsr/*.cc dsr/*.h webcache/*.cc webcache/*.h lib/*.cc lib/*.h \
-	../Tcl/*.cc ../Tcl/*.h 
-
-TAGS:	force
-	etags *.cc *.h webcache/*.cc webcache/*.h dsdv/*.cc dsdv/*.h \
-	dsr/*.cc dsr/*.h webcache/*.cc webcache/*.h lib/*.cc lib/*.h \
-	../Tcl/*.cc ../Tcl/*.h
-
-tcl/lib/TAGS:	force
-	( \
-		cd tcl/lib; \
-		$(TCLSH) ../../bin/tcl-expand.tcl ns-lib.tcl | grep '^### tcl-expand.tcl: begin' | awk '{print $$5}' >.tcl_files; \
-		etags --lang=none -r '/^[ \t]*proc[ \t]+\([^ \t]+\)/\1/' `cat .tcl_files`; \
-		etags --append --lang=none -r '/^\([A-Z][^ \t]+\)[ \t]+\(instproc\|proc\)[ \t]+\([^ \t]+\)[ \t]+/\1::\3/' `cat .tcl_files`; \
-	)
-
-depend: $(SRC)
-	$(MKDEP) $(CFLAGS) $(INCLUDES) -- $(SRC) 2>&1 > /dev/null
-
-srctar:
-	@cwd=`pwd` ; dir=`basename $$cwd` ; \
-	    name=ns-`cat VERSION | tr A-Z a-z` ; \
-	    tar=ns-src-`cat VERSION`.tar.gz ; \
-	    list="" ; \
-	    for i in `cat FILES` ; do list="$$list $$name/$$i" ; done; \
-	    echo \
-	    "(rm -f $$tar; cd .. ; ln -s $$dir $$name)" ; \
-	     (rm -f $$tar; cd .. ; ln -s $$dir $$name) ; \
-	    echo \
-	    "(cd .. ; tar cfhz $$tar [lots of files])" ; \
-	     (cd .. ; tar cfhz - $$list) > $$tar ; \
-	    echo \
-	    "rm ../$$name; chmod 444 $$tar" ;  \
-	     rm ../$$name; chmod 444 $$tar
-
-force:
-
-test:	force
-	./validate
-
-# Create makefile.vc for Win32 development by replacing:
-# "# !include ..." 	-> 	"!include ..."
-makefile.vc:	Makefile.in
-	$(PERL) bin/gen-vcmake.pl < Makefile.in > makefile.vc
-#	$(PERL) -pe 's/^# (\!include)/\!include/o' < Makefile.in > makefile.vc
diff -uNr ./ns-allinone-2.34/ns-2.34/Makefile.in ./ori-ns-allinone-2.34/ns-2.34/Makefile.in
--- ./ns-allinone-2.34/ns-2.34/Makefile.in	2017-02-12 01:30:28.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/Makefile.in	2017-06-17 16:05:28.622069569 +0800
@@ -53,13 +53,12 @@
 # for diffusion
 #DIFF_INCLUDES = "./diffusion3/main ./diffusion3/lib ./diffusion3/nr ./diffusion3/ns"
 
-CCOPT	= @V_CCOPT@ -g 
+CCOPT	= @V_CCOPT@ 
 STATIC	= @V_STATIC@
 #LDFLAGS	= $(STATIC)
 LDFLAGS	= @LDFLAGS@ 
 LDOUT	= -o $(BLANK)
 
-#DEFINE	= -DTCP_DELAY_BIND_ALL -DNO_TK @V_DEFINE@ @V_DEFINES@ @DEFS@ -DNS_DIFFUSION -DSMAC_NO_SYNC -DCPP_NAMESPACE=@CPP_NAMESPACE@ -DUSE_SINGLE_ADDRESS_SPACE -Drng_test -DNDEBUG -DDEBUG
 DEFINE	= -DTCP_DELAY_BIND_ALL -DNO_TK @V_DEFINE@ @V_DEFINES@ @DEFS@ -DNS_DIFFUSION -DSMAC_NO_SYNC -DCPP_NAMESPACE=@CPP_NAMESPACE@ -DUSE_SINGLE_ADDRESS_SPACE -Drng_test
 
 INCLUDES = \
diff -uNr ./ns-allinone-2.34/ns-2.34/mobile/nakagami.cc ./ori-ns-allinone-2.34/ns-2.34/mobile/nakagami.cc
--- ./ns-allinone-2.34/ns-2.34/mobile/nakagami.cc	2017-02-11 21:08:39.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/mobile/nakagami.cc	2017-06-17 16:05:28.622069569 +0800
@@ -180,9 +180,9 @@
  		double resultPower;
  		
         if (int_m == m) {
- 			resultPower = ErlangRandomVariable(Pr/m, int_m).value();
+ 			resultPower = ErlangRandomVariable::ErlangRandomVariable(Pr/m, int_m).value();
  		} else {
- 			resultPower = GammaRandomVariable(m, Pr/m).value();
+ 			resultPower = GammaRandomVariable::GammaRandomVariable(m, Pr/m).value();
  		}
  		return resultPower;
 	}
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/drop-tail.cc ./ori-ns-allinone-2.34/ns-2.34/queue/drop-tail.cc
--- ./ns-allinone-2.34/ns-2.34/queue/drop-tail.cc	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/drop-tail.cc	2017-06-17 16:05:28.402179588 +0800
@@ -87,7 +87,7 @@
 	if (summarystats) {
                 Queue::updateStats(qib_?q_->byteLength():q_->length());
 	}
-	//printf("qlim_ = %d, qib_ = %d, mean_pktsize_ = %d\n", qlim_, qib_, mean_pktsize_);
+
 	int qlimBytes = qlim_ * mean_pktsize_;
 	if ((!qib_ && (q_->length() + 1) >= qlim_) ||
   	(qib_ && (q_->byteLength() + hdr_cmn::access(p)->size()) >= qlimBytes)){
@@ -96,77 +96,6 @@
 			q_->enque(p);
 			Packet *pp = q_->deque();
 			drop(pp);
-		}
-		else if (drop_prio_) {
-			Packet *max_pp = p;
-			int max_prio = 0;
-
-			q_->enque(p);
-			q_->resetIterator();
-			for (Packet *pp = q_->getNext(); pp != 0; pp = q_->getNext()) {
-				if (!qib_ || ( q_->byteLength() - hdr_cmn::access(pp)->size() < qlimBytes)) {
-					hdr_ip* h = hdr_ip::access(pp);
-					int prio = h->prio();
-					if (prio >= max_prio) {
-						max_pp = pp;
-						max_prio = prio;
-					}
-				}
-			}
-			q_->remove(max_pp);
-			drop(max_pp);	
-		}
-		else if (drop_smart_) {
-			Packet *max_pp = p;
-			int max_count = 0;
-			
-			q_->enque(p);			
-			q_->resetIterator();
-			for (Packet *pp = q_->getNext(); pp != 0; pp = q_->getNext()) {
-				hdr_ip* h = hdr_ip::access(pp);
-				FlowKey fkey;
-				fkey.src = h->saddr();
-				fkey.dst = h->daddr();
-				fkey.fid = h->flowid();
-			
-				char* fkey_buf = (char*) &fkey;
-				int length = sizeof(fkey);
-				string fkey_string(fkey_buf, length);
-			
-				std::tr1::hash<string> string_hasher;
-				size_t signature = string_hasher(fkey_string);	
-				
-				if (sq_counts_.find(signature) != sq_counts_.end()) {
-					int count = sq_counts_[signature];
-					if (count > max_count) {
-						max_count = count;
-						max_pp = pp;
-					}
-				}				
-			}
-			q_->remove(max_pp);
-			/*hdr_ip* h = hdr_ip::access(p);
-		       	FlowKey fkey;
-	       		fkey.src = h->saddr();
-       			fkey.dst = h->daddr();
-       			fkey.fid = h->flowid();
-       		
-		        char* fkey_buf = (char*) &fkey;
-	       		int length = sizeof(fkey);
-	       		string fkey_string(fkey_buf, length);
-			
-	       		std::tr1::hash<string> string_hasher;
-	       		size_t p_sig = string_hasher(fkey_string);
-	       		h = hdr_ip::access(max_pp);
-	       		fkey.src = h->saddr();
-	       		fkey.dst = h->daddr();
-	       		fkey.fid = h->flowid();
-			
-	       		string fkey_string2(fkey_buf, length);			
-	       		size_t maxpp_sig = string_hasher(fkey_string2);
-
-			 printf("%s, enqueued %d, dropped %d instead\n", this->name(), p_sig, maxpp_sig);*/
-			drop(max_pp);		      
 		} else {
 			drop(p);
 		}
@@ -201,96 +130,7 @@
         if (summarystats && &Scheduler::instance() != NULL) {
                 Queue::updateStats(qib_?q_->byteLength():q_->length());
         }
-	//printf("drop_smart_ = %d, sq_limit = %d \n", drop_smart_, sq_limit_);
-	
-	/*Shuang: deque the packet with the highest priority */
-	if (deque_prio_) {
-			q_->resetIterator();
-			Packet *p = q_->getNext();
-			int highest_prio_;
-			if (p != 0)
-				highest_prio_ = hdr_ip::access(p)->prio();
-			else
-				return 0;
-			for (Packet *pp = q_->getNext(); pp != 0; pp = q_->getNext()) {
-					hdr_ip* h = hdr_ip::access(pp);
-					int prio = h->prio();
-					//deque from the head
-					if (prio < highest_prio_) {
-						p = pp;
-						highest_prio_ = prio;
-				}
-			}
-			if (keep_order_) {
-				q_->resetIterator();
-				hdr_ip* hp = hdr_ip::access(p);
-				for (Packet *pp = q_->getNext(); pp != p; pp = q_->getNext()) {
-					hdr_ip* h = hdr_ip::access(pp);
-					if (h->saddr() == hp->saddr() 
-					&& h->daddr() == hp->daddr() 
-					&& h->flowid() == hp->flowid()) {
-						p = pp;
-						break;
-					}
-				}
-			}
-
-			//if (hdr_ip::access(p)->flowid() == 1) {
-		//		q_->resetIterator();
-		//		printf("DEQUE: flow %d queue_length %d\n", hdr_ip::access(p)->flowid(), q_->byteLength());
-		//		for (Packet *pp = q_->getNext(); pp != 0; pp = q_->getNext()) {
-		//			hdr_ip* h = hdr_ip::access(pp);
-		//			printf("( %d %d )", h->flowid(), h->prio());
-		//		}
-		//		printf("\n");
-		//		fflush(stdout);
-			//}
-
-			q_->remove(p);
-			return p;
-	} else
-	if (drop_smart_) {
-		Packet *p = q_->deque();
-		if (p) {
-			hdr_ip* h = hdr_ip::access(p);
-			FlowKey fkey;
-			fkey.src = h->saddr();
-			fkey.dst = h->daddr();
-			fkey.fid = h->flowid();
-			
-			char* fkey_buf = (char*) &fkey;
-			int length = sizeof(fkey);
-			string fkey_string(fkey_buf, length);
-			
-			std::tr1::hash<string> string_hasher;
-			size_t signature = string_hasher(fkey_string);			
-			sq_queue_.push(signature);
-						
-			if (sq_counts_.find(signature) != sq_counts_.end()) { 
-				sq_counts_[signature]++;
-				//printf("%s packet with signature %d, count = %d, qsize = %d\n", this->name(), signature, sq_counts_[signature], sq_queue_.size());				
-			}
-			else {
-				sq_counts_[signature] = 1;
-				//printf("%s first packet with signature %d, count = %d, qsize = %d\n", this->name(), signature, sq_counts_[signature], sq_queue_.size());
-			}
-
-       			if (sq_queue_.size() > sq_limit_) {
-		       		//printf("%s we are full %d %d\n", this->name(), sq_counts_.size(), sq_queue_.size());
-	       			size_t temp = sq_queue_.front();				                            	 sq_queue_.pop();
-				sq_counts_[temp]--;
-				if (sq_counts_[temp] == 0)
-					sq_counts_.erase(temp);
-				
-				//printf("%s removed front sig = %d, no longer full %d %d\n", this->name(), temp, sq_counts_.size(), sq_queue_.size());
-				
-			}
-		}
-		return p;
-		
-    	} else {
-		return q_->deque();
-	}
+	return q_->deque();
 }
 
 void DropTail::print_summarystats()
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/drop-tail.h ./ori-ns-allinone-2.34/ns-2.34/queue/drop-tail.h
--- ./ns-allinone-2.34/ns-2.34/queue/drop-tail.h	2017-02-12 11:43:22.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/drop-tail.h	2017-06-17 16:05:28.402179588 +0800
@@ -37,35 +37,10 @@
 #ifndef ns_drop_tail_h
 #define ns_drop_tail_h
 
-/*#ifdef __GNUC__
-#include <ext/hash_map>
-#else
-#include <hash_map>
-#endif
-
-
-namespace std
-{
- using namespace __gnu_cxx;
-}
-*/
-#include <tr1/unordered_map>
-#include <tr1/functional>
-#include <queue>
-
-using std::queue;
-using std::tr1::unordered_map;
-//using std::tr1::functional;
-
-#include <string>
+#include <string.h>
 #include "queue.h"
 #include "config.h"
 
-typedef struct flowkey {
-	nsaddr_t src, dst;
-	int fid;
-} FlowKey;
-
 /*
  * A bounded, drop-tail queue
  */
@@ -75,44 +50,27 @@
 		q_ = new PacketQueue; 
 		pq_ = q_;
 		bind_bool("drop_front_", &drop_front_);
-		bind_bool("drop_smart_", &drop_smart_);
-		bind_bool("drop_prio_", &drop_prio_);
-		bind_bool("deque_prio_", &deque_prio_);
-		bind_bool("keep_order_", &keep_order_);
 		bind_bool("summarystats_", &summarystats);
 		bind_bool("queue_in_bytes_", &qib_);  // boolean: q in bytes?
 		bind("mean_pktsize_", &mean_pktsize_);
-		bind("sq_limit_", &sq_limit_);
 		//		_RENAMED("drop-front_", "drop_front_");
 	}
 	~DropTail() {
 		delete q_;
 	}
+  protected:
 	void reset();
 	int command(int argc, const char*const* argv); 
 	void enque(Packet*);
 	Packet* deque();
-  //protected:
 	void shrink_queue();	// To shrink queue and drop excessive packets.
 
 	PacketQueue *q_;	/* underlying FIFO queue */
-	int drop_front_;	/* drop-from-front (rather than from tail) */	
+	int drop_front_;	/* drop-from-front (rather than from tail) */
 	int summarystats;
 	void print_summarystats();
 	int qib_;       	/* bool: queue measured in bytes? */
 	int mean_pktsize_;	/* configured mean packet size in bytes */
-	// Mohammad: for smart dropping
-	int drop_smart_;
-	// Shuang: for priority dropping
-	int drop_prio_;
-	int deque_prio_;
-	int keep_order_;
-
-
-	unsigned int sq_limit_;
-	unordered_map<size_t, int> sq_counts_;
-	std::queue<size_t> sq_queue_;
-
 };
 
 #endif
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/edf-queue.cc ./ori-ns-allinone-2.34/ns-2.34/queue/edf-queue.cc
--- ./ns-allinone-2.34/ns-2.34/queue/edf-queue.cc	2017-02-13 10:49:56.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/edf-queue.cc	1970-01-01 08:00:00.000000000 +0800
@@ -1,53 +0,0 @@
-/*************************************************************************
-    > File Name: edf-queue.cc
-    > Author: wtao
-    > Mail: tao.wang0221@gmail.com 
- ************************************************************************/
-
-#include "config.h"
-#include "queue.h"
-#include "flags.h"
-
-#include "edf-queue.h"
-
-static class EDFQueueClass : public TclClass {
-	public:
-		EDFQueueClass() : TclClass("Queue/EDFQueue") {}
-		TclObject* create(int, const char*const*) {
-			return (new EDFQueue);
-		}
-} class_edf_queue;
-
-void EDFQueue::reset()
-{
-	for (int i=0; i<NUM_QUEUE; i++) {
-		q_[i]->reset();
-	}
-}
-
-void EDFQueue::enque(Packet *p)
-{
-	// for (int i=0; i<NUM_QUEUE; i++)
-	//	printf("%d qlim_: %d\n", i, q_[i]->limit());
-	hdr_ip* iph = hdr_ip::access(p);
-	int t_prio = iph->prio_type();
-	// printf("t_prio: %d\n", t_prio);
-	if (t_prio == 0) {
-		q_[0]->enque(p);
-	}
-	else if (t_prio == 1) {
-		q_[1]->enque(p);
-	}
-	else {
-		assert();
-	}
-}
-
-Packet* EDFQueue::deque()
-{
-	for (int i=NUM_QUEUE-1; i>=0; i--) {
-		if (q_[i]->length() > 0)
-			return q_[i]->deque();
-	}
-	return NULL;
-}
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/edf-queue.h ./ori-ns-allinone-2.34/ns-2.34/queue/edf-queue.h
--- ./ns-allinone-2.34/ns-2.34/queue/edf-queue.h	2017-02-12 13:42:39.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/edf-queue.h	1970-01-01 08:00:00.000000000 +0800
@@ -1,86 +0,0 @@
-/*************************************************************************
-    > File Name: edf-queue.h
-    > Author: wtao
-    > Mail: tao.wang0221@gmail.com 
- ************************************************************************/
-
-#ifndef ns_edf_queue_h
-#define ns_edf_queue_h
-
-#include <queue>
-#include <tr1/functional>
-#include <tr1/unordered_map>
-
-using std::queue;
-using std::tr1::unordered_map;
-
-#include <string>
-#include "drop-tail.h"
-#include "config.h"
-
-#define NUM_QUEUE 2
-
-
-class EDFQueue : public Queue {
-	public:
-		EDFQueue() : drop_front_(0), drop_prio_(1), drop_smart_(0), deque_prio_(1), keep_order_(1), summarystats_(0), qib_(1), mean_pktsize_(1500) {
-			bind_bool("drop_front_", &drop_front_);
-			bind_bool("drop_smart_", &drop_smart_);
-			bind_bool("drop_prio_", &drop_prio_);
-			bind_bool("deque_prio_", &deque_prio_);
-			bind_bool("keep_order_", &keep_order_);
-			bind_bool("summarystats_", &summarystats_);
-			bind_bool("queue_in_bytes_", &qib_);  // boolean: q in bytes?
-			bind("mean_pktsize_", &mean_pktsize_);
-			bind("sq_limit_", &sq_limit_);
-
-			q_ = new DropTail *[NUM_QUEUE];
-			for (int i=0; i<NUM_QUEUE; i++) {
-				q_[i] = new DropTail;
-				q_[i]->drop_front_ = drop_front_;
-				q_[i]->drop_smart_ = drop_smart_;
-				q_[i]->drop_prio_ = drop_prio_;
-				q_[i]->deque_prio_ = deque_prio_;
-				q_[i]->keep_order_ = keep_order_;
-				q_[i]->summarystats = summarystats_;
-				q_[i]->qib_ = qib_;
-				q_[i]->mean_pktsize_ = mean_pktsize_;
-				q_[i]->sq_limit_ = sq_limit_;
-				// Tao: debug info
-				// printf("%d: mean_pkt_size %d", q_[i]->mean_pktsize_);
-				// printf(" %d %d %d\n", q_[i]->drop_prio_, q_[i]->keep_order_, q_[i]->qib_);
-				// printf("%d qlimt %d\n", i, q_[i]->limit());
-			}
-		}
-
-		~EDFQueue() {
-			for (int i=0; i<NUM_QUEUE; i++) {
-				delete q_[i];
-			}
-
-			delete[] q_;
-		}
-
-	protected:
-		void reset();
-		void enque(Packet *p);
-		Packet *deque();
-
-		DropTail **q_;
-
-		int drop_front_;	/* drop-from-front (rather than from tail) */	
-		int summarystats_;
-		int qib_;       	/* bool: queue measured in bytes? */
-		int mean_pktsize_;	/* configured mean packet size in bytes */
-		// Mohammad: for smart dropping
-		int drop_smart_;
-		// Shuang: for priority dropping
-		int drop_prio_;
-		int deque_prio_;
-		int keep_order_;
-
-
-		unsigned int sq_limit_;
-};
-
-#endif
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/prioqueue.cc ./ori-ns-allinone-2.34/ns-2.34/queue/prioqueue.cc
--- ./ns-allinone-2.34/ns-2.34/queue/prioqueue.cc	2017-02-22 21:39:14.844487925 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/prioqueue.cc	1970-01-01 08:00:00.000000000 +0800
@@ -1,176 +0,0 @@
-/*************************************************************************
-    > File Name: prioqueue.cc
-    > Author: wtao
-    > Mail: tao.wang0221@gmail.com 
- ************************************************************************/
-
-#include "config.h"
-#include "queue.h"
-#include "flags.h"
-
-
-#include "prioqueue.h"
-
-#define max(arg1, arg2) ((arg1>arg2)?(arg1):(arg2))
-#define min(arg1, arg2) ((arg1<arg2)?(arg1):(arg2))
-
-static class PriorityClass : public TclClass {
-	public:
-		PriorityClass() : TclClass("Queue/PriorityQueue") {}
-		TclObject *create(int, const char*const*) {
-			return (new PriorityQueue);
-		}
-} class_priority;
-
-int PriorityQueue::command(int argc, const char*const* argv)
-{
-	Tcl& tcl = Tcl::instance();
-	if (argc == 2) {
-		if (strcmp(argv[1], "printStats") == 0) {
-			if (!tchan_) {
-				tcl.resultf("No output file attached");
-				return (TCL_ERROR);
-			}
-			printStats();
-			return (TCL_OK);
-		}
-	}
-	else if (argc == 3) {
-		if (strcmp(argv[1], "attach") == 0) {
-			int mode;
-			const char* id = argv[2];
-			tchan_ = Tcl_GetChannel(tcl.interp(), (char*)id, &mode);
-			if (tchan_ == 0) {
-				tcl.resultf("PrioQueue: trace: can't attach %s for writing", id);
-				return (TCL_ERROR);
-			}
-			return (TCL_OK);
-		}
-	}
-	return (Queue::command(argc, argv));
-}
-
-
-void PriorityQueue::enque(Packet *p) {
-	hdr_ip *iph = hdr_ip::access(p);
-	hdr_flags *fh = hdr_flags::access(p);
-
-	int p_pktsize = hdr_cmn::access(p)->size();
-	int p_prio = iph->prio();
-	// printf("num_queue_ %d\n", num_queue_);
-	int act_n_queue_ = min(num_queue_, MAX_NUM_Q);
-	act_n_queue_ = max(act_n_queue_, 1);
-	// printf("act_n_queue_ %d\n", act_n_queue_);
-	int qlimbytes = qlim_ * mean_pktsize_;
-
-	if (TotalByteLength()+p_pktsize > qlimbytes) {
-		// printf("the dropped prio is %d\n", p_prio);
-		drop(p);
-		return ;
-	}
-	else {
-		if (p_prio >= act_n_queue_) {
-			p_prio = act_n_queue_-1;
-		}
-
-		// Tao: debug infos
-		// printf("queue_num %d the enqueue prio is %d\n", num_queue_, p_prio);
-
-		q_[p_prio]->enque(p);
-
-		if ((ecn_scheme_==PER_QUEUE_ECN && q_[p_prio]->byteLength()>ecn_thresh_*mean_pktsize_) || 
-				(ecn_scheme_==PER_PORT_ECN && TotalByteLength()>ecn_thresh_*mean_pktsize_)) {
-			if (fh->ect()) {
-				// if ecn enabled
-				fh->ce() = 1;
-			}
-		}
-
-		// update traced variables
-		que_perc_[p_prio] = (1.0*(double)q_[p_prio]->byteLength())/qlimbytes;
-		if (que_perc_[p_prio] > 1) {
-			que_perc_[p_prio] = 1;
-		}
-
-	}
-	
-}
-
-Packet *PriorityQueue::deque() {
-	// printf("queue limit size is %d, ecn_thresh_ is %d\n", qlim_, ecn_thresh_);
-	Packet *p = NULL;
-	// Tao
-	/*
-	printf("deque():\n");
-	for (int i=0; i<num_queue_; i++) {
-		printf("queue len %d\n", q_[i]->length());
-	}*/
-	// printf("num_queue_ %d\n", num_queue_);
-	if (TotalByteLength() > 0) {
-		for (int i=0; i<num_queue_; i++) {
-			// from high priority to low priority
-			if (q_[i]->length() > 0) {
-				p = q_[i]->deque();
-				// Tao
-				// printf("dequeue with prio %d\n", i);
-				// update traced variables
-				//
-				hdr_ip *iph = hdr_ip::access(p);
-				int p_prio = iph->prio();
-				int qlimbytes = qlim_ * mean_pktsize_;
-
-				que_perc_[p_prio] = (1.0*(double)q_[p_prio]->byteLength())/qlimbytes;
-				if (que_perc_[p_prio] < 0) {
-					que_perc_[p_prio] = 0;
-				}
-				// printf("q%d %d %d %f\n", p_prio, q_[p_prio]->length(), q_[p_prio]->byteLength(), que_perc_[p_prio]);
-				return (p);
-			}
-		}
-	}
-	else {
-		return NULL;
-	}
-}
-
-void PriorityQueue::printStats()
-{
-	double curtime;
-	Scheduler& s = Scheduler::instance();
-	char wrk[QUEUE_WRK_SIZE];
-
-	curtime = &s ? s.clock() : 0;
-	snprintf(wrk, QUEUE_WRK_SIZE,
-		 "time: %.8f q0: %f q1: %f q2: %f q3: %f q4: %f "
-		 "q5: %f q6: %f q7: %f\n", curtime, que_perc_[0], que_perc_[1],
-		 que_perc_[2], que_perc_[3], que_perc_[4], que_perc_[5],
-		 que_perc_[6], que_perc_[7]); 
-
-	(void)Tcl_Write(tchan_, wrk, -1);
-}
-
-
-void PriorityQueue::traceAll()
-{
-	if (!tchan_) {
-		return ;
-	}
-
-	double curtime;
-	Scheduler& s = Scheduler::instance();
-	char wrk[QUEUE_WRK_SIZE];
-
-	curtime = &s ? s.clock() : 0;
-	snprintf(wrk, QUEUE_WRK_SIZE,
-		 "time: %.8f q0: %f q1: %f q2: %f q3: %f q4: %f "
-		 "q5: %f q6: %f q7: %f\n", curtime, que_perc_[0], que_perc_[1],
-		 que_perc_[2], que_perc_[3], que_perc_[4], que_perc_[5],
-		 que_perc_[6], que_perc_[7]); 
-
-	(void)Tcl_Write(tchan_, wrk, -1);
-}
-
-void PriorityQueue::trace(TracedVar *)
-{
-	traceAll();
-}
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/prioqueue.h ./ori-ns-allinone-2.34/ns-2.34/queue/prioqueue.h
--- ./ns-allinone-2.34/ns-2.34/queue/prioqueue.h	2017-02-22 15:04:15.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/prioqueue.h	1970-01-01 08:00:00.000000000 +0800
@@ -1,100 +0,0 @@
-/*************************************************************************
-    > File Name: prioqueue.h
-    > Author: wtao
-    > Mail: tao.wang0221@gmail.com 
- ************************************************************************/
-
-#ifndef ns_priority_queue_h
-#define ns_priority_queue_h
-
-
-#include "config.h"
-#include "queue.h"
-#include "trace.h"
-
-
-#define MAX_NUM_Q 20
-// ECN scheme
-#define DISABLE_ECN 0
-#define PER_QUEUE_ECN 1
-#define PER_PORT_ECN 2
-// default value
-#define DFV_ECN_THRESH 65 // according to DCTCP
-#define DFV_MEAN_PKTSIZE 1460 
-#define DFV_NUM_QUEUE MAX_NUM_Q
-#define DFV_ECN_SCHEME DISABLE_ECN
-
-#define QUEUE_WRK_SIZE 1024
-
-
-class PriorityQueue : public Queue {
-	public:
-		PriorityQueue() : ecn_thresh_(DFV_ECN_SCHEME), mean_pktsize_(DFV_MEAN_PKTSIZE), num_queue_(DFV_NUM_QUEUE), ecn_scheme_(DFV_ECN_SCHEME), tr_time_(0) {
-			// bind variables
-			bind("ecn_thresh_", &ecn_thresh_);
-			bind("mean_pktsize_", &mean_pktsize_);
-			bind("num_queue_", &num_queue_);
-			bind("ecn_scheme_", &ecn_scheme_);
-			/*
-			bind("que_perc_0", &que_perc_[0]);
-			bind("que_perc_1", &que_perc_[1]);
-			bind("que_perc_2", &que_perc_[2]);
-			bind("que_perc_3", &que_perc_[3]);
-			bind("que_perc_4", &que_perc_[4]);
-			bind("que_perc_5", &que_perc_[5]);
-			bind("que_perc_6", &que_perc_[6]);
-			bind("que_perc_7", &que_perc_[7]);
-			*/
-
-			// initialize queue
-			q_ = new PacketQueue *[MAX_NUM_Q];
-			for (int i=0; i<MAX_NUM_Q; i++) {
-				q_[i] = new PacketQueue;
-
-				// Traced Value
-				que_perc_[i] = 0.0;
-			}
-		}
-
-		~PriorityQueue() {
-			// destroy queue
-			for (int i=0; i<MAX_NUM_Q; i++) {
-				delete q_[i];
-			}
-
-			delete[] q_;
-		}
-
-	protected:
-		// Tao: func enqueue() and dequeue()
-		void enque(Packet *p);
-		Packet *deque();
-		int command(int argc, const char*const* argv);
-		void trace(TracedVar*);
-		void traceAll();
-		void printStats();
-		void upStats();
-
-		// Tao: variables
-		PacketQueue **q_;			// underlying multi-level queue
-		int ecn_thresh_;			// single ECN threshold
-		int mean_pktsize_;			// configured mean packet size
-		int num_queue_;				// numbuer of FIFO queues
-		int ecn_scheme_;			// DISABLE_ECN (0) 
-									// PER_QUEUE_ECN (1)
-									// PER_PORT_ECN (2)
-		// Tao: for trace
-		double tr_time_;
-		Tcl_Channel tchan_;
-		double que_perc_[MAX_NUM_Q];
-		int TotalByteLength() {
-			int ret = 0;
-			for (int i=0; i<num_queue_; i++) {
-				ret += q_[i]->byteLength();
-			}
-			return ret;
-		}
-
-};
-
-#endif // ns_priority_queue_h
diff -uNr ./ns-allinone-2.34/ns-2.34/queue/red.cc ./ori-ns-allinone-2.34/ns-2.34/queue/red.cc
--- ./ns-allinone-2.34/ns-2.34/queue/red.cc	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/queue/red.cc	2017-06-17 16:05:28.402179588 +0800
@@ -560,7 +560,7 @@
 		edv_.count_bytes = 0;
 		hdr_flags* hf = hdr_flags::access(pickPacketForECN(pkt));
 		if (edp_.setbit && hf->ect() && 
-		    (!edp_.use_mark_p || edv_.v_prob1 <= edp_.mark_p)) { // Mohammad: I changed < to <= 
+                     (!edp_.use_mark_p || edv_.v_prob1 < edp_.mark_p)) { 
 			hf->ce() = 1; 	// mark Congestion Experienced bit
 			// Tell the queue monitor here - call emark(pkt)
 			return (0);	// no drop
diff -uNr ./ns-allinone-2.34/ns-2.34/tcl/lib/ns-autoconf.tcl ./ori-ns-allinone-2.34/ns-2.34/tcl/lib/ns-autoconf.tcl
--- ./ns-allinone-2.34/ns-2.34/tcl/lib/ns-autoconf.tcl	2017-02-22 17:05:34.910233160 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcl/lib/ns-autoconf.tcl	1970-01-01 08:00:00.000000000 +0800
@@ -1,50 +0,0 @@
-# -*-	Mode:tcl -*-
-#
-# Copyright (c) 1997 University of Southern California.
-# All rights reserved.                                            
-#                                                                
-# Redistribution and use in source and binary forms are permitted
-# provided that the above copyright notice and this paragraph are
-# duplicated in all such forms and that any documentation, advertising
-# materials, and other materials related to such distribution and use
-# acknowledge that the software was developed by the University of
-# Southern California, Information Sciences Institute.  The name of the
-# University may not be used to endorse or promote products derived from
-# this software without specific prior written permission.
-# 
-# THIS SOFTWARE IS PROVIDED "AS IS" AND WITHOUT ANY EXPRESS OR IMPLIED
-# WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
-# MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
-#
-#
-
-# This file should contain variables changed only by autoconf.
-
-proc checkout_executable {exe_var best alternate text} {
-	global $exe_var
-	set $exe_var $best
-	if {"$best" == "" || ![file executable $best]} {
-		puts stderr $text
-		set $exe_var $alternate
-	}
-}
-
-#
-# Keep track of where the good perl is.
-#
-checkout_executable PERL "/usr/bin/perl" perl "\
-	When configured, ns found the right version of perl in\
-	/usr/bin/perl
-	but it doesn't seem to be there anymore, so\
-	ns will fall back on running the first perl in your path.\
-	The wrong version of perl may break the test suites.\
-	Reconfigure and rebuild ns if this is a problem.\
-"
-checkout_executable TCLSH "/home/wtao/project-dct-build/ns-allinone-2.34/bin/tclsh8.4" tclsh "\
-	When configured, ns found the right version of tclsh in\
-	/home/wtao/project-dct-build/ns-allinone-2.34/bin/tclsh8.4
-	but it doesn't seem to be there anymore, so\
-	ns will fall back on running the first tclsh in your path.\
-	The wrong version of tclsh may break the test suites.\
-	Reconfigure and rebuild ns if this is a problem.\
-"
diff -uNr ./ns-allinone-2.34/ns-2.34/tcl/lib/ns-default.tcl ./ori-ns-allinone-2.34/ns-2.34/tcl/lib/ns-default.tcl
--- ./ns-allinone-2.34/ns-2.34/tcl/lib/ns-default.tcl	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcl/lib/ns-default.tcl	2017-06-17 16:05:28.510125579 +0800
@@ -103,17 +103,9 @@
 Queue/DropTail set summarystats_ false
 Queue/DropTail set queue_in_bytes_ false
 Queue/DropTail set mean_pktsize_ 500
-# Mohammad: Smart drop
-Queue/DropTail set drop_smart_ false
-Queue/DropTail set sq_limit_ 10
 
 Queue/DropTail/PriQueue set Prefer_Routing_Protocols    1
 
-# Shuang: Priority drop
-Queue/DropTail set drop_prio_ false
-Queue/DropTail set deque_prio_ false
-Queue/DropTail set keep_order_ false
-
 # special cmu implemented priority queue used by DSR
 CMUPriQueue set qlen_logthresh_ 10
 CMUPriQueue set fw_logthresh_ 25
@@ -127,24 +119,6 @@
 # support only xcp flows; set to 1 when supporting both tcp and xcp flows; temporary fix for allocating link BW between xcp and tcp queues until dynamic queue weights come into effect. This fix should then go away
 Queue/XCP set tcp_xcp_on_ 0  ;
 
-# Drop Tail Variant
-# Queue/DropTailVariant set drop_front_ false
-# Queue/DropTailVariant set summarystats_ false
-# Queue/DropTailVariant set queue_in_bytes_ false
-# Queue/DropTailVariant set mean_pktsize_ 500
-# Queue/DropTailVariant set tcp_queue_limit_pkts_ 1000
-
-# Queue/DropTailVariant/RCP set alpha_ 0.4
-# Queue/DropTailVariant/RCP set beta_ 0.4
-# Queue/DropTailVariant/RCP set gamma_ 1
-# Queue/DropTailVariant/RCP set min_pprtt_ 0.01
-# Queue/DropTailVariant/RCP set init_rate_fact_ 0.05
-# Queue/DropTailVariant/RCP set print_status_ 1
-# Queue/DropTailVariant/RCP set rate_fact_mode_ 0
-# Queue/DropTailVariant/RCP set fixed_rate_fact_ 0.05 ;# effecitve only if rate_fact_mode = 1
-# Queue/DropTailVariant/RCP set propag_rtt_ 1.0  ;# effecitve only if rate_fact_mode = 3
-# Queue/DropTailVariant/RCP set upd_timeslot_ 0.01  ;# rate update interval (sec).
-
 Queue/RED set bytes_ true ;		# default changed on 10/11/2004.
 Queue/RED set queue_in_bytes_ true ;	# default changed on 10/11/2004.
 # Queue/RED set thresh_ 5
@@ -194,15 +168,6 @@
 ###   for automatic configuration.
 Queue/RED set cautious_ 0
 Queue/RED set feng_adaptive_ 0
-# Mohammad: Phantom Queue extensions
-Queue/RED set pq_enable_ 0
-Queue/RED set pq_mode_ 0
-Queue/RED set pq_drainrate_ 0 ; # need to set this when PQ is enabled
-                                # always in bps
-Queue/RED set pq_thresh_ 0
-# Shuang: priority dropping/deque extensions
-Queue/RED set drop_prio_ 0
-Queue/RED set deque_prio_ 0
 
 Queue/RED/RIO set bytes_ false
 Queue/RED/RIO set queue_in_bytes_ false
@@ -270,9 +235,6 @@
 Queue/Vq set curq_ 0
 Queue/Vq set drop_front_ 0
 Queue/Vq set markfront_ 0
-# Mohammad
-Queue/Vq set ctilde_ 0
-Queue/Vq set vq_len_ 0
 
 Queue/REM set gamma_ 0.001
 Queue/REM set phi_ 1.001
@@ -336,20 +298,6 @@
 QueueMonitor set pmarks_ 0
 QueueMonitor set bdrops_ 0
 
-#added for count dropping from small flow - Shuang
-QueueMonitor set num_monitor_ 50
-for {set k 0} {$k < 50} {incr k} {
-    set tmp kdrops$k
-	QueueMonitor set $tmp 0
-	set tmp karrivals$k
-	QueueMonitor set $tmp 0
-}
-
-QueueMonitor set ack_arrivals_ 0
-QueueMonitor set ack_drops_ 0
-QueueMonitor set ack_departures_ 0
-
-
 QueueMonitor set qs_pkts_ 0
 QueueMonitor set qs_bytes_ 0
 QueueMonitor set qs_drops_ 0
@@ -412,7 +360,8 @@
 DelayLink set delay_ 100ms
 DelayLink set debug_ false
 DelayLink set avoidReordering_ false ;	# Added 3/27/2003.
-					# Set to true to avoid reordering when				
+					# Set to true to avoid reordering when
+					#   changing link bandwidth or delay.
 DynamicLink set status_ 1
 DynamicLink set debug_ false
 
@@ -440,11 +389,6 @@
 Classifier/Addr/MPLS set control_driven_ 0
 Classifier/Addr/MPLS set data_driven_ 0
 
-# Mohammad
-Classifier/MultiPath set nodeid_ 0
-Classifier/MultiPath set nodetype_ 0
-Classifier/MultiPath set perflow_ 0
-Classifier/MultiPath set checkpathid_ 0
 #
 # FEC models
 #
@@ -690,16 +634,7 @@
 TBF set rate_ 64k
 TBF set bucket_ 1024
 TBF set qlen_ 0
-# Mohammad: Pacer variables
-TBF set pacer_enable_ 0
-TBF set assoc_timeout_ 0.01
-TBF set assoc_prob_ 0.125
-TBF set maxrate_ 1000000000
-TBF set minrate_ 10000000
-TBF set qlength_factor_ 122;
-TBF set rate_ave_factor_ 0.125
-TBF set rate_update_interval_  0.000064
-TBF set debug_ 0
+
 #
 # mobile Ip
 #
@@ -1087,18 +1022,6 @@
 
 Agent/TCP set SetCWRonRetransmit_ true ; # added on 2005/06/19.
 				 	 # default changed on 2008/06/05. 
-# Mohammad
-Agent/TCP set ecnhat_ false;
-Agent/TCP set ecnhat_smooth_alpha_ true;
-Agent/TCP set ecnhat_alpha_ 0.0;
-Agent/TCP set ecnhat_g_ 0.125;
-Agent/TCP set ecnhat_enable_beta_ false;
-Agent/TCP set ecnhat_beta_ 0.0;
-Agent/TCP set ecnhat_quadratic_beta_ false;
-Agent/TCP set ecnhat_tcp_friendly_ false;
-Agent/TCP set perPacketMP_ false;
-Agent/TCP set pathAwareMP_ false;
-Agent/TCP set num_paths_ 1
 
 # XXX Generate nam trace or plain old text trace for variables. 
 # When it's true, generate nam trace.
@@ -1134,7 +1057,6 @@
 Agent/TCPSink set RFC2581_immediate_ack_ true
 Agent/TCPSink set bytes_ 0
 Agent/TCPSink set ecn_syn_ false ;	# Added 2005/11/21 for SYN/ACK pkts.
-Agent/TCPSink set ecnhat_ false;
 
 Agent/TCPSink/DelAck set interval_ 100ms
 catch {
@@ -1307,20 +1229,6 @@
         Agent/TCP/FullTcp set ecn_syn_ false; # Make SYN/ACK packet ECN-Capable?
         Agent/TCP/FullTcp set ecn_syn_wait_ 0; # Wait after marked SYN/ACK? 
         Agent/TCP/FullTcp set debug_ false;  # Added Sept. 16, 2007.
-	Agent/TCP/FullTcp set flow_remaining_ -1; #Mohammad: added for robust FCT measurement
-	Agent/TCP/FullTcp set dynamic_dupack_ 0; # Mohammad: if non-zero, set dupack threshold to max(3, dynamic_dupack_ * cwnd_)
-	Agent/TCP/FullTcp set prio_scheme_ 2; #Shuang: priority scheme
-	Agent/TCP/FullTcp set prio_num_ 0; #Shuang: number of priority
-	Agent/TCP/FullTcp set prio_cap0 6*1460+15;
-	Agent/TCP/FullTcp set prio_cap1 16*1460+15;
-	Agent/TCP/FullTcp set prio_cap2 30*1460+15;
-	Agent/TCP/FullTcp set prio_cap3 49*1460+15;
-	Agent/TCP/FullTcp set prio_cap4 266*1460+15;
-	Agent/TCP/FullTcp set prio_cap5 1001*1460+15;
-	Agent/TCP/FullTcp set prio_cap6 2825*1460+15;
-	Agent/TCP/FullTcp set prob_cap_ 0; #Shuang: prob mode
-	Agent/TCP/FullTcp set deadline 0; #Shuang: deadline
-	Agent/TCP/FullTcp set early_terminated_ 0; #Shuang
 
 	Agent/TCP/FullTcp/Newreno set recov_maxburst_ 2; # max burst dur recov
 
@@ -1351,14 +1259,6 @@
 		set open_cwnd_on_pack_ false
 	}
 
-	Agent/TCP/FullTcp/Sack/MinTCP instproc init {} {
-		$self next
-	}
-
-	Agent/TCP/FullTcp/Sack/DDTCP instproc init {} {
-		$self next
-	}
-
 }
 
 if [TclObject is-class Agent/TCP/BayFullTcp] {
@@ -1551,24 +1451,6 @@
 
 Delayer set debug_ false
 
-# # Nandita: Following is for Video traffic. Taken from Xiaoqing Zhu
-# Application/Traffic/VideoCBR set rate_ 0
-# Application/Traffic/VideoCBR set pktsize_ 1500
-# Application/Traffic/VideoCBR set fps_ 30
-# Application/Traffic/VideoCBR set gop_ 15
-# Application/Traffic/VideoCBR set fix_interval_ 0
-# Application/Traffic/VideoCBR set init_delay_ 0.5
-# Application/Traffic/VideoCBR set debug_ 0
-# Application/Traffic/VideoCBR set random_ 0
-
-# Application/Traffic/VideoTrace set init_delay_ 0.5
-# Application/Traffic/VideoTrace set quality_ 0
-# Application/Traffic/VideoTrace set fps_ 30
-# Application/Traffic/VideoTrace set advance_per_gop_ 1
-# Application/Traffic/VideoTrace set debug_ 0
-# Application/Traffic/VideoTrace set random_ 0
-# Application/Traffic/VideoTrace set loop_ 0
-
 Agent/TCP/Linux set rtxcur_init_ 3
 Agent/TCP/Linux set maxrto_ 120
 Agent/TCP/Linux set minrto_ 0.2
diff -uNr ./ns-allinone-2.34/ns-2.34/tcl/lib/ns-node.tcl ./ori-ns-allinone-2.34/ns-2.34/tcl/lib/ns-node.tcl
--- ./ns-allinone-2.34/ns-2.34/tcl/lib/ns-node.tcl	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcl/lib/ns-node.tcl	2017-06-17 16:05:28.510125579 +0800
@@ -88,9 +88,9 @@
 	set nodetype_ [$ns_ get-nodetype]
 
 	$self mk-default-classifier
+
 	# XXX Eventually these two should also be converted to modules
 	set multiPath_ [$class set multiPath_]
-
 }
 
 # XXX This instproc is backward compatibility; when satellite node, mobile
@@ -350,21 +350,8 @@
 			# 1. get new MultiPathClassifier,
 			# 2. migrate existing routes to that mclassifier
 			# 3. install the mclassifier in the node classifier_
-			#			
+			#
 			set mpathClsfr_($id) [new Classifier/MultiPath]
-			$mpathClsfr_($id) set nodeid_ [$self id]
-			set nodecolor_ [$self get-attribute "COLOR"]
-			set nodetype_ 0
-			if {$nodecolor_ == "green"} {
-				set nodetype_ 1
-			}
-			if {$nodecolor_ == "blue"} {
-				set nodetype_ 2
-			}
-			if {$nodecolor_ == "red"} {
-				set nodetype_ 3
-			}
-			$mpathClsfr_($id) set nodetype_ $nodetype_
 			if {$routes_($id) > 0} {
 				assert "$routes_($id) == 1"
 				$mpathClsfr_($id) installNext \
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp.cc ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp.cc
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp.cc	2017-04-19 17:30:50.262993175 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp.cc	2017-06-17 16:05:28.402179588 +0800
@@ -1,3 +1,36 @@
+/* -*-	Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t -*- */
+/*
+ * Copyright (c) 1991-1997 Regents of the University of California.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the Computer Systems
+ *	Engineering Group at Lawrence Berkeley Laboratory.
+ * 4. Neither the name of the University nor of the Laboratory may be used
+ *    to endorse or promote products derived from this software without
+ *    specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ */
 
 #ifndef lint
 static const char rcsid[] =
@@ -14,10 +47,6 @@
 #include "basetrace.h"
 #include "hdr_qs.h"
 
-
-#define max(a,b) (((a)>(b))?(a):(b))
-#define min(a,b) (((a)>(b))?(b):(a))
-
 int hdr_tcp::offset_;
 
 static class TCPHeaderClass : public PacketHeaderClass {
@@ -47,8 +76,7 @@
 	  first_decrease_(1), fcnt_(0), nrexmit_(0), restart_bugfix_(1), 
           cong_action_(0), ecn_burst_(0), ecn_backoff_(0), ect_(0), 
           use_rtt_(0), qs_requested_(0), qs_approved_(0),
-	  qs_window_(0), qs_cwnd_(0), frto_(0), ecnhat_recalc_seq(0), ecnhat_num_marked(0),ecnhat_total(0),
-	  ecnhat_maxseq(0), ecnhat_not_marked(0), ecnhat_mark_period(0), target_wnd(0) , ecnhat_tcp_friendly_increase_(1.0), prio_enable_(0), pias_enable_(0), karuna_enable_(0), kar_seg_size_(1460),last_win_frac_(0), llast_win_frac_(0), last_win_size_(0), llast_win_size_(0), last_zeta_(0), last_win_rtt_(0), last_update_time(0), last_time_len(0), lrtt_total(0), lrtt_marked(0), early_detect_(0), num_queue_(0), l2dct_enable_(0), l2dct_w_min_(0.125), l2dct_w_max_(2.5), l2dct_size_min_(200*1024), l2dct_size_max_(1024*1024)
+	  qs_window_(0), qs_cwnd_(0), frto_(0)
 {
 #ifdef TCP_DELAY_BIND_ALL
         // defined since Dec 1999.
@@ -73,40 +101,6 @@
         bind("necnresponses_", &necnresponses_);
         bind("ncwndcuts_", &ncwndcuts_);
 	bind("ncwndcuts1_", &ncwndcuts1_);
-	// Mohammad
-	bind("ecnhat_", &ecnhat_);
-	bind("ecnhat_smooth_alpha_", &ecnhat_smooth_alpha_);  
-	bind("ecnhat_alpha_", &ecnhat_alpha_);
-	bind("ecnhat_g_", &ecnhat_g_);
-	bind("ecnhat_enable_beta_", &ecnhat_enable_beta_);
-	bind("ecnhat_beta_", &ecnhat_beta_);
-	bind("ecnhat_quadratic_beta_", &ecnhat_quadratic_beta_);
-	bind("ecnhat_tcp_friendly_", &ecnhat_tcp_friendly_);
-
-	// support to l2dct
-	bind("l2dct_enable_", &l2dct_enable_);
-	bind("l2dct_w_min_", &l2dct_w_min_);
-	bind("l2dct_w_max_", &l2dct_w_max_);
-	bind("l2dct_size_min_", &l2dct_size_min_);
-	bind("l2dct_size_max_", &l2dct_size_max_);
-
-	// Tao
-	bind("deadline", &deadline);	
-	bind("prio_enable_", &prio_enable);
-	bind("pias_enable_", &pias_enable);
-	bind("karuna_enable_", &karuna_enable_);
-	bind("kar_seg_size_", &kar_seg_size_);
-	bind("host_link_rate_", &host_link_rate_);
-	bind("k_thresh_", &k_thresh_);
-	bind("early_detect_", &early_detect_);
-	bind("num_queue_", &num_queue_);
-	bind("queue_thresh0", &queue_thresh_[0]);
-	bind("queue_thresh1", &queue_thresh_[1]);
-	bind("queue_thresh2", &queue_thresh_[2]);
-	bind("queue_thresh3", &queue_thresh_[3]);
-	bind("queue_thresh4", &queue_thresh_[4]);
-	bind("queue_thresh5", &queue_thresh_[5]);
-	bind("queue_thresh6", &queue_thresh_[6]);
 #endif /* TCP_DELAY_BIND_ALL */
 
 }
@@ -129,41 +123,6 @@
         delay_bind_init_one("overhead_");
         delay_bind_init_one("tcpTick_");
         delay_bind_init_one("ecn_");
-	// Mohammad
-	delay_bind_init_one("ecnhat_"); 
-	delay_bind_init_one("ecnhat_smooth_alpha_"); 
-	delay_bind_init_one("ecnhat_alpha_");
-	delay_bind_init_one("ecnhat_g_");
-	delay_bind_init_one("ecnhat_beta_");
-	delay_bind_init_one("ecnhat_enable_beta_");
-	delay_bind_init_one("ecnhat_quadratic_beta_");
-	delay_bind_init_one("ecnhat_tcp_friendly_");
-
-		// support to l2dct
-		delay_bind_init_one("l2dct_enable_");
-		delay_bind_init_one("l2dct_w_min_");
-		delay_bind_init_one("l2dct_w_max_");
-		delay_bind_init_one("l2dct_size_min_");
-		delay_bind_init_one("l2dct_size_max_");
-
-		// Tao
-		delay_bind_init_one("deadline");
-		delay_bind_init_one("prio_enable_");
-		delay_bind_init_one("pias_enable_");
-		delay_bind_init_one("karuna_enable_");
-		delay_bind_init_one("kar_seg_size_");
-		delay_bind_init_one("host_link_rate_");
-		delay_bind_init_one("k_thresh_");
-		delay_bind_init_one("early_detect_");
-		delay_bind_init_one("num_queue_");
-		delay_bind_init_one("queue_thresh0");
-		delay_bind_init_one("queue_thresh1");
-		delay_bind_init_one("queue_thresh2");
-		delay_bind_init_one("queue_thresh3");
-		delay_bind_init_one("queue_thresh4");
-		delay_bind_init_one("queue_thresh5");
-		delay_bind_init_one("queue_thresh6");
-
         delay_bind_init_one("SetCWRonRetransmit_");
         delay_bind_init_one("old_ecn_");
         delay_bind_init_one("bugfix_ss_");
@@ -275,44 +234,7 @@
         if (delay_bind(varName, localName, "overhead_", &overhead_, tracer)) return TCL_OK;
         if (delay_bind(varName, localName, "tcpTick_", &tcp_tick_, tracer)) return TCL_OK;
         if (delay_bind_bool(varName, localName, "ecn_", &ecn_, tracer)) return TCL_OK;
-	// Mohammad
-        if (delay_bind_bool(varName, localName, "ecnhat_", &ecnhat_, tracer)) return TCL_OK; 
-        if (delay_bind_bool(varName, localName, "ecnhat_smooth_alpha_", &ecnhat_smooth_alpha_, tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "ecnhat_alpha_", &ecnhat_alpha_ , tracer)) return TCL_OK;
-        if (delay_bind(varName, localName, "ecnhat_g_", &ecnhat_g_ , tracer)) return TCL_OK;
-	if (delay_bind_bool(varName, localName, "ecnhat_enable_beta_", &ecnhat_enable_beta_ , tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "ecnhat_beta_", &ecnhat_beta_ , tracer)) return TCL_OK;
-	if (delay_bind_bool(varName, localName, "ecnhat_quadratic_beta_", &ecnhat_quadratic_beta_ , tracer)) return TCL_OK;
-	if (delay_bind_bool(varName, localName, "ecnhat_tcp_friendly_", &ecnhat_tcp_friendly_, tracer)) return TCL_OK; 
-
-	// support to l2dct
-        if (delay_bind(varName, localName, "l2dct_enable_", &l2dct_enable_, tracer)) return TCL_OK;
-        if (delay_bind(varName, localName, "l2dct_w_min_", &l2dct_w_min_, tracer)) return TCL_OK;
-        if (delay_bind(varName, localName, "l2dct_w_max_", &l2dct_w_max_, tracer)) return TCL_OK;
-        if (delay_bind(varName, localName, "l2dct_size_min_", &l2dct_size_min_, tracer)) return TCL_OK;
-        if (delay_bind(varName, localName, "l2dct_size_max_", &l2dct_size_max_, tracer)) return TCL_OK;
-	
-
-	// Tao
-	if (delay_bind(varName, localName, "deadline", &deadline, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "prio_enable_", &prio_enable_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "pias_enable_", &pias_enable_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "karuna_enable_", &karuna_enable_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "kar_seg_size_", &kar_seg_size_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "host_link_rate_", &host_link_rate_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "k_thresh_", &k_thresh_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "early_detect_", &early_detect_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "num_queue_", &num_queue_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh0", &queue_thresh_[0], tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh1", &queue_thresh_[1], tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh2", &queue_thresh_[2], tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh3", &queue_thresh_[3], tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh4", &queue_thresh_[4], tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh5", &queue_thresh_[5], tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "queue_thresh6", &queue_thresh_[6], tracer)) return TCL_OK;
-
-
-	if (delay_bind_bool(varName, localName, "SetCWRonRetransmit_", &SetCWRonRetransmit_, tracer)) return TCL_OK;
+        if (delay_bind_bool(varName, localName, "SetCWRonRetransmit_", &SetCWRonRetransmit_, tracer)) return TCL_OK;
         if (delay_bind_bool(varName, localName, "old_ecn_", &old_ecn_ , tracer)) return TCL_OK;
         if (delay_bind_bool(varName, localName, "bugfix_ss_", &bugfix_ss_ , tracer)) return TCL_OK;
         if (delay_bind(varName, localName, "eln_", &eln_ , tracer)) return TCL_OK;
@@ -590,7 +512,6 @@
 			reset_qoption();
 		}
 	}
-
 }
 
 /*
@@ -625,12 +546,10 @@
 	if (timeout > maxrto_)
 		timeout = maxrto_;
 
-    if (timeout < 2.0 * tcp_tick_) {
+        if (timeout < 2.0 * tcp_tick_) {
 		if (timeout < 0) {
 			fprintf(stderr, "TcpAgent: negative RTO!  (%f)\n",
 				timeout);
-			fflush(stdout);
-			fflush(stderr);
 			exit(1);
 		} else if (use_rtt_ && timeout < tcp_tick_)
 			timeout = tcp_tick_;
@@ -646,7 +565,6 @@
 void TcpAgent::rtt_update(double tao)
 {
 	double now = Scheduler::instance().clock();
-	//printf("%f\n", tao);
 	if (ts_option_)
 		t_rtt_ = int(tao /tcp_tick_ + 0.5);
 	else {
@@ -687,15 +605,12 @@
 	t_rtxcur_ = (((t_rttvar_ << (rttvar_exp_ + (T_SRTT_BITS - T_RTTVAR_BITS))) +
 		t_srtt_)  >> T_SRTT_BITS ) * tcp_tick_;
 
-	//
-	// printf("updated srtt %d %d %f %d\n", (int)t_rtt_, (int)t_srtt_, tcp_tick_, T_SRTT_BITS);
 	return;
 }
 
 void TcpAgent::rtt_backoff()
 {
-	//if (t_backoff_ < 64 || rfc2988_)
-	if (t_backoff_ < 64 || (rfc2988_ && rtt_timeout() < maxrto_))
+	if (t_backoff_ < 64 || rfc2988_)
         	t_backoff_ <<= 1;
         // RFC2988 allows a maximum for the backed-off RTO of 60 seconds.
         // This is applied by maxrto_.
@@ -750,17 +665,14 @@
 	// (A real TCP would use scoreboard for this.)
         if (bugfix_ts_ && tss==NULL) {
                 tss = (double*) calloc(tss_size_, sizeof(double));
-                if (tss==NULL) {
-					fflush(stdout);
-					exit(1);
-					}
+                if (tss==NULL) exit(1);
         }
         //dynamically grow the timestamp array if it's getting full
         if (bugfix_ts_ && ((seqno - highest_ack_) > tss_size_* 0.9)) {
                 double *ntss;
                 ntss = (double*) calloc(tss_size_*2, sizeof(double));
                 printf("%p resizing timestamp table\n", this);
-                if (ntss == NULL) { fflush(stdout); exit(1);}
+                if (ntss == NULL) exit(1);
                 for (int i=0; i<tss_size_; i++)
                         ntss[(highest_ack_ + i) % (tss_size_ * 2)] =
                                 tss[(highest_ack_ + i) % tss_size_];
@@ -922,10 +834,6 @@
 			et_ = (EventTrace *)TclObject::lookup(argv[2]);
 			return (TCL_OK);
 		}
-		if (strcmp(argv[1], "setdeadline") == 0) {
-			setdeadline(atoi(argv[2]));
-			return (TCL_OK);
-		}
 		/*
 		 * Curtis Villamizar's trick to transfer tcp connection
 		 * parameters to emulate http persistent connections.
@@ -1208,48 +1116,16 @@
  */
 void TcpAgent::opencwnd()
 {
-	// printf("wnd_option: %d\n", wnd_option_);
-	// printf("1\n");
-	if (karuna_enable_ && deadline>0) {
-		cwnd_ = karuna_cal_cwnd_;
-	}
-	else {
 	double increment;
 	if (cwnd_ < ssthresh_) {
 		/* slow-start (exponential) */
-		if (ecnhat_enable_beta_)
-			cwnd_ += ecnhat_beta_ / cwnd_;
-		else{
-			//cwnd_ += increase_num_ / cwnd_;
-			cwnd_ += 1;
-	       	}
-
+		cwnd_ += 1;
 	} else {
 		/* linear */
 		double f;
-	
-		if (l2dct_enable_) {
-			if (ndatabytes_ <= l2dct_size_min_)
-				l2dct_w_c_ = l2dct_w_max_;
-			else if (ndatabytes_ >= l2dct_size_max_)
-				l2dct_w_c_ = l2dct_w_min_;
-			else
-				l2dct_w_c_ = l2dct_w_max_ - (ndatabytes_-l2dct_size_min_)*(l2dct_w_max_-l2dct_w_min_)/(l2dct_size_max_-l2dct_size_min_);
-
-			increase_num_ = l2dct_w_c_/l2dct_w_max_;
-		}
-
-		// Tao: here we may add something about ddl-aware congestion control
-
 		switch (wnd_option_) {
 		case 0:
-			// support to l2dct
-			if (l2dct_enable_ && ++count_*l2dct_w_c_/l2dct_w_max_>=cwnd_) {
-				count_ = 0;
-				++cwnd_;
-			}
-			// congestion avoidance, cwnd = cwnd+1/cwnd
-			else if (++count_ >= cwnd_) {
+			if (++count_ >= cwnd_) {
 				count_ = 0;
 				++cwnd_;
 			}
@@ -1257,30 +1133,14 @@
 
 		case 1:
 			/* This is the standard algorithm. */
-			if (ecnhat_enable_beta_)
-				increment = ecnhat_beta_ / cwnd_;
-			else if (ecnhat_tcp_friendly_) {
-				ecnhat_tcp_friendly_increase_ = ((int(t_srtt_) >> T_SRTT_BITS)*tcp_tick_ / 0.0004);// * ((int(t_srtt_) >> T_SRTT_BITS)*tcp_tick_ / 0.0004);
-				//printf("increase_factor = %f, s_rtt = %f\n",  ecnhat_tcp_friendly_increase_, (int(t_srtt_) >> T_SRTT_BITS)*tcp_tick_);				
-				increment = ecnhat_tcp_friendly_increase_ / cwnd_;
-				//increment = increase_num_ / cwnd_;
-			}
-			else
-				increment = increase_num_ / cwnd_;
-
+			increment = increase_num_ / cwnd_;
 			if ((last_cwnd_action_ == 0 ||
 			  last_cwnd_action_ == CWND_ACTION_TIMEOUT) 
 			  && max_ssthresh_ > 0) {
 				increment = limited_slow_start(cwnd_,
 				  max_ssthresh_, increment);
 			}
-			//printf("%f: target = %f cwnd = %f\n", Scheduler::instance().clock(), target_wnd, (double) cwnd_);
-			/*if (1) {
-				target_wnd += increment;
-				cwnd_ += (target_wnd - cwnd_)/2.0/cwnd_;
-				} else*/
 			cwnd_ += increment;
-			
 			break;
 
 		case 2:
@@ -1368,9 +1228,6 @@
 			abort();
 		}
 	}
-	}
-
-
 	// if maxcwnd_ is set (nonzero), make it the cwnd limit
 	if (maxcwnd_ && (int(cwnd_) > maxcwnd_))
 		cwnd_ = maxcwnd_;
@@ -1381,14 +1238,6 @@
 void
 TcpAgent::slowdown(int how)
 {
-	if (karuna_enable_ && deadline>0) {
-		cwnd_ = karuna_cal_cwnd_;
-	}
-	else {
-	// printf("wnd_optin in slowdown(): %d\n", wnd_option_);
-	int ddl_passed = 0;
-	// Tao: for karuna
-
 	double decrease;  /* added for highspeed - sylvia */
 	double win, halfwin, decreasewin;
 	int slowstart = 0;
@@ -1396,67 +1245,9 @@
 	if (!(how & TCP_IDLE) && !(how & NO_OUTSTANDING_DATA)){
 		++ncwndcuts1_; 
 	}
-
-	// support to l2dct
-	double b = ecnhat_alpha_;
-	if (l2dct_enable_) {
-		if (ndatabytes_ <= l2dct_size_min_)
-			l2dct_w_c_ = l2dct_w_max_;
-		else if (ndatabytes_ >= l2dct_size_max_)
-			l2dct_w_c_ = l2dct_w_min_;
-		else
-			l2dct_w_c_ = l2dct_w_max_ - (ndatabytes_-l2dct_size_min_)*(l2dct_w_max_-l2dct_w_min_)/(l2dct_size_max_-l2dct_size_min_);
-
-		// update b
-		b = pow(b, l2dct_w_c_);
-	}
-
-	// Tao: here we may add something about ddl-aware congestion control
-	// debug info
-	/*
-	if (early_detect_ == 0) {
-		printf("early_detect_ not configured\n");
-	}
-	else if (early_detect_ == 1) {
-		printf("early_detect_ configured\n");
-	}*/
-#if 1
-	ddl_passed = 0;
-	if (prio_enable_ && num_queue_>=2) {
-		if (deadline > 0) { // for deadline flows
-			double tsnd = 1e6*(Scheduler::instance().clock()-start_time);
-			double tleft = 1.0*deadline-tsnd;
-			double tmp_rtt = (t_srtt_ >> T_SRTT_BITS)*tcp_tick_; // in us
-			// Tao: debug infos
-			// printf("calculated tleft is %f\n", tleft);
-			if (tleft<=0 || tleft<tmp_rtt*1e6)
-				ddl_passed = 1;
-			else {
-				double tmp = tsnd/(tleft+1);
-				// printf("tmp is %f\n", tmp);
-#if 1
-				if (tmp >= 5)
-					ddl_passed = 1;
-				if (tmp <= 0.5)
-					tmp = 0.5;
-				if (tmp >= 1.5)
-					tmp = 1.5;
-#endif
-				b = pow(b, tmp);
-			}
-		}
-		else { // for non-deadline flows
-			// b = b;
-		}
-	}
-#endif
-
-	//ecnhat_alpha_ = 0.07;
 	// we are in slowstart for sure if cwnd < ssthresh
 	if (cwnd_ < ssthresh_) 
 		slowstart = 1;
-	// printf("%d\n", precision_reduce_);
-	// printf("dec_n: %f\n", decrease_num_);
         if (precision_reduce_) {
 		halfwin = windowd() / 2;
                 if (wnd_option_ == 6) {         
@@ -1473,7 +1264,6 @@
 	 		decreasewin = decrease_num_ * windowd();
 		}
 		win = windowd();
-		//printf("decrease param = %f window = %f decwin = %f\n", decrease_num_, win, decreasewin);
 	} else  {
 		int temp;
 		temp = (int)(window() / 2);
@@ -1505,12 +1295,7 @@
 		} else {
 			ssthresh_ = (int) decreasewin;
 		}
-	else if (how & CLOSE_SSTHRESH_ECNHAT) {
-		ssthresh_ = (int) ((1 - b/2.0) * windowd());
-		// ssthresh_ = (int) ((1 - ecnhat_alpha_/2.0) * windowd());
-		//ssthresh_ = (int) (windowd() - sqrt(2*windowd())/2.0);
-	}
-    else if (how & THREE_QUARTER_SSTHRESH)
+        else if (how & THREE_QUARTER_SSTHRESH)
 		if (ssthresh_ < 3*cwnd_/4)
 			ssthresh_  = (int)(3*cwnd_/4);
 	if (how & CLOSE_CWND_HALF)
@@ -1519,22 +1304,7 @@
 		if (first_decrease_ == 1 || slowstart || decrease_num_ == 0.5) {
 			cwnd_ = halfwin;
 		} else cwnd_ = decreasewin;
-		else if (how & CLOSE_CWND_ECNHAT) {
-			// Tao: if not set, xxx
-			cwnd_ = (1-b/2.0) *windowd();
-			if (cwnd_ < 1) {
-				cwnd_ = 1;
-			}
-			// Tao: deadline passed
-			if (prio_enable_ && ddl_passed && early_detect_) {
-				// Tao: debug infos
-				// printf("if the deadline just passed, we set the cwnd to 1\n");
-				cwnd_ = 1;
-			}
-		}
-	//cwnd_ = (1 - ecnhat_alpha_/2.0) * windowd();
-	//cwnd_ = windowd() - sqrt(2*windowd())/2.0;      
-	else if (how & CWND_HALF_WITH_MIN) {
+        else if (how & CWND_HALF_WITH_MIN) {
 		// We have not thought about how non-standard TCPs, with
 		// non-standard values of decrease_num_, should respond
 		// after quiescent periods.
@@ -1544,8 +1314,8 @@
 	}
 	else if (how & CLOSE_CWND_RESTART) 
 		cwnd_ = int(wnd_restart_);
-	else if (how & CLOSE_CWND_INIT) 	  
-	        cwnd_ = int(wnd_init_);
+	else if (how & CLOSE_CWND_INIT)
+		cwnd_ = int(wnd_init_);
 	else if (how & CLOSE_CWND_ONE)
 		cwnd_ = 1;
 	else if (how & CLOSE_CWND_HALF_WAY) {
@@ -1554,12 +1324,9 @@
                 if (cwnd_ < 1)
                         cwnd_ = 1;
 	}
-
 	if (ssthresh_ < 2)
 		ssthresh_ = 2;
-	if (cwnd_ < 1)
-		cwnd_ = 1; // Added by Mohammad
-	if (how & (CLOSE_CWND_HALF|CLOSE_CWND_RESTART|CLOSE_CWND_INIT|CLOSE_CWND_ONE|CLOSE_CWND_ECNHAT))
+	if (how & (CLOSE_CWND_HALF|CLOSE_CWND_RESTART|CLOSE_CWND_INIT|CLOSE_CWND_ONE))
 		cong_action_ = TRUE;
 
 	fcnt_ = count_ = 0;
@@ -1571,9 +1338,10 @@
 		// This is probably tracing a superset of slowdowns of
 		// which all may not be slow_start's --Padma, 07/'01.
 		trace_event("SLOW_START");
-	}
+	
+
 
-	// printf("we are here\n");
+	
 }
 
 /*
@@ -1650,141 +1418,20 @@
  */
 void TcpAgent::ecn(int seqno)
 {
-	if (seqno > recover_ ||  
-	    last_cwnd_action_ == CWND_ACTION_TIMEOUT) {
+	if (seqno > recover_ || 
+	      last_cwnd_action_ == CWND_ACTION_TIMEOUT) {
 		recover_ =  maxseq_;
 		last_cwnd_action_ = CWND_ACTION_ECN;
 		if (cwnd_ <= 1.0) {
 			if (ecn_backoff_) 
 				rtt_backoff();
 			else ecn_backoff_ = 1;
-			} else ecn_backoff_ = 0;
-		if (ecnhat_) { 
-			if (ecnhat_tcp_friendly_) {
-				target_wnd = cwnd_;
-				//printf("changed target wnd = %f\n", target_wnd);
-				ecnhat_tcp_friendly_increase_ = 1.5/(2.0/ecnhat_alpha_ - 0.5);
-			}
-			slowdown(CLOSE_CWND_ECNHAT|CLOSE_SSTHRESH_ECNHAT);
-		
-		}
-			
-		else
-			slowdown(CLOSE_CWND_HALF|CLOSE_SSTHRESH_HALF);
+		} else ecn_backoff_ = 0;
+		slowdown(CLOSE_CWND_HALF|CLOSE_SSTHRESH_HALF);
 		++necnresponses_ ;
 		// added by sylvia to count number of ecn responses 
-		}
-}
-
-/*
- * Mohammad: Update ecnhat alpha based on the ecn bit in the received packet.
- *
- * This procedure is called only when ecnhat_ is 1.
- */
-void TcpAgent::update_ecnhat_alpha(Packet *pkt)
-{
-	int ecnbit = hdr_flags::access(pkt)->ecnecho();
-	int ackno = hdr_tcp::access(pkt)->ackno();
-	int acked_bytes = 0;
-	// printf("ecnhat_smooth_alpha_: %d\n", ecnhat_smooth_alpha_);
-	if (!ecnhat_smooth_alpha_) 
-		ecnhat_alpha_ = (1 - ecnhat_g_) * ecnhat_alpha_ + ecnhat_g_ * ecnbit;
-	else {
-		acked_bytes = ackno - highest_ack_; 
-		if (acked_bytes <= 0) 
-		  acked_bytes = size_;
-		//printf("size_ = %d, acked_bytes = %d\n",size_, acked_bytes);
-		//ecnhat_total++;
-		ecnhat_total += acked_bytes;
-		if (ecnbit) {
-		  //ecnhat_num_marked++;
-		        ecnhat_num_marked += acked_bytes;
-		        ecnhat_beta_ = 1;
-		}
-		if (ackno > ecnhat_recalc_seq) {
-			double temp_alpha;
-			ecnhat_recalc_seq = ecnhat_maxseq;
-			if (ecnhat_total > 0) { 
-				temp_alpha = ((double) ecnhat_num_marked) / ecnhat_total;
-			} else temp_alpha = 0.0;
-			// Tao: for Karuna
-			llast_win_frac_ = last_win_frac_;
-			last_win_frac_ = temp_alpha;
-
-			ecnhat_alpha_ = (1 - ecnhat_g_) * ecnhat_alpha_ + ecnhat_g_ * temp_alpha;	
-			ecnhat_num_marked = 0;
-			ecnhat_total = 0;
-		}
-	}
-#if 1
-	// Tao: for karuna
-	int ddl_passed = 0;
-	if (karuna_enable_) {
-		if (deadline > 0) {
-			// printf("last_zeta_ %f, last_win_frac_ %f\n", last_zeta_, last_win_frac_);
-			double win_increment = 0;
-			double exp_rate, tmp_lambda;
-			double tleft = 1.0*deadline-1e6*(Scheduler::instance().clock()-start_time); // in us
-			double tmp_rtt = int(t_srtt_ >> T_SRTT_BITS)*tcp_tick_; // in s
-			//Tao: karuna early termination
-			if (tleft < tmp_rtt || tleft <= 0) {
-				// Tao: set to the MCP_init_wnd
-				ddl_passed = 1;
-				karuna_cal_cwnd_ = 1;
-			}
-#if 1
-			else if (last_zeta_ >= 1e9*host_link_rate_/(8*kar_seg_size_)) {
-				ddl_passed = 1;
-				karuna_cal_cwnd_ = 1;
-				// printf("wo zai zheli \n");
-			}
-#endif
-			else {
-				// printf("last rtt %f\n", last_win_rtt_);
-				int remainingsize = (int)(curseq_ - highest_ack_ + 1);
-				// int remainingsize = (int)(curseq_ - maxseq_); // in B
-				if (remainingsize <= 0) {
-					ddl_passed = 1;
-					karuna_cal_cwnd_ = 1;
-
-					exp_rate = 0;
-				}
-				else {
-					exp_rate = 1e6*remainingsize/tleft; // in B per s
-					exp_rate /= kar_seg_size_; // in window_len per s
-					tmp_lambda = 1e9*host_link_rate_/(8*kar_seg_size_) - 1e6*(last_win_frac_*last_win_size_ 
-							- llast_win_frac_*llast_win_size_)/last_win_rtt_;
-					tmp_lambda = 1/(tmp_lambda*tmp_lambda);
-					win_increment = last_zeta_*exp_rate/(last_win_size_*last_win_size_/(last_win_rtt_*last_win_rtt_)*1e12)
-						- ((k_thresh_+last_win_frac_*last_win_size_)+tmp_lambda);
-					win_increment *= last_win_rtt_/1e6;
-					karuna_cal_cwnd_ += win_increment;
-					// printf("exp_rate %f aft_cwnd_ %f\n", exp_rate, karuna_cal_cwnd_);	
-				}
-			}
-
-			if (ddl_passed == 0) {
-				if (maxcwnd_ && karuna_cal_cwnd_ > maxcwnd_)
-					karuna_cal_cwnd_ = maxcwnd_;
-			}
-			else {
-				karuna_cal_cwnd_ = 1;
-			}
-			karuna_cal_cwnd_ = max(karuna_cal_cwnd_, 1);
-
-			// Tao: update related variables
-			llast_win_size_ = last_win_size_;
-			last_win_size_ = karuna_cal_cwnd_;
-			last_win_rtt_ = (int)t_rtt_;
-			last_zeta_ += exp_rate - 1e6*last_win_size_/last_win_rtt_;
-			if (last_zeta_ < 0)
-				last_zeta_ = 0;
-		}
 	}
-
-#endif
 }
- 
 
 /*
  *  Is the connection limited by the network (instead of by a lack
@@ -1806,7 +1453,6 @@
                 // We can exit the Quick-Start phase.
                 qs_window_ = 0;
         }
-       
 	if (!ect_ || !hdr_flags::access(pkt)->ecnecho() ||
 		(old_ecn_ && ecn_burst_)) {
 		/* If "old_ecn", this is not the first ACK carrying ECN-Echo
@@ -2151,10 +1797,8 @@
 	++nackpack_;
 	ts_peer_ = tcph->ts();
 	int ecnecho = hdr_flags::access(pkt)->ecnecho();
-	
-	if (ecnecho && ecn_) 
+	if (ecnecho && ecn_)
 		ecn(tcph->seqno());
-	
 	recv_helper(pkt);
 	recv_frto_helper(pkt);
 	/* grow cwnd and check if the connection is done */ 
@@ -2168,7 +1812,6 @@
                         tcp_eln(pkt);
                         return;
                 }
-printf("dupacks= %d\n",dupacks_+1);
 		if (++dupacks_ == numdupacks_ && !noFastRetrans_) {
 			dupack_action();
 		} else if (dupacks_ < numdupacks_ && singledup_ ) {
@@ -2529,12 +2172,6 @@
 	}
 }
 
-void TcpAgent::setdeadline(int ddl_in_us)
-{
-	deadline = ddl_in_us;
-}
-
-
 void TcpAgent::trace_event(char *eventtype)
 {
 	if (et_ == NULL) return;
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp-full.cc ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-full.cc
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp-full.cc	2017-06-11 17:47:46.602567471 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-full.cc	2017-06-17 16:05:28.402179588 +0800
@@ -1,4 +1,75 @@
- /* Mortier <Richard.Mortier@cl.cam.ac.uk>
+/* -*-	Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t -*- */
+
+/*
+ * Copyright (c) Intel Corporation 2001. All rights reserved.
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+/*
+ * Copyright (c) 1997, 1998 The Regents of the University of California.
+ * All rights reserved.
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ * 	This product includes software developed by the Network Research
+ * 	Group at Lawrence Berkeley National Laboratory.
+ * 4. Neither the name of the University nor of the Laboratory may be used
+ *    to endorse or promote products derived from this software without
+ *    specific prior written permission.
+ * 
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ */
+
+/*
+ *
+ * Full-TCP : A two-way TCP very similar to the 4.4BSD version of Reno TCP.
+ * This version also includes variants Tahoe, NewReno, and SACK.
+ *
+ * This code below has received a fairly major restructuring (Aug. 2001).
+ * The ReassemblyQueue structure is now removed to a separate module and
+ * entirely re-written.
+ * Also, the SACK functionality has been re-written (almost) entirely.
+ * -KF [kfall@intel.com]
+ *
+ * This code below was motivated in part by code contributed by
+ * Kathie Nichols (nichols@baynetworks.com).  The code below is based primarily
+ * on the 4.4BSD TCP implementation. -KF [kfall@ee.lbl.gov]
+ *
+ * Kathie Nichols and Van Jacobson have contributed significant bug fixes,
+ * especially with respect to the the handling of sequence numbers during
+ * connection establishment/clearin.  Additional fixes have followed
+ * theirs.
+ *
+ * Fixes for gensack() and ReassemblyQueue::add() contributed by Richard 
+ * Mortier <Richard.Mortier@cl.cam.ac.uk>
  *
  * Some warnings and comments:
  *	this version of TCP will not work correctly if the sequence number
@@ -46,7 +117,6 @@
 #include "flags.h"
 #include "random.h"
 #include "template.h"
-#include "math.h"
 
 #ifndef TRUE
 #define	TRUE 	1
@@ -101,22 +171,6 @@
 	}
 } class_sack_full;
 
-static class MinTcpClass : public TclClass {
-public:
-	MinTcpClass() : TclClass("Agent/TCP/FullTcp/Sack/MinTCP") {}
-	TclObject* create(int, const char*const*) {
-		return (new MinTcpAgent());
-	}
-} class_min_full;
-
-static class DDTcpClass : public TclClass {
-public:
-	DDTcpClass() : TclClass("Agent/TCP/FullTcp/Sack/DDTCP") {}
-	TclObject* create(int, const char*const*) {
-		return (new DDTcpAgent());
-	}
-} class_dd_full;
-
 /*
  * Delayed-binding variable linkage
  */
@@ -145,26 +199,6 @@
         delay_bind_init_one("ecn_syn_wait_");
         delay_bind_init_one("debug_");
         delay_bind_init_one("spa_thresh_");
-	
-	delay_bind_init_one("flow_remaining_"); //Mohammad
-	delay_bind_init_one("dynamic_dupack_");
-
-	delay_bind_init_one("prio_scheme_"); // Shuang
-	delay_bind_init_one("prio_num_"); //Shuang
-	delay_bind_init_one("prio_cap0"); //Shuang
-	delay_bind_init_one("prio_cap1"); //Shuang
-	delay_bind_init_one("prio_cap2"); //Shuang
-	delay_bind_init_one("prio_cap3"); //Shuang
-	delay_bind_init_one("prio_cap4"); //Shuang
-	delay_bind_init_one("prio_cap5"); //Shuang
-	delay_bind_init_one("prio_cap6"); //Shuang
-	// delay_bind_init_one("deadline"); //Shuang
-	delay_bind_init_one("pf_ddl_enable_"); // Tao 
-	// delay_bind_init_one("karuna_timeout_thresh_"); // Tao 
-	// delay_bind_init_one("cnt_rexmit_"); // Tao 
-	// delay_bind_init_one("cnt_sentbytes_"); // Tao 
-	delay_bind_init_one("early_terminated_"); //Shuang
-
 
 	TcpAgent::delay_bind_init_all();
        
@@ -195,26 +229,8 @@
         if (delay_bind_bool(varName, localName, "ecn_syn_", &ecn_syn_, tracer)) return TCL_OK;
         if (delay_bind(varName, localName, "ecn_syn_wait_", &ecn_syn_wait_, tracer)) return TCL_OK;
         if (delay_bind_bool(varName, localName, "debug_", &debug_, tracer)) return TCL_OK;
-	if (delay_bind(varName, localName, "flow_remaining_", &flow_remaining_, tracer)) return TCL_OK; // Mohammad
-	if (delay_bind(varName, localName, "dynamic_dupack_", &dynamic_dupack_, tracer)) return TCL_OK; // Mohammad
-	if (delay_bind(varName, localName, "prio_scheme_", &prio_scheme_, tracer)) return TCL_OK; // Shuang
-	if (delay_bind(varName, localName, "prio_num_", &prio_num_, tracer)) return TCL_OK; //Shuang
-	if (delay_bind(varName, localName, "prio_cap0", &prio_cap_[0], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prio_cap1", &prio_cap_[1], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prio_cap2", &prio_cap_[2], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prio_cap3", &prio_cap_[3], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prio_cap4", &prio_cap_[4], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prio_cap5", &prio_cap_[5], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prio_cap6", &prio_cap_[6], tracer)) return TCL_OK; 
-	if (delay_bind(varName, localName, "prob_cap_", &prob_cap_, tracer)) return TCL_OK; //Shuang
-	// if (delay_bind(varName, localName, "deadline", &deadline, tracer)) return TCL_OK; //Shuang
-	if (delay_bind(varName, localName, "pf_ddl_enable_", &pf_ddl_enable_, tracer)) return TCL_OK; //Shuang
-	// if (delay_bind(varName, localName, "karuna_timeout_thresh_", &karuna_timeout_thresh_, tracer)) return TCL_OK; //Tao
-	//if (delay_bind(varName, localName, "cnt_rexmit_", &cnt_rexmit_, tracer)) return TCL_OK; //Tao
-	//if (delay_bind(varName, localName, "cnt_sentbytes_", &cnt_sentbytes_, tracer)) return TCL_OK; //Tao
-	if (delay_bind(varName, localName, "early_terminated_", &early_terminated_, tracer)) return TCL_OK; //Shuang
 
-	return TcpAgent::delay_bind_dispatch(varName, localName, tracer);
+        return TcpAgent::delay_bind_dispatch(varName, localName, tracer);
 }
 
 void
@@ -281,12 +297,6 @@
 			advance_bytes(atoi(argv[2]));
 			return (TCL_OK);
 		}
-		//Mohammad
-		
-		if (strcmp(argv[1], "get-flow") == 0) {
-		        flow_remaining_ = atoi(argv[2]);
-		        return(TCL_OK);
-		}
 	}
 	if (argc == 4) {
 		if (strcmp(argv[1], "sendmsg") == 0) {
@@ -320,11 +330,10 @@
 void
 FullTcpAgent::advanceby(int np)
 {
-
-
-// XXX hack:
+	// XXX hack:
 	//	because np is in packets and a data source
 	//	may pass a *huge* number as a way to tell us
+	//	to go forever, just look for the huge number
 	//	and if it's there, pre-divide it
 	if (np >= 0x10000000)
 		np /= maxseg_;
@@ -340,12 +349,6 @@
 void
 FullTcpAgent::advance_bytes(int nb)
 {
-	// Tao:
-	// printf("advance_bytes(): ddl-->%d\n", deadline);
-
-////Shuang: hardcode
-	cwnd_ = initial_window();
-//	//ssthresh_ = cwnd_;
 
 	//
 	// state-specific operations:
@@ -354,26 +357,21 @@
 	//	if SYN_SENT or SYN_RCVD, just queue
 	//	if above ESTABLISHED, we are closing, so don't allow
 	//
-	start_time = now();
-	early_terminated_ = 0;
-  	switch (state_) {
+
+	switch (state_) {
 
 	case TCPS_CLOSED:
 	case TCPS_LISTEN:
                 reset();
-				startseq_ = iss_;
                 curseq_ = iss_ + nb;
-				seq_bound_ = -1;
-				connect();              // initiate new connection
+                connect();              // initiate new connection
 		break;
 
 	case TCPS_ESTABLISHED:
 	case TCPS_SYN_SENT:
 	case TCPS_SYN_RECEIVED:
                 if (curseq_ < iss_) 
-                        curseq_ = iss_;
-				startseq_ = curseq_;
-				seq_bound_ = -1;
+                        curseq_ = iss_; 
                 curseq_ += nb;
 		break;
 
@@ -383,22 +381,6 @@
 		         now(), name(), statestr(state_));
 
 	}
-	// Tao: update karuna variables
-	if (karuna_enable_ && deadline>0) {
-		// printf("update karuna variables\n");
-		// printf("curseq_ %d highest_ack_ %d\n", (int)curseq_, (int)highest_ack_);
-		karuna_cal_cwnd_ = wnd_init_;
-		last_win_frac_ = llast_win_frac_ = 0.0;
-		last_win_size_ = karuna_cal_cwnd_;
-		llast_win_size_ = 0;
-		last_win_rtt_ = int(t_srtt_ >> T_SRTT_BITS)*tcp_tick_; // in us
-		double exp_rate = 1e6*(curseq_-(int)highest_ack_+1)/(deadline*kar_seg_size_);
-		last_zeta_ = exp_rate - 1e6*last_win_size_/last_win_rtt_;
-		if (last_zeta_ < 0)
-			last_zeta_ = 0;
-	}
-	// 
-	//
 
 	if (state_ == TCPS_ESTABLISHED)
 		send_much(0, REASON_NORMAL, maxburst_);
@@ -418,15 +400,11 @@
 void
 FullTcpAgent::sendmsg(int nbytes, const char *flags)
 {
-	if (flags && strcmp(flags, "MSG_EOF") == 0){ 
+	if (flags && strcmp(flags, "MSG_EOF") == 0) 
 		close_on_empty_ = TRUE;	
-printf("setting 2 closeonempty to true for fid= %d\n",fid_);
-        }
-
-	if (flags && strcmp(flags, "DAT_EOF") == 0){ 
+	if (flags && strcmp(flags, "DAT_EOF") == 0) 
 		signal_on_empty_ = TRUE;	
-		printf("setting signalonempty to true for fid= %d\n",fid_);
-	}
+
 	if (nbytes == -1) {
 		infinite_send_ = TRUE;
 		advance_bytes(0);
@@ -468,7 +446,6 @@
 FullTcpAgent::bufferempty()
 {
    	signal_on_empty_=FALSE;
-	//printf("flow fid= %d is done\n",fid_);
 	Tcl::instance().evalf("%s done_data", this->name());
 }
 
@@ -482,6 +459,7 @@
 {
 	curseq_ = maxseq_ - 1;	// now, no more data
 	infinite_send_ = FALSE;	// stop infinite send
+
 	switch (state_) {
 	case TCPS_CLOSED:
 	case TCPS_LISTEN:
@@ -632,9 +610,9 @@
 	cancel_timers();	// cancel timers first
       	TcpAgent::reset();	// resets most variables
 	rq_.clear();		// clear reassembly queue
-	rtt_init();		// zero rtt, srtt, backoff       
+	rtt_init();		// zero rtt, srtt, backoff
+
 	last_ack_sent_ = -1;
-	flow_remaining_ = -1; // Mohammad
 	rcv_nxt_ = -1;
 	pipe_ = 0;
 	rtxbytes_ = 0;
@@ -657,22 +635,7 @@
                 ecn_syn_next_ = 1;
         else
                 ecn_syn_next_ = 0;
-	//Shuang
-	prob_mode_ = false;
-	prob_count_ = 0;
-	last_sqtotal_ = 0;
-	// deadline = 0;
-	early_terminated_ = 0;
-
-	// Tao
-	// pf_ddl_enable_ = 0;
-	if (pias_enable_)
-		karuna_timeout_thresh_ = 2;
-	else
-		karuna_timeout_thresh_ = 2+rand()%9;
-	// printf("kar_time_thresh_ %d\n", karuna_timeout_thresh_);
-	cnt_rexmit_ = 0;
-	cnt_sentbytes_ = 0;
+
 }
 
 /*
@@ -801,7 +764,6 @@
 FullTcpAgent::rcvseqinit(int seq, int dlen)
 {
 	return (seq + dlen + 1);
-//printf("newww3 fid= %d, rcv_nxt_= %d diff= %d, highest_ack= %d, last_ack_sent= %d diff= %d\n",fid_,(int)rcv_nxt_,((int)rcv_nxt_)-oldrcvnxt,(int)highest_ack_,last_ack_sent_,((int)last_ack_sent_)-oldlastacksent);
 }
 
 /*
@@ -859,162 +821,6 @@
 	FullTcpAgent::pack_action(p);
 }
 
-int 
-FullTcpAgent::set_prio(int seq, int maxseq) {
-	int max = 100 * 1460;
-	int prio;
-	if (prio_scheme_ == 0) {
-		if ( seq - startseq_ > max)
-		    prio = max;
-		else
-			prio = seq - startseq_;
-	}
-	if (prio_scheme_ == 1)
-		prio =  maxseq - startseq_;
-	if (prio_scheme_ == 2)
-		prio =  maxseq - seq;
-	if (prio_scheme_ == 3)
-		prio = seq - startseq_;
-
-	if (prio_num_ == 0)
-		return prio;
-	else
-		return calPrio(prio);
-}
-
-int
-FullTcpAgent::calPrio(int prio) {
-	if (prio_num_ != 2 && prio_num_ != 4 && prio_num_ != 8) {
-		fprintf(stderr, "wrong number or priority class %d\n", prio_num_);
-		return 0;
-	}
-	for (int i = 1; i < prio_num_; i++)	
-		if (prio <= prio_cap_[i * 8 / prio_num_ - 1])
-		{
-			//printf("prio %d cap %d ans %d\n", prio, prio_cap_[i*8/prio_num_ - 1], i - 1);
-			return i - 1;
-		}
-
-	//printf("prio %d cap %d ans %d\n", prio, prio_cap_[8/prio_num_ - 1], prio_num_ - 1);
-	return prio_num_ - 1;
-}
-
-// Tao: deadline-ware prio calculation
-int FullTcpAgent::daPrio(int bytes_sent)
-{
-	int ret_prio = num_queue_-1;
-	int act_queue_num = num_queue_/2;
-	if (prio_enable_ && num_queue_>=2) {
-		act_queue_num = min(act_queue_num, num_queue_/2); // suppose we have (8-1=)7 queue thresh 
-		int prio_index = -1;
-	//	for (int i=0; i<8; i++) {
-	//		printf("q %d %d\n", i, queue_thresh_[i]);
-	//	}
-
-		for (int i=0; i<act_queue_num-1; i++) {
-			if (bytes_sent < queue_thresh_[i]) {
-				prio_index = i;
-				break;
-			}
-		}
-	
-		if (prio_index == -1)
-			prio_index = act_queue_num-1;
-
-		// for deadline flow, the priority is 1, 3, 5, 7
-		if (deadline > 0) {
-			// ret_prio = 2*prio_index+1;
-			// Tao: new version
-			double tsnd = 1e6*(Scheduler::instance().clock()-start_time);
-			double tleft = 1.0*deadline-tsnd;
-			double tmp = tsnd/(tleft+1);
-
-			if (tmp < 0.1)
-				ret_prio = 7;
-			else if (tmp < 1)
-				ret_prio = 5;
-			else if (tmp < 10)
-				ret_prio = 3;
-			else
-				ret_prio = 1;
-
-			if (early_detect_ == 1) {
-				double nt = now();
-				nt = nt*1e6;
-				// printf("nt %f ddl %f", nt, start_time*1e6+deadline);
-				if (nt > start_time*1e6+deadline) {
-					ret_prio = 2*(act_queue_num-1)+1;
-				}
-			}
-		}
-		// for non-deadline flow, the priority is 0, 2, 4, 6
-		else {
-			ret_prio = 2*prio_index;
-		}
-		// Tao: debug info
-		/*
-		printf("act_queue_num %d num_queue_ %d\n", act_queue_num, num_queue_);
-		for (int i=0; i<7; i++)
-			printf("queue_thresh_[%d]: %d\n", i, queue_thresh_[i]);
-		printf("info: the bytes_sent %d flow ddl %d with ret_prio %d\n", bytes_sent, deadline, ret_prio);
-		*/
-		return ret_prio;
-	}
-	else {
-		return 0;
-	}
-}
-
-int FullTcpAgent::piasPrio(int bytes_sent)
-{
-	int act_queue_num;
-	if (pias_enable_ && num_queue_>1) {
-		act_queue_num = min(num_queue_, 8);
-		for (int i=0; i<act_queue_num-1; i++) {
-			if (bytes_sent <= queue_thresh_[i]) {
-				// Tao
-				// printf("act_queue_num %d bytes_sent %d, ret_prio %d\n", act_queue_num, bytes_sent, i);
-				return i;
-			}
-		}
-
-		// printf("bytes_sent %d, ret_prio %d\n", bytes_sent, act_queue_num-1);
-		return act_queue_num-1;
-	}
-	else {
-		return 0;
-	}
-}
-
-int FullTcpAgent::karunaPrio(int bytes_sent)
-{
-	int act_queue_num;
-	if (karuna_enable_ && num_queue_>1) {
-		act_queue_num = min(num_queue_, 8);
-		act_queue_num = act_queue_num-1;
-		// deadline flow always with highest priority
-		// Tao: debug info
-		// printf("ddl: %d, bytes_sent: %d, act_queue_num: %d\n", deadline, bytes_sent, act_queue_num);
-		//for (int i=0; i<act_queue_num; i++) {
-		//	printf("thresh %d: %d\n", i, queue_thresh_[i]);
-		//}
-		if (deadline > 0) {
-			return 0;
-		}
-		else {
-			for (int i=0; i<act_queue_num-1; i++) {
-				if (bytes_sent <= queue_thresh_[i]) {
-					return i+1;
-				}
-			}
-			return act_queue_num;
-		}
-	}
-	else {
-		return 0;
-	}
-}
-
 
 /*
  * sendpacket: 
@@ -1033,7 +839,6 @@
         if (!p) p = allocpkt();
         hdr_tcp *tcph = hdr_tcp::access(p);
 	hdr_flags *fh = hdr_flags::access(p);
-	hdr_ip* iph = hdr_ip::access(p);
 
 	/* build basic header w/options */
 
@@ -1044,10 +849,7 @@
 	tcph->sa_length() = 0;    // may be increased by build_options()
         tcph->hlen() = tcpip_base_hdr_size_;
 	tcph->hlen() += build_options(tcph);
-	//Shuang: reduce header length
-	//tcph->hlen() = 1;
 
-	//iph->prio() = curseq_ - seqno + 10; 
 	/*
 	 * Explicit Congestion Notification (ECN) related:
 	 * Bits in header:
@@ -1069,29 +871,21 @@
 		/* Set ect() to 0.  -M. Weigle 1/19/05 */
 		fh->ect() = 0;
 	}
-
-	// Mohammad: for DCTCP, ect should be set on all packets
-    if (ecnhat_)
-		fh->ect() = ect_;
-	
 	if (ecn_ && ect_ && recent_ce_ ) { 
 		// This is needed here for the ACK in a SYN, SYN/ACK, ACK
 		// sequence.
-		pflags |= TH_ECE;	      
-	        
+		pflags |= TH_ECE;
 	}
         // fill in CWR and ECE bits which don't actually sit in
         // the tcp_flags but in hdr_flags
-    if ( pflags & TH_ECE) {
-		fh->ecnecho() = 1;
-    } else {
-		fh->ecnecho() = 0;
-    }
-
-
-    if ( pflags & TH_CWR ) {
-		fh->cong_action() = 1;
-    }
+        if ( pflags & TH_ECE) {
+                fh->ecnecho() = 1;
+        } else {
+                fh->ecnecho() = 0;
+        }
+        if ( pflags & TH_CWR ) {
+                fh->cong_action() = 1;
+        }
 	else {
 		/* Set cong_action() to 0  -M. Weigle 1/19/05 */
 		fh->cong_action() = 0;
@@ -1102,151 +896,25 @@
         hdr_cmn *ch = hdr_cmn::access(p);
         ch->size() = datalen + tcph->hlen();
 
-        if (datalen <= 0) {
+        if (datalen <= 0)
                 ++nackpack_;
-				//Shuang: artifically reduce ack size
-				//ch->size() = 1;
-		}
         else {
                 ++ndatapack_;
                 ndatabytes_ += datalen;
-				// Tao:
-				cnt_sentbytes_ += datalen;
 		last_send_time_ = now();	// time of last data
         }
         if (reason == REASON_TIMEOUT || reason == REASON_DUPACK || reason == REASON_SACK) {
                 ++nrexmitpack_;
                 nrexmitbytes_ += datalen;
         }
+
 	last_ack_sent_ = ackno;
 
 //if (state_ != TCPS_ESTABLISHED) {
 //printf("%f(%s)[state:%s]: sending pkt ", now(), name(), statestr(state_));
 //prpkt(p);
 //}
-	// Tao: this may need change? pfabric works in a deadline-aware?
-	//		here we modify the priority
-	// printf("%d\n", iph->prio_type());
-	// if (deadline > 0 && pf_ddl_enable_ == 1)
-	if (deadline > 0)
-		iph->prio_type() = 1;
-	if (datalen > 0) {
-		//iph->prio_type() = 0;
-		//iph->prio() = set_prio(seqno, curseq_);
-		/* Shuang: prio dropping */
-		// if (deadline == 0 || pf_ddl_enable_ == 0) {
-		if (deadline == 0) {
-			// printf("we are here\n");
-			iph->prio() = set_prio(seqno, curseq_);
-			iph->prio_type() = 0;
-		} else {
-			int tleft = deadline - int((now() - start_time) * 1e6);
-			iph->prio_type() = 1;
-			iph->prio() = deadline + int(start_time * 1e6);
-			if (tleft < 0 || byterm() * 8 / 1e4 > tleft) {
-				iph->prio_type() = 0;
-				iph->prio() = (1 << 30);
-			} else {
-//				iph->prio() = iph->prio() / 40 * 1000 + set_prio(seqno, curseq_) / 1460;
-			}
-		}
-		
-	        /* Mohammad: this is deprecated
-		 * it was for path-aware multipath
-		 * congestion control experiments */
-	        //Shuang: delete it
-			//iph->prio() = fid_;
-	
-		/* Mohammad: inform pacer (TBF) that
-		 * this connection received an EcnEcho.
-		 * this is a bit hacky, but necessary 
-		 * for now since the TBF class doesn't see the
-		 * ACKS. */
-		
-		if (informpacer) 
-		       iph->gotecnecho = 1;
-		else 
-		       iph->gotecnecho = 0;
-        
-		informpacer = 0; 
-		//abd
-	}
-
-	// Tao
-	// printf("here the prio_enable_ is %d\n", prio_enable_);
-	if (prio_enable_) {
-		if (datalen > 0) {
-			// printf("karuna_timeout_thresh_: %d\n", karuna_timeout_thresh_);
-			if (cnt_rexmit_ >= karuna_timeout_thresh_) {
-				// Tao: debug info
-				// printf("kar_time_thresh_: %d\n", karuna_timeout_thresh_);
-				cnt_sentbytes_ = 0;
-				cnt_rexmit_ = 0;
-
-			}
-			if (cnt_sentbytes_ - datalen <= 0)
-				iph->prio() = daPrio(0);
-			else
-				iph->prio() = daPrio(cnt_sentbytes_ - datalen);
-		}
-		else {
-			iph->prio() = 0;
-		}
-	}
-
-	if (pias_enable_) {
-		// debug info
-		// printf("pias_enable configured\n");
-		if (datalen > 0) {
-			// printf("karuna_timeout_thresh_: %d\n", karuna_timeout_thresh_);
-			if (cnt_rexmit_ >= karuna_timeout_thresh_) {
-				// Tao: debug info
-				// printf("kar_time_thresh_: %d\n", karuna_timeout_thresh_);
-				cnt_sentbytes_ = 0;
-				cnt_rexmit_ = 0;
-			}
-			if (cnt_sentbytes_ - datalen <= 0)
-				iph->prio() = piasPrio(0);
-			else
-				iph->prio() = piasPrio(cnt_sentbytes_ - datalen);
-		}
-		else {
-			iph->prio() = 0;
-		}
-	}
 
-	if (karuna_enable_) {
-		// Tao:
-		//printf("t_rtt_: %d, calculated: %f\n", (int)t_rtt_, (t_rtt_>>T_RTT_BITS)*tcp_tick_);
-		//printf("tcp_tick_: %f, t_srtt: %d T_SRTT_BITS: %d\n",tcp_tick_, (int)t_srtt_, T_SRTT_BITS);
-		//printf("calculated: %f\n", (t_srtt_>>T_SRTT_BITS)*tcp_tick_);
-		if (datalen > 0) {
-			// iph->prio() = karunaPrio(seqno-startseq_);
-			// printf("karuna_timeout_thresh_: %d\n", karuna_timeout_thresh_);
-#if 0
-			if (cnt_rexmit_ >= karuna_timeout_thresh_) {
-				// Tao: debug info
-				// printf("kar_time_thresh_: %d\n", karuna_timeout_thresh_);
-				cnt_sentbytes_ = 0;
-				cnt_rexmit_ = 0;
-
-			}
-			// printf("before enteriing karunaPrio, ddl: %d\n", deadline);
-			if (cnt_sentbytes_ - datalen <= 0)
-				iph->prio() = karunaPrio(0);
-			else
-				iph->prio() = karunaPrio(cnt_sentbytes_ - datalen);
-			// printf("sendpacket(): seqno-->%d sentbytes-->%d\n", seqno-startseq_, cnt_sentbytes_);
-#endif
-			iph->prio() = karunaPrio((int)curseq_ - startseq_);
-		}
-		else {
-			iph->prio() = 0;
-		}
-	}
-
-	// Tao
-	// printf("before send(), the prio is %d\n", iph->prio());
 	send(p, 0);
 
 	return;
@@ -1292,12 +960,9 @@
 	// Q: how can this happen?
 
 	if (maxseg_ == 0) 
-	       maxseg_ = size_;// Mohammad: changed from size_  - headersize();
-	// Mohamad: commented the else condition 
-	// which is unnecessary and conflates with
-	// tcp.cc
-	//else
-	//	size_ =  maxseg_ + headersize();
+	   	maxseg_ = size_ - headersize();
+	else
+		size_ =  maxseg_ + headersize();
 
 	int is_retransmit = (seqno < maxseq_);
 	int quiet = (highest_ack_ == maxseq_);
@@ -1306,11 +971,8 @@
 	int emptying_buffer = FALSE;
 	int buffered_bytes = (infinite_send_) ? TCP_MAXSEQ :
 				curseq_ - highest_ack_ + 1;
-//printf("buffered bytes= %d now= %lf fid= %d cwnd= %d\n", buffered_bytes,now(),fid_,(int)cwnd_);
-	int win = window() * maxseg_;	// window (in bytes)
-	if (prob_mode_ && win > 1)
-	  win = 1;
 
+	int win = window() * maxseg_;	// window (in bytes)
 	int off = seqno - highest_ack_;	// offset of seg in window
 	int datalen;
 	//int amtsent = 0;
@@ -1328,28 +990,10 @@
 		datalen = buffered_bytes - off;
 	else
 		datalen = min(buffered_bytes, win) - off;
-	
-//	if (fid_ == 13 || fid_ == 14) {
-//		int tmp = 0;
-//		if (prob_mode_)
-//			tmp = 1;
-//		int tmph = highest_ack_;
-//		printf("%.5lf: FLOW%d: win %d probe: %d buffered bytes %d off %d seqno %d, highestack %d, datalen %d\n", now(), fid_, win, tmp, buffered_bytes, off, seqno, tmph, datalen);
-//		fflush(stdout);
-//	}
-
-//	if (deadline != 0 && !syn) {
-//		double tleft = deadline/1e6 - (now() - start_time);
-//		if (tleft < 0) {
-//			printf("early termination now %.8lf start %.8lf deadline %d\n", now(), start_time, deadline);
-//			fflush(stdout);
-//			buffered_bytes = 0;
-//			datalen = 0;
-//		}
-//    }	
-	if ((signal_on_empty_) && (!buffered_bytes) && (!syn)) {
+
+        if ((signal_on_empty_) && (!buffered_bytes) && (!syn))
 	                bufferempty();
-	}
+
 	//
 	// in real TCP datalen (len) could be < 0 if there was window
 	// shrinkage, or if a FIN has been sent and neither ACKd nor
@@ -1360,7 +1004,6 @@
 	} else if (datalen > maxseg_) {
 		datalen = maxseg_;
 	}
-       
 
 	//
 	// this is an option that causes us to slow-start if we've
@@ -1371,11 +1014,9 @@
 	if (slow_start_restart_ && quiet && datalen > 0) {
 		if (idle_restart()) {
 			slowdown(CLOSE_CWND_INIT);
-			}
+		}
 	}
 
-	//printf("%f %d %d\n", Scheduler::instance().clock(), (int) highest_ack_, (int) maxseq_);
-
 	//
 	// see if sending this packet will empty the send buffer
 	// a dataless SYN packet counts also
@@ -1423,15 +1064,10 @@
 		//	only happen for tiny windows)
 		if (datalen >= ((wnd_ * maxseg_) / 2.0))
 			goto send;
-		//Shuang
-		if (datalen == 1 && prob_mode_)
-			goto send;
 	}
 
-	if (need_send()){
-//		if(fid_==2352) printf("before need_send fid= %d, rcv_nxt_= %d highest_ack= %d, last_ack_sent= %d\n",fid_,(int)rcv_nxt_,(int)highest_ack_,last_ack_sent_);
+	if (need_send())
 		goto send;
-	}
 
 	/*
 	 * send now if a control packet or we owe peer an ACK
@@ -1452,11 +1088,10 @@
 send:
 
 	// is a syn or fin?
-	//printf("made it to send\n");
+
 	syn = (pflags & TH_SYN) ? 1 : 0;
-	
 	int fin = (pflags & TH_FIN) ? 1 : 0;
-	
+
         /* setup ECN syn and ECN SYN+ACK packet headers */
         if (ecn_ && syn && !(pflags & TH_ACK)){
                 pflags |= TH_ECE;
@@ -1520,13 +1155,6 @@
          * Any pending ACK has now been sent.
          */      
 	flags_ &= ~(TF_ACKNOW|TF_DELACK);
-	
-	// Mohammad
-	delack_timer_.force_cancel();
-	/*
-	if (datalen == 0)
-	        printf("%f -- %s sent ACK for %d, canceled delack\n", this->name(), Scheduler::instance().clock(), rcv_nxt_);
-	*/
 
 	/*
 	 * if we have reacted to congestion recently, the
@@ -1550,8 +1178,6 @@
 	//	and adjusted for SYNs and FINs which use up one number
 
 	int highest = seqno + reliable;
-	if (highest > ecnhat_maxseq) 
-		ecnhat_maxseq = highest;
 	if (highest > maxseq_) {
 		maxseq_ = highest;
 		//
@@ -1596,10 +1222,10 @@
 {
 	int npackets = 0;	// sent so far
 
-	//if ((int(t_seqno_)) > 1)
-	//printf("%f: send_much(f:%d, win:%d, pipectrl:%d, pipe:%d, t_seqno:%d, topwin:%d, maxseq_:%d\n",
-	//now(), force, win, pipectrl_, pipe_, int(t_seqno_), topwin, int(maxseq_));
-        	
+//if ((int(t_seqno_)) > 1)
+//printf("%f: send_much(f:%d, win:%d, pipectrl:%d, pipe:%d, t_seqno:%d, topwin:%d, maxseq_:%d\n",
+//now(), force, win, pipectrl_, pipe_, int(t_seqno_), topwin, int(maxseq_));
+
 	if (!force && (delsnd_timer_.status() == TIMER_PENDING))
 		return;
 
@@ -1613,8 +1239,6 @@
 		 */
 		int amt;
 		int seq = nxt_tseq();
-		
-		
 		if (!force && !send_allowed(seq))
 			break;
 		// Q: does this need to be here too?
@@ -1623,10 +1247,8 @@
 			delsnd_timer_.resched(Random::uniform(overhead_));
 			return;
 		}
-		if ((amt = foutput(seq, reason)) <= 0) {
-		  //printf("made call to foutput: returned %d\n", amt);
-		        break;
-		}
+		if ((amt = foutput(seq, reason)) <= 0)
+			break;
 		if ((outflags() & TH_FIN))
 			--amt;	// don't count FINs
 		sent(seq, amt);
@@ -1647,18 +1269,11 @@
 FullTcpAgent::send_allowed(int seq)
 {
         int win = window() * maxseg_;
-		//Shuang: probe_mode
-		if (prob_mode_ && win > 1)
-			win = 1;
         int topwin = curseq_; // 1 seq number past the last byte we can send
 
         if ((topwin > highest_ack_ + win) || infinite_send_)
-                topwin = highest_ack_ + win;
-	
-//	if (seq >= topwin) {
-//		printf("%.5lf: fid %d send not allowed\n", now(), fid_);
-//		fflush(stdout);
-//	}
+                topwin = highest_ack_ + win; 
+
 	return (seq < topwin);
 }
 /*
@@ -1677,17 +1292,11 @@
 void
 FullTcpAgent::newack(Packet* pkt)
 {
-
-   	//Shuang: cancel prob_mode_ when receiving an ack
-    prob_mode_ = false;
-    prob_count_ = 0;
-	
 	hdr_tcp *tcph = hdr_tcp::access(pkt);
 
 	register int ackno = tcph->ackno();
 	int progress = (ackno > highest_ack_);
-	
-	//printf("NEWACK cur %d last %d ackno %d highest %d\n", cur_sqtotal_, last_sqtotal_,int(ackno), int(highest_ack_));
+
 	if (ackno == maxseq_) {
 		cancel_rtx_timer();	// all data ACKd
 	} else if (progress) {
@@ -1695,9 +1304,8 @@
 	}
 
 	// advance the ack number if this is for new data
-	if (progress) {
+	if (progress)
 		highest_ack_ = ackno;
-	}
 
 	// if we have suffered a retransmit timeout, t_seqno_
 	// will have been reset to highest_ ack.  If the
@@ -1752,8 +1360,6 @@
 	return;
 }
 
-
-
 /*
  * this is the simulated form of the header prediction
  * predicate.  While not really necessary for a simulation, it
@@ -1809,7 +1415,7 @@
 {
 	// we are now going to fast-retransmit and willtrace that event
 	trace_event("FAST_RETX");
-	printf("%f: fid %d did a fast retransmit - dupacks = %d\n", now(), fid_, (int)dupacks_);                
+	
 	recover_ = maxseq_;	// recovery target
 	last_cwnd_action_ = CWND_ACTION_DUPACK;
 	return(foutput(seq, REASON_DUPACK));	// send one pkt
@@ -1832,22 +1438,13 @@
 int
 FullTcpAgent::need_send()
 {
-	// Tao: test whether we pass the deadline
-	//		we comment this
-	/*
-	double tleft = 1.0*deadline/1e6 - (now()-start_time);
-	if (tleft <= 0)
-		return 0; */
-
 	if (flags_ & TF_ACKNOW)
 		return TRUE;
 
 	int spa = (spa_thresh_ > 0 && ((rcv_nxt_ - irs_)  < spa_thresh_)) ?
 		1 : segs_per_ack_;
-	//Shuang
-		return ((rcv_nxt_ - last_ack_sent_) > 0);
-	//return ((rcv_nxt_ - last_ack_sent_) >= spa * maxseg_);
-
+		
+	return ((rcv_nxt_ - last_ack_sent_) >= (spa * maxseg_));
 }
 
 /*
@@ -1874,8 +1471,6 @@
 	}
 
 	return (tao > t_rtxcur_);  // verify this CHECKME
-	//return (tao > (int(t_srtt_) >> T_SRTT_BITS)*tcp_tick_); //Mohammad
-
 }
 
 /*
@@ -1911,10 +1506,6 @@
 void
 FullTcpAgent::recv(Packet *pkt, Handler*)
 {
-	//Shuang: cancel probe mode
-		prob_mode_ = false;
-		prob_count_ = 0;
-
 	hdr_tcp *tcph = hdr_tcp::access(pkt);	// TCP header
 	hdr_cmn *th = hdr_cmn::access(pkt);	// common header (size, etc)
 	hdr_flags *fh = hdr_flags::access(pkt);	// flags (CWR, CE, bits)
@@ -1927,7 +1518,6 @@
 	last_state_ = state_;
 
 	int datalen = th->size() - tcph->hlen(); // # payload bytes
-//printf("fid2= %d datalen= %d\n",fid_,datalen);
 	int ackno = tcph->ackno();		 // ack # from packet
 	int tiflags = tcph->flags() ; 		 // tcp flags from packet
 
@@ -1935,6 +1525,7 @@
 //fprintf(stdout, "%f(%s)in state %s recv'd this packet: ", now(), name(), statestr(state_));
 //prpkt(pkt);
 //}
+
 	/* 
 	 * Acknowledge FIN from passive closer even in TCPS_CLOSED state
 	 * (since we lack TIME_WAIT state and RST packets,
@@ -1959,14 +1550,6 @@
 		goto drop;
 	}
 
-	/*
-	 *  Shuang: if fid does not match, drop packets
-	 */
-	if (fid_ != hdr_ip::access(pkt)->fid_) {
-		//printf("extra!%d %d\n", fid_, hdr_ip::access(pkt)->fid_);
-		goto drop;
-	}
-
         /*
          * Process options if not in LISTEN state,
          * else do it below
@@ -1980,33 +1563,12 @@
 	 * They are set to fire every 'interval_' secs, starting
 	 * at time t0 = (0.0 + k * interval_) for some k such
 	 * that t0 > now
-	 */ 
-	/* 
-	 *Mohammad: commented this out for more efficient 
-	 * delayed ack generation
 	 */
-	/*if (delack_interval_ > 0.0 &&
+	if (delack_interval_ > 0.0 &&
 	    (delack_timer_.status() != TIMER_PENDING)) {
 		int last = int(now() / delack_interval_);
 		delack_timer_.resched(delack_interval_ * (last + 1.0) - now());
-		}*/
-	
-
-	// Mohammad
-	if (ecnhat_) 
-		update_ecnhat_alpha(pkt);
-
-	/* Mohammad: check if we need to inform
-	 * pacer of ecnecho.
-	 */
-	if (!(tiflags & TH_SYN) && fh->ecnecho())
-	        informpacer = 1;
-
-	/*if (datalen > 0)
-	  printf("received data: datalen = %d seqno = %d, ackno = %d, ce = %d, ecn-echo = %d\n", datalen, tcph->seqno(), ackno, fh->ce(), fh->ecnecho());
-	else 
-	  printf("received ack : datalen = %d seqno = %d, ackno = %d, ce = %d, ecn-echo = %d\n", datalen, tcph->seqno(), ackno, fh->ce(), fh->ecnecho());
-	*/
+	}
 
 	/*
 	 * Try header prediction: in seq data or in seq pure ACK
@@ -2034,36 +1596,16 @@
 		// cong_action bit
 		//
 
-	    	if (ecn_) { 
-		  if (ecnhat_) { // Mohammad		       
+	    	if (ecn_) {
 	    		if (fh->ce() && fh->ect()) {
 	    			// no CWR from peer yet... arrange to
 	    			// keep sending ECNECHO
-			        if (recent_ce_ == FALSE) {
-				     ce_transition_ = 1;
-				     recent_ce_ = TRUE;
-				} else {
-				     ce_transition_ = 0;
-				}
-	    		} else if (datalen > 0 && !fh->ce() && fh->ect()){
-			        if (recent_ce_ == TRUE) {
-				     ce_transition_ = 1;
-				     recent_ce_ = FALSE;
-				} else {
-				      ce_transition_ = 0;
-				}
-			}  
-		  } else {
-		           if (fh->ce() && fh->ect()) {
-	    			// no CWR from peer yet... arrange to
-	    			// keep sending ECNECHO
 	    			recent_ce_ = TRUE;
-			   } else if (fh->cwr()) { 
-		                // got CWR response from peer.. stop
+	    		} else if (fh->cwr()) {
+	    			// got CWR response from peer.. stop
 	    			// sending ECNECHO bits
-			        recent_ce_ = FALSE;
-		           }		    
-		  }
+	    			recent_ce_ = FALSE;
+	    		}
 	    	}
 
 		// Header predication basically looks to see
@@ -2096,47 +1638,16 @@
 			//	this routine scans all tcpcb's looking for
 			//	DELACK segments and when it finds them
 			//	changes DELACK to ACKNOW and calls tcp_output()
-			
-		        /* Mohammad: For DCTCP state machine */
-		        if (ecnhat_ && ce_transition_ && ((rcv_nxt_ - last_ack_sent_) > 0)) {
-			  // Must send an immediate ACK with with previous ECN state 
-			  // before transitioning to new state
-			  flags_ |= TF_ACKNOW;
-			  recent_ce_ = !recent_ce_;
-			  // printf("should be acking %d with recent_ce_ = %d\n", rcv_nxt_, recent_ce_);
-			  send_much(1, REASON_NORMAL, maxburst_);
-			  recent_ce_ = !recent_ce_;			  
-			} 
-
-		        rcv_nxt_ += datalen;
-
+			rcv_nxt_ += datalen;
 			flags_ |= TF_DELACK;
-			// Mohammad
-			delack_timer_.resched(delack_interval_);
-		
-			// printf("%f: receving data %d, rescheduling delayed ack\n", Scheduler::instance().clock(), rcv_nxt_);
-
 			recvBytes(datalen); // notify application of "delivery"
-			
-			//printf("flow_remaining before dec = %d\n" , flow_remaining_);
-			if (flow_remaining_ > 0)
-			        flow_remaining_ -= datalen; // Mohammad
-		
-			if (flow_remaining_ == 0) {			       
-			        flags_ |= TF_ACKNOW;
-				flow_remaining_ = -1;
-			}
-			//printf("flow_remaining after dec = %d\n" , flow_remaining_);
-			
 			//
 			// special code here to simulate the operation
 			// of a receiver who always consumes data,
 			// resulting in a call to tcp_output
 			Packet::free(pkt);
-			if (need_send()){
+			if (need_send())
 				send_much(1, REASON_NORMAL, maxburst_);
-//				if(fid_==2352) printf("before2 need_send fid= %d, rcv_nxt_= %d highest_ack= %d, last_ack_sent= %d\n",fid_,(int)rcv_nxt_,(int)highest_ack_,last_ack_sent_);
-			}
 			return;
 		}
 	} /* header prediction */
@@ -2196,6 +1707,7 @@
 		t_seqno_ = iss_; /* tcp_sendseqinit() macro in real tcp */
 		rcv_nxt_ = rcvseqinit(irs_, datalen);
 		flags_ |= TF_ACKNOW;
+
 		// check for a ECN-SYN with ECE|CWR
 		if (ecn_ && fh->ecnecho() && fh->cong_action()) {
 			ect_ = TRUE;
@@ -2304,8 +1816,6 @@
 			 */
 			if (datalen > 0) {
 				flags_ |= TF_DELACK;	// data there: wait
-				// Mohammad
-				delack_timer_.resched(delack_interval_);	       
 			} else {
 				flags_ |= TF_ACKNOW;	// ACK peer's SYN
 			}
@@ -2612,49 +2122,21 @@
 
 		if (fh->ecnecho() && (!ecn_ || !ect_)) {
 			fprintf(stderr,
-			    "%f: FullTcp(%s): warning, recvd ecnecho but I am not ECN capable! %d %d\n",
-				now(), name(), ecn_);
+			    "%f: FullTcp(%s): warning, recvd ecnecho but I am not ECN capable!\n",
+				now(), name());
 		}
 
-		//
-		// generate a stream of ecnecho bits until we see a true
-		// cong_action bit
-		//
-
-	    	if (ecn_) { 
-		  if (ecnhat_) { // Mohammad		       
-		    	if (fh->ce() && fh->ect()) {
-	    			// no CWR from peer yet... arrange to
-	    			// keep sending ECNECHO
-			        if (recent_ce_ == FALSE) {
-				     ce_transition_ = 1;
-				     recent_ce_ = TRUE;
-				} else {
-				     ce_transition_ = 0;
-				}
-      	    		} else if (datalen > 0 && !fh->ce() && fh->ect()){
-			        if (recent_ce_ == TRUE) {
-				     ce_transition_ = 1;
-				     recent_ce_ = FALSE;
-				} else {
-				      ce_transition_ = 0;
-				}
-			}
-		   
-		  } else {
-		           if (fh->ce() && fh->ect()) {
-	    			// no CWR from peer yet... arrange to
-	    			// keep sending ECNECHO
-	    			recent_ce_ = TRUE;
-			   } else if (fh->cwr()) { 
-		                // got CWR response from peer.. stop
-	    			// sending ECNECHO bits
-			        recent_ce_ = FALSE;
-		           }		    
-		  }
-	    	}
+                //
+                // generate a stream of ecnecho bits until we see a true
+                // cong_action bit
+                // 
+                if (ecn_) {
+                        if (fh->ce() && fh->ect())
+                                recent_ce_ = TRUE;
+                        else if (fh->cwr()) 
+                                recent_ce_ = FALSE;
+                }
 
- 
 		//
 		// If ESTABLISHED or starting to close, process SACKS
 		//
@@ -2674,22 +2156,11 @@
 		// look for dup ACKs (dup ack numbers, no data)
 		//
 		// do fast retransmit/recovery if at/past thresh
-//if (ackno <= highest_ack_) printf("dupi= %d\n",(int)dupacks_);
-//else printf("in fully\n");
-		//Shuang:
-//		if (ackno <= highest_ack_ && cur_sqtotal_ <= last_sqtotal_) {
 		if (ackno <= highest_ack_) {
 			// a pure ACK which doesn't advance highest_ack_
-//printf("dupi= %d\n",dupacks_);
 			if (datalen == 0 && (!dupseg_fix_ || !dupseg)) {
 
-			        //Mohammad: check for dynamic dupack mode.
-			         if (dynamic_dupack_ > 0.0) {
-				        tcprexmtthresh_ = int(dynamic_dupack_ * window());
-					if (tcprexmtthresh_ < 3)
-					       tcprexmtthresh_ = 3;
-				 }
-				  /*
+                                /*
                                  * If we have outstanding data
                                  * this is a completely
                                  * duplicate ack,
@@ -2716,7 +2187,6 @@
 				} else if (++dupacks_ == tcprexmtthresh_) {
 					// ACK at highest_ack_ AND meets threshold
 					//trace_event("FAST_RECOVERY");
-					//Shuang: dupack_action
 					dupack_action(); // maybe fast rexmt
 					goto drop;
 
@@ -2793,22 +2263,14 @@
 		 * but not if it is a syn packet
 		 */
 		if (fh->ecnecho() && !(tiflags&TH_SYN) )
-		  if (fh->ecnecho()) {
+		if (fh->ecnecho()) {
 			// Note from Sally: In one-way TCP,
 			// ecn() is called before newack()...
 			ecn(highest_ack_);  // updated by newack(), above
 			// "set_rtx_timer();" from T. Kelly.
 			if (cwnd_ < 1)
 			 	set_rtx_timer();
-		  }
-
-		// Mohammad
-		/*if (Random::uniform(1) < ecnhat_alpha_ && !(tiflags&TH_SYN) ) {
-			ecn(highest_ack_);
-			if (cwnd_ < 1)
-			 	set_rtx_timer();
-				}*/
-
+		}
 		// CHECKME: handling of rtx timer
 		if (ackno == maxseq_) {
 			needoutput = TRUE;
@@ -2835,19 +2297,11 @@
 		if ((!delay_growth_ || (rcv_nxt_ > 0)) &&
 		    last_state_ == TCPS_ESTABLISHED) {
 			if (!partial || open_cwnd_on_pack_) {
-				if (!ect_ || !hdr_flags::access(pkt)->ecnecho() || ecn_burst_)
-				  opencwnd();
+                           if (!ect_ || !hdr_flags::access(pkt)->ecnecho())
+				opencwnd();
                         }
 		}
 
-		// Mohammad
-		if (ect_) {
-			if (!ecn_burst_ && hdr_flags::access(pkt)->ecnecho())
-				ecn_burst_ = TRUE;
-			else if (ecn_burst_ && ! hdr_flags::access(pkt)->ecnecho())
-				ecn_burst_ = FALSE;
-		}
-
 		if ((state_ >= TCPS_FIN_WAIT_1) && (ackno == maxseq_)) {
 			ourfinisacked = TRUE;
 		}
@@ -2941,42 +2395,14 @@
 			// don't really have a process anyhow, just
 			// accept the data here as-is (i.e. don't
 			// require being in ESTABLISHED state)
-			
-		        /* Mohammad: For DCTCP state machine */
-		        if (ecnhat_ && ce_transition_ && ((rcv_nxt_ - last_ack_sent_) > 0)) {
-			  // Must send an immediate ACK with with previous ECN state 
-			  // before transitioning to new state
-			  flags_ |= TF_ACKNOW;
-			  recent_ce_ = !recent_ce_;
-			  //printf("should be acking %d with recent_ce_ = %d\n", rcv_nxt_, recent_ce_);
-			  send_much(1, REASON_NORMAL, maxburst_);
-			  recent_ce_ = !recent_ce_;			  
-                        }
-		        
-		        flags_ |= TF_DELACK;
-			// Mohammad
-			delack_timer_.resched(delack_interval_);			
+			flags_ |= TF_DELACK;
 			rcv_nxt_ += datalen;
-
-			// printf("%f: receving data %d, rescheduling delayed ack\n", Scheduler::instance().clock(), rcv_nxt_);
-
 			tiflags = tcph->flags() & TH_FIN;
 
 			// give to "application" here
 			// in "real" TCP, this is sbappend() + sorwakeup()
-			if (datalen) {
+			if (datalen)
 				recvBytes(datalen); // notify app. of "delivery"
-
-				//printf("flow_remaining before dec = %d\n" , flow_remaining_);
-				if (flow_remaining_ > 0)
-				      flow_remaining_ -= datalen; // Mohammad
-				if (flow_remaining_ == 0) {		       
-				      flags_ |= TF_ACKNOW;
-				      flow_remaining_ = -1;
-				}
-				//printf("flow_remaining after dec = %d\n" , flow_remaining_);			
-       			}
-
 			needoutput = need_send();
 		} else {
 			// see the "tcp_reass" function:
@@ -2986,29 +2412,13 @@
 			// segments or hole-fills.  Also,
 			// send an ACK (or SACK) to the other side right now.
 			// Note that we may have just a FIN here (datalen = 0)
-		  
-		        /* Mohammad: the DCTCP receiver conveys the ECN-CE 
-			   received on each out-of-order data packet */
-
-		        int rcv_nxt_old_ = rcv_nxt_; // notify app. if changes
+			int rcv_nxt_old_ = rcv_nxt_; // notify app. if changes
 			tiflags = reass(pkt);
 			if (rcv_nxt_ > rcv_nxt_old_) {
 				// if rcv_nxt_ has advanced, must have
 				// been a hole fill.  In this case, there
-				// is something to give to application		       
-			        recvBytes(rcv_nxt_ - rcv_nxt_old_);
-
-				//printf("flow_remaining before dec = %d\n" , flow_remaining_);
-				if (flow_remaining_ > 0) 
-				       flow_remaining_ -= datalen; // Mohammad
-							
-				if (flow_remaining_ == 0) {		       
-				       flags_ |= TF_ACKNOW;
-				       flow_remaining_ = -1;
-				}
-			
-				//printf("flow_remaining after dec = %d\n" , flow_remaining_);
-			
+				// is something to give to application
+				recvBytes(rcv_nxt_ - rcv_nxt_old_);
 			}
 			flags_ |= TF_ACKNOW;
 
@@ -3152,13 +2562,15 @@
 		cancel_rtx_timer();
 		rtt_active_ = FALSE;
 		(void)fast_retransmit(highest_ack_);
-		return; 
+                return; 
         }      
     
         if (bug_fix_) {
-                 // The line below, for "bug_fix_" true, avoids
-                 // problems with multiple fast retransmits in one
-                 // window of data.
+                /*
+                 * The line below, for "bug_fix_" true, avoids
+                 * problems with multiple fast retransmits in one
+                 * window of data.
+                 */      
                 return;  
         }
     
@@ -3172,8 +2584,7 @@
 	// so don't scale by maxseg_
 	// as real TCP does
 	cwnd_ = double(ssthresh_) + double(dupacks_);
-       return;
-  
+        return;
 }
 
 void
@@ -3181,8 +2592,6 @@
 {
 	recover_ = maxseq_;
 
-//	cwnd_ = 0.5 * cwnd_; 
-//Shuang: comment all below
 	if (cwnd_ < 1.0) {
                 if (debug_) {
 	            fprintf(stderr, "%f: FullTcpAgent(%s):: resetting cwnd from %f to 1\n",
@@ -3197,16 +2606,8 @@
 		slowdown(CLOSE_SSTHRESH_HALF|CLOSE_CWND_RESTART);
 		last_cwnd_action_ = CWND_ACTION_TIMEOUT;
 	}
-
-	//cwnd_ = initial_window();
-//	ssthresh_ = cwnd_;
-
 	reset_rtx_timer(1);
 	t_seqno_ = (highest_ack_ < 0) ? iss_ : int(highest_ack_);
-	ecnhat_recalc_seq = t_seqno_;
-	ecnhat_maxseq = ecnhat_recalc_seq;
-	
-	//printf("%f, fid %d took timeout, cwnd_ = %f\n", now(), fid_, (double)cwnd_);
 	fastrecov_ = FALSE;
 	dupacks_ = 0;
 }
@@ -3248,7 +2649,6 @@
 	case TCP_TIMER_RTX:
                 /* retransmit timer */
                 ++nrexmit_;
-				++cnt_rexmit_; // Tao: count for karuna
                 timeout_action();
 		/* fall thru */
 	case TCP_TIMER_DELSND:
@@ -3262,8 +2662,7 @@
                         flags_ |= TF_ACKNOW;
                         send_much(1, REASON_NORMAL, 0);
                 }
-		// Mohammad
-                //delack_timer_.resched(delack_interval_);
+                delack_timer_.resched(delack_interval_);
 		break;
 	default:
 		fprintf(stderr, "%f: FullTcpAgent(%s) Unknown Timeout type %d\n",
@@ -3307,11 +2706,6 @@
 	return;
 }
 
-int
-FullTcpAgent::byterm() {
-	return curseq_ - int(highest_ack_) - window() * maxseg_;
-}
-
 
 /*
  * ****** Tahoe ******
@@ -3434,51 +2828,6 @@
  * "pipe" style control until recovery is complete
  */
 
-int
-SackFullTcpAgent::set_prio(int seq, int maxseq) {
-	int max = 100 * 1460;
-	int prio;
-	if (prio_scheme_ == 0) {
-		if ( seq - startseq_ > max)
-			prio =  max;
-		else
-			prio =  seq - startseq_;
-	}
-	if (prio_scheme_ == 1)
-		prio =  maxseq - startseq_;
-	if (prio_scheme_ == 2) {
-			//printf("%d %d\n", maxseq, int(highest_ack_));
-			//printf("%d %d %d %d\n", maxseq, int(highest_ack_), sq_.total(), maxseq - int(highest_ack_) - sq_.total() + 10);
-			//fflush(stdout);
-			if (maxseq - int(highest_ack_) - sq_.total() + 10 < 0)
-				prio = 0;
-			else
-				prio = maxseq - int(highest_ack_) - sq_.total() + 10;
-			//return maxseq - seq;
-		}
-	if (prio_scheme_ == 3) {
-		//printf("3??\n");
-		prio =  seq - startseq_;
-	}
-	if (prio_scheme_ == 4) { //in batch
-		if (int(highest_ack_) >= seq_bound_) {
-			seq_bound_ = maxseq_;
-			if (maxseq - int(highest_ack_) - sq_.total() + 10 < 0)
-				last_prio_ = 0;
-			else
-				last_prio_ = maxseq - int(highest_ack_) - sq_.total() + 10;
-		}
-		//printf("prio scheme 4: highest ack %d maxseq_ %d seq %d prio %d\n", int(highest_ack_), int(maxseq_), seq, last_prio_);
-		prio = last_prio_;
-	}
-
-	if (prio_num_ == 0)
-		return prio;
-	else
-		return calPrio(prio);
-}
-
-
 void
 SackFullTcpAgent::reset()
 {
@@ -3525,9 +2874,6 @@
 		 * packet.   -M. Weigle  6/19/02
 		 */
 		last_cwnd_action_ = CWND_ACTION_DUPACK;
-		/* Mohammad: cut window by half when we have 3 dup ack */
-		if (ecnhat_) 
-			slowdown(CLOSE_SSTHRESH_HALF|CLOSE_CWND_HALF); 
 		cancel_rtx_timer();
 		rtt_active_ = FALSE;
 		int amt = fast_retransmit(highest_ack_);
@@ -3587,10 +2933,7 @@
 {
 //printf("%f: EXITING fast recovery, recover:%d\n",
 //now(), recover_);
-
-	//Shuang: not set pipectrol_ = false
 	fastrecov_ = pipectrl_ = FALSE;
-	fastrecov_ = FALSE;
         if (!sq_.empty() && sack_min_ < highest_ack_) {
                 sack_min_ = highest_ack_;
                 sq_.cleartonxt();
@@ -3621,8 +2964,6 @@
         } else {
                 tcph->sa_length() = 0;
         }
-	//Shuang: reduce ack size
-	//return 0;
 	return (total);
 }
 
@@ -3631,23 +2972,6 @@
 {
 	FullTcpAgent::timeout_action();
 
-	/*recover_ = maxseq_;
-
-	int progress = curseq_ - int(highest_ack_) - sq_.total();
-	cwnd_ = min((last_timeout_progress_ - progress) / 1460 + 1, maxcwnd_);
-	ssthresh_ = cwnd_;
-	printf("%d %d", progress/1460, last_timeout_progress_ / 1460);
-	last_timeout_progress_ = progress;
-
-	reset_rtx_timer(1);
-	t_seqno_ = (highest_ack_ < 0) ? iss_ : int(highest_ack_);
-	ecnhat_recalc_seq = t_seqno_;
-	ecnhat_maxseq = ecnhat_recalc_seq;
-	
-	printf("%f, fid %d took timeout, cwnd_ = %f\n", now(), fid_, (double)cwnd_);
-	fastrecov_ = FALSE;
-	dupacks_ = 0;*/
-
 	//
 	// original SACK spec says the sender is
 	// supposed to clear out its knowledge of what
@@ -3657,7 +2981,7 @@
 	// enabled.
 	//
 
-	if (clear_on_timeout_ ) {
+	if (clear_on_timeout_) {
 		sq_.clear();
 		sack_min_ = highest_ack_;
 	}
@@ -3673,7 +2997,6 @@
 	// in the pkt.  Insert each block range
 	// into the scoreboard
 	//
-	last_sqtotal_ = sq_.total();
 
 	if (max_sack_blocks_ <= 0) {
 		fprintf(stderr,
@@ -3694,28 +3017,22 @@
 		}
 		sq_.add(tcph->sa_left(i), tcph->sa_right(i), 0);  
 	}
-	
-	cur_sqtotal_ = sq_.total();
+
 	return;
 }
 
 int
 SackFullTcpAgent::send_allowed(int seq)
 {
-	//Shuang: always pipe control and simple pipe function
-	//pipectrl_ = true;
-	//pipe_ = maxseq_ - highest_ack_ - sq_.total();
-
 	// not in pipe control, so use regular control
 	if (!pipectrl_)
 		return (FullTcpAgent::send_allowed(seq));
 
 	// don't overshoot receiver's advertised window
 	int topawin = highest_ack_ + int(wnd_) * maxseg_;
-//	printf("%f: PIPECTRL: SEND(%d) AWIN:%d, pipe:%d, cwnd:%d highest_ack:%d sqtotal:%d\n",
-	//now(), seq, topawin, pipe_, int(cwnd_), int(highest_ack_), sq_.total());
-
 	if (seq >= topawin) {
+//printf("%f: SEND(%d) NOT ALLOWED DUE TO AWIN:%d, pipe:%d, cwnd:%d\n",
+//now(), seq, topawin, pipe_, int(cwnd_));
 		return FALSE;
 	}
 
@@ -3787,10 +3104,6 @@
 		} else if (fcnt <= 0)
 			break;
 		else {
-		//Shuang; probe
-			if (prob_cap_ != 0) {
-				seq ++;
-			} else
 			seq += maxseg_;
 		}
 	}
@@ -3799,218 +3112,3 @@
 //now(), int(t_seqno_));
 	return (t_seqno_);
 }
-
-int
-SackFullTcpAgent::byterm() {
-	return curseq_ - int(highest_ack_) - sq_.total() - window() * maxseg_;
-}
-void
-MinTcpAgent::timeout_action() {
-//Shuang: prob count when cwnd=1
-	if (prob_cap_ != 0) {
-		prob_count_ ++;
-		if (prob_count_ == prob_cap_) {
-			prob_mode_ = true;
-		}
-		//Shuang: h_seqno_?
-		h_seqno_ = highest_ack_;
-	}
-
-	
-	SackFullTcpAgent::timeout_action();
-}
-
-double
-MinTcpAgent::rtt_timeout() {
-	return minrto_;
-}
-
-//void
-//MinTcpAgent::advance_bytes(int nb)
-//	SackFullTcpAgent::advance_bytes();
-//}
-
-void
-DDTcpAgent::slowdown(int how) {
-
-	double decrease;  /* added for highspeed - sylvia */
-	double win, halfwin, decreasewin;
-	int slowstart = 0;
-	++ncwndcuts_;
-	if (!(how & TCP_IDLE) && !(how & NO_OUTSTANDING_DATA)){
-		++ncwndcuts1_; 
-	}
-
-	//Shuang: deadline-aware
-	double penalty = ecnhat_alpha_;
-	if (deadline != 0) {
-		double tleft = deadline/1e6 - (now() - start_time);
-
-		//if (tleft < 0 && now() < 3) {
-		//	cwnd_ = 1;
-		//	printf("early termination now %.8lf start %.8lf deadline %d\n", now(), start_time, deadline);
-		//	fflush(stdout);
-   		//	if (signal_on_empty_);
-		//		bufferempty();
-	    //		return;
-		//} else 
-		if (tleft < 0) {
-			tleft = 1e10;	
-		}
-		double rtt = int(t_srtt_ >> T_SRTT_BITS) * tcp_tick_;
-		double Tc = byterm() / (0.75 * cwnd_ * maxseg_) * rtt;
-		double d = Tc/tleft;
-		if (d > 2) d = 2;
-		if (d < 0.5) d = 0.5;
-		if (d >= 0)
-			penalty = pow(penalty, d);
-  		//printf("deadline left %.6lf d-factor %f Tc %f start %f rm %d cwnd %f\n", tleft, Tc/tleft, Tc, start_time, byterm(), double(cwnd_));
-		//fflush(stdout);
-	} else if (penalty > 0) {
-		//non-deadline->TCP
-		penalty = 1;
-	}
-
-	//ecnhat_alpha_ = 0.07;
-	// we are in slowstart for sure if cwnd < ssthresh
-	if (cwnd_ < ssthresh_) 
-		slowstart = 1;
-        if (precision_reduce_) {
-		halfwin = windowd() / 2;
-                if (wnd_option_ == 6) {         
-                        /* binomial controls */
-                        decreasewin = windowd() - (1.0-decrease_num_)*pow(windowd(),l_parameter_);
-                } else if (wnd_option_ == 8 && (cwnd_ > low_window_)) { 
-                        /* experimental highspeed TCP */
-			decrease = decrease_param();
-			//if (decrease < 0.1) 
-			//	decrease = 0.1;
-			decrease_num_ = decrease;
-                        decreasewin = windowd() - (decrease * windowd());
-                } else {
-	 		decreasewin = decrease_num_ * windowd();
-		}
-		win = windowd();
-		//printf("decrease param = %f window = %f decwin = %f\n", decrease_num_, win, decreasewin);
-	} else  {
-		int temp;
-		temp = (int)(window() / 2);
-		halfwin = (double) temp;
-                if (wnd_option_ == 6) {
-                        /* binomial controls */
-                        temp = (int)(window() - (1.0-decrease_num_)*pow(window(),l_parameter_));
-                } else if ((wnd_option_ == 8) && (cwnd_ > low_window_)) { 
-                        /* experimental highspeed TCP */
-			decrease = decrease_param();
-			//if (decrease < 0.1)
-                        //       decrease = 0.1;		
-			decrease_num_ = decrease;
-                        temp = (int)(windowd() - (decrease * windowd()));
-                } else {
- 			temp = (int)(decrease_num_ * window());
-		}
-		decreasewin = (double) temp;
-		win = (double) window();
-	}
-	if (how & CLOSE_SSTHRESH_HALF)
-		// For the first decrease, decrease by half
-		// even for non-standard values of decrease_num_.
-		if (first_decrease_ == 1 || slowstart ||
-			last_cwnd_action_ == CWND_ACTION_TIMEOUT) {
-			// Do we really want halfwin instead of decreasewin
-		// after a timeout?
-			ssthresh_ = (int) halfwin;
-		} else {
-			ssthresh_ = (int) decreasewin;
-		}
-	else if (how & CLOSE_SSTHRESH_ECNHAT) 
-		ssthresh_ = (int) ((1 - penalty/2.0) * windowd());
-	//ssthresh_ = (int) (windowd() - sqrt(2*windowd())/2.0);		
-        else if (how & THREE_QUARTER_SSTHRESH)
-		if (ssthresh_ < 3*cwnd_/4)
-			ssthresh_  = (int)(3*cwnd_/4);
-	if (how & CLOSE_CWND_HALF)
-		// For the first decrease, decrease by half
-		// even for non-standard values of decrease_num_.
-		if (first_decrease_ == 1 || slowstart || decrease_num_ == 0.5) {
-			cwnd_ = halfwin;
-		} else cwnd_ = decreasewin;
-        else if (how & CLOSE_CWND_ECNHAT) {
-		cwnd_ = (1 - penalty/2.0) * windowd();
-		if (cwnd_ < 1)
-			cwnd_ = 1;
-		}
-	//cwnd_ = windowd() - sqrt(2*windowd())/2.0;      
-	else if (how & CWND_HALF_WITH_MIN) {
-		// We have not thought about how non-standard TCPs, with
-		// non-standard values of decrease_num_, should respond
-		// after quiescent periods.
-                cwnd_ = decreasewin;
-                if (cwnd_ < 1)
-                        cwnd_ = 1;
-	}
-	else if (how & CLOSE_CWND_RESTART) 
-		cwnd_ = int(wnd_restart_);
-	else if (how & CLOSE_CWND_INIT) 	  
-	        cwnd_ = int(wnd_init_);
-	else if (how & CLOSE_CWND_ONE)
-		cwnd_ = 1;
-	else if (how & CLOSE_CWND_HALF_WAY) {
-		// cwnd_ = win - (win - W_used)/2 ;
-		cwnd_ = W_used + decrease_num_ * (win - W_used);
-                if (cwnd_ < 1)
-                        cwnd_ = 1;
-	}
-	if (ssthresh_ < 2)
-		ssthresh_ = 2;
-	if (cwnd_ < 1)
-		cwnd_ = 1; // Added by Mohammad
-	if (how & (CLOSE_CWND_HALF|CLOSE_CWND_RESTART|CLOSE_CWND_INIT|CLOSE_CWND_ONE|CLOSE_CWND_ECNHAT))
-		cong_action_ = TRUE;
-
-	fcnt_ = count_ = 0;
-	if (first_decrease_ == 1)
-		first_decrease_ = 0;
-	// for event tracing slow start
-	if (cwnd_ == 1 || slowstart) 
-		// Not sure if this is best way to capture slow_start
-		// This is probably tracing a superset of slowdowns of
-		// which all may not be slow_start's --Padma, 07/'01.
-		trace_event("SLOW_START");
-}
-
-int
-DDTcpAgent::byterm() {
-	// Tao: notice here
-	return curseq_ - int(highest_ack_) - sq_.total();
-}
-
-int
-DDTcpAgent::foutput(int seqno, int reason) {
-	if (deadline != 0) {
-// 		double tleft = double(deadline)/1e6 - (now() - start_time) - byterm()*8/1e10;
-		double tleft = deadline/1e6 - (now() - start_time) - (curseq_ - int(maxseq_)) * 8/1e10;
-   		if (tleft < 0 && signal_on_empty_) {
-			early_terminated_ = 1;
-			bufferempty();
-			printf("early termination V2 now %.8lf start %.8lf deadline %d byterm %d tleft %.8f\n", now(), start_time, deadline, curseq_ - int(maxseq_), tleft);
-			fflush(stdout);
-			return 0;
-		} else if (tleft < 0) {
-			return 0;
-		}
-		//printf("test foutput\n");
-	}
-	return SackFullTcpAgent::foutput(seqno, reason);
-}
-
-int
-DDTcpAgent::need_send() {
-	if (deadline != 0) {
- 		double tleft1 = deadline/1e6 - (now() - start_time);
-		if (tleft1 < 0)
-			return 0;
-		//printf("test need send\n");
-	}
-	return SackFullTcpAgent::need_send();
-}
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp-full.h ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-full.h
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp-full.h	2017-02-11 23:58:35.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-full.h	2017-06-17 16:05:28.402179588 +0800
@@ -1,3 +1,38 @@
+/* -*-	Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t -*- */
+/*
+ * Copyright (c) 1997, 2001 The Regents of the University of California.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *  This product includes software developed by the Network Research
+ *  Group at Lawrence Berkeley National Laboratory.
+ * 4. Neither the name of the University nor of the Laboratory may be used
+ *    to endorse or promote products derived from this software without
+ *    specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ * @(#) $Header: /cvsroot/nsnam/ns-2/tcp/tcp-full.h,v 1.60 2008/10/14 17:42:52 sallyfloyd Exp $ (LBL)
+ */
 
 #ifndef ns_tcp_full_h
 #define ns_tcp_full_h
@@ -81,21 +116,18 @@
 class FullTcpAgent : public TcpAgent {
 public:
 	FullTcpAgent() :
-		prio_scheme_(0), prio_num_(0), startseq_(0), last_prio_(0), seq_bound_(0),
 		closed_(0), pipe_(-1), rtxbytes_(0), fastrecov_(FALSE),
         	last_send_time_(-1.0), infinite_send_(FALSE), irs_(-1),
         	delack_timer_(this), flags_(0),
         	state_(TCPS_CLOSED), recent_ce_(FALSE),
-		  last_state_(TCPS_CLOSED), rq_(rcv_nxt_), last_ack_sent_(-1),
-		  informpacer(0), pf_ddl_enable_(0) { }
-		// Mohammad: added informpacer
+        	last_state_(TCPS_CLOSED), rq_(rcv_nxt_), last_ack_sent_(-1) { }
 
 	~FullTcpAgent() { cancel_timers(); rq_.clear(); }
 	virtual void recv(Packet *pkt, Handler*);
 	virtual void timeout(int tno); 	// tcp_timers() in real code
 	virtual void close() { usrclosed(); }
 	void advanceby(int);	// over-rides tcp base version
-	virtual void advance_bytes(int);	// unique to full-tcp
+	void advance_bytes(int);	// unique to full-tcp
         virtual void sendmsg(int nbytes, const char *flags = 0);
         virtual int& size() { return maxseg_; } //FullTcp uses maxseg_ for size_
 	virtual int command(int argc, const char*const* argv);
@@ -103,35 +135,6 @@
 protected:
 	virtual void delay_bind_init_all();
 	virtual int delay_bind_dispatch(const char *varName, const char *localName, TclObject *tracer);
-	/* Shuang: priority dropping */
-	virtual int set_prio(int seq, int maxseq);
-	virtual int calPrio(int prio);
-	virtual int byterm();
-	virtual int daPrio(int bytes_sent);
-	virtual int piasPrio(int bytes_sent);
-	virtual int karunaPrio(int bytes_sent);
-
-	int prio_scheme_; // 0 sent so far, 1 flow size, 2 remaining size, 3 se so far
-	int prio_num_; //number of priorities; 0: unlimited
-	int prio_cap_[7];
-	int startseq_;
-	int last_prio_;
-	int seq_bound_;
-	int prob_cap_;  //change to prob mode after #prob_cap_ timeout
-	int prob_count_; //current #timeouts
-	bool prob_mode_;
-	int last_sqtotal_;
-	int cur_sqtotal_;
-	int pf_ddl_enable_;
-	// Tao: we may move these two to the parent class TcpAgent
-	// int deadline; // time remain in us at the beginning
-	// double start_time; //start time
-	int early_terminated_; //early terminated
-	// Tao: for karuna reximt
-	int karuna_timeout_thresh_;
-	int cnt_rexmit_;
-	int cnt_sentbytes_;
-
 	int closed_;
 	int ts_option_size_;	// header bytes in a ts option
 	int pipe_;		// estimate of pipe occupancy (for Sack)
@@ -145,26 +148,6 @@
 	int deflate_on_pack_;	// deflate on partial acks (reno:yes)
 	int data_on_syn_;   // send data on initial SYN?
 	double last_send_time_;	// time of last send
-  
-
-	/* Mohammad: state-variable for robust
-	   FCT measurement. 
-	*/
-	int flow_remaining_; /* Number of bytes yet to be received from 
-			       the current flow (at the receiver). This is 
-			       set by TCL when starting a flow. Receiver will
-			       set immediate ACKs when nothing remains to
-			       notify sender of flow completion. */
-       
-	/* Mohammad: state-variable to inform 
-	 * pacer (TBF) of receiving ecnecho for the flow
-	 */
-	int informpacer;
-	//abd
-
-	// Mohammad: if non-zero, set dupack threshold to max(3, dynamic_dupack_ * cwnd)_
-	double dynamic_dupack_;
-  
 	int close_on_empty_;	// close conn when buffer empty
 	int signal_on_empty_;	// signal when buffer is empty
 	int reno_fastrecov_;	// do reno-style fast recovery?
@@ -232,8 +215,8 @@
 	void connect();     		// do active open
 	void listen();      		// do passive open
 	void usrclosed();   		// user requested a close
-	virtual int need_send();    		// send ACK/win-update now?
-	virtual int foutput(int seqno, int reason = 0); // output 1 packet
+	int need_send();    		// send ACK/win-update now?
+	int foutput(int seqno, int reason = 0); // output 1 packet
 	void newack(Packet* pkt);	// process an ACK
 	int pack(Packet* pkt);		// is this a partial ack?
 	void dooptions(Packet*);	// process option(s)
@@ -242,8 +225,7 @@
 	void prpkt(Packet*);		// print packet (debugging helper)
 	char *flagstr(int);		// print header flags as symbols
 	char *statestr(int);		// print states as symbols
-	
-	
+
 	/*
 	* the following are part of a tcpcb in "real" RFC793 TCP
 	*/
@@ -251,18 +233,13 @@
 	int flags_;     /* controls next output() call */
 	int state_;     /* enumerated type: FSM state */
 	int recent_ce_;	/* last ce bit we saw */
-	int ce_transition_; /* Mohammad: was there a transition in 
-			       recent_ce by last ACK. for DCTCP receiver 
-			       state machine. */
 	int last_state_; /* FSM state at last pkt recv */
 	int rcv_nxt_;       /* next sequence number expected */
-	
 	ReassemblyQueue rq_;    /* TCP reassembly queue */
 	/*
 	* the following are part of a tcpcb in "real" RFC1323 TCP
 	*/
 	int last_ack_sent_; /* ackno field from last segment we sent */
-	
 	double recent_;		// ts on SYN written by peer
 	double recent_age_;	// my time when recent_ was set
 
@@ -295,6 +272,7 @@
 		sq_(sack_min_), sack_min_(-1), h_seqno_(-1) { }
 	~SackFullTcpAgent() { rq_.clear(); }
 protected:
+
 	virtual void delay_bind_init_all();
 	virtual int delay_bind_dispatch(const char *varName, const char *localName, TclObject *tracer);
 
@@ -303,7 +281,6 @@
 	virtual void dupack_action();
 	virtual void process_sack(hdr_tcp*);
 	virtual void timeout_action();
-	virtual int set_prio(int seq, int maxseq);
 	virtual int nxt_tseq();
 	virtual int hdrsize(int nblks);
 	virtual int send_allowed(int);
@@ -312,7 +289,6 @@
 			h_seqno_ += amt;
 		FullTcpAgent::sent(seq, amt);
 	}
-	virtual int byterm();
 
 	int build_options(hdr_tcp*);	// insert opts, return len
 	int clear_on_timeout_;	// clear sender's SACK queue on RTX timeout?
@@ -333,20 +309,4 @@
 	int h_seqno_;		// next seq# to hole-fill
 };
 
-class MinTcpAgent : public SackFullTcpAgent {
-public:
-   virtual void timeout_action();
-   virtual double rtt_timeout();
-//   virtual void advance_bytes(int nb);
-};
-
-class DDTcpAgent : public SackFullTcpAgent {
-
-	virtual void slowdown(int how);			/* reduce cwnd/ssthresh */
-	virtual int byterm();
-	virtual int foutput(int seqno, int reason = 0); // output 1 packet
-	virtual int need_send();    		// send ACK/win-update now?
-
-};
-
 #endif
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp.h ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp.h
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp.h	2017-03-04 11:51:17.662503221 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp.h	2017-06-17 16:05:28.402179588 +0800
@@ -1,3 +1,37 @@
+/* -*-	Mode:C++; c-basic-offset:8; tab-width:8; indent-tabs-mode:t -*- */ /*
+ * Copyright (c) 1991-1997 Regents of the University of California.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the Computer Systems
+ *	Engineering Group at Lawrence Berkeley Laboratory.
+ * 4. Neither the name of the University nor of the Laboratory may be used
+ *    to endorse or promote products derived from this software without
+ *    specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ * @(#) $Header: /cvsroot/nsnam/ns-2/tcp/tcp.h,v 1.130 2007/09/29 01:07:22 sallyfloyd Exp $ (LBL)
+ */
 #ifndef ns_tcp_h
 #define ns_tcp_h
 
@@ -70,9 +104,6 @@
 #define CWND_HALF_WITH_MIN	0x00000200
 #define TCP_IDLE		0x00000400
 #define NO_OUTSTANDING_DATA     0x00000800
-#define CLOSE_SSTHRESH_ECNHAT   0x00001000
-#define CLOSE_CWND_ECNHAT       0x00002000
-
 
 /*
  * tcp_tick_:
@@ -143,7 +174,7 @@
 class TcpAgent : public Agent {
 	friend class XcpEndsys;
 public:
-	TcpAgent(); 
+	TcpAgent();
 	virtual ~TcpAgent() {free(tss);}
         virtual void recv(Packet*, Handler*);
 	virtual void timeout(int tno);
@@ -153,9 +184,6 @@
 
 	void trace(TracedVar* v);
 	virtual void advanceby(int delta);
-
-	// set deadline
-	void setdeadline(int ddl_in_us);
 protected:
 	virtual int window();
 	virtual double windowd();
@@ -166,7 +194,7 @@
 
 	virtual void delay_bind_init_all();
 	virtual int delay_bind_dispatch(const char *varName, const char *localName, TclObject *tracer);
-	
+
 	double boot_time_;	/* where between 'ticks' this sytem came up */
 	double overhead_;
 	double wnd_;
@@ -186,46 +214,15 @@
 	int numdupacksFrac_;	/* for a larger numdupacks_ with large */
 				/* windows */
 
-	// Tao: from the child class FullTcpAgent
-	// NOTE that the rtts are in us
-	int deadline; // deadline in us
-	double start_time;
-	// Tao: for the daprio
-	int prio_enable_;
-	// for pias
-	int pias_enable_;
-	int early_detect_;
-	int num_queue_;
-	int queue_thresh_[7];
-	// for karuna
-	int karuna_enable_;
-	int kar_seg_size_;
-
-	double karuna_cal_cwnd_;
-	double last_win_frac_;
-	double llast_win_frac_;
-	double last_win_size_;
-	double llast_win_size_;
-	double last_zeta_;
-	double last_win_rtt_;
-
-	double host_link_rate_;
-	int k_thresh_;
-	
-	double last_update_time;
-	double last_time_len;
-	double lrtt_total;
-	double lrtt_marked;
-	
 	/* connection and packet dynamics */
-virtual void output(int seqno, int reason = 0);
+	virtual void output(int seqno, int reason = 0);
 	virtual void send_much(int force, int reason, int maxburst = 0);
 	virtual void newtimer(Packet*);
 	virtual void dupack_action();		/* do this on dupacks */
 	virtual void send_one();		/* do this on 1-2 dupacks */
 	virtual void opencwnd();
 
-	virtual void slowdown(int how);			/* reduce cwnd/ssthresh */
+	void slowdown(int how);			/* reduce cwnd/ssthresh */
 	void ecn(int seqno);		/* react to quench */
 	virtual void set_initial_window();	/* set IW */
 	double initial_window();		/* what is IW? */
@@ -319,7 +316,7 @@
 	void spurious_timeout();
 
 	/* Timers */
-	RtxTimer rtx_timer_; 
+	RtxTimer rtx_timer_;
 	DelSndTimer delsnd_timer_;
 	BurstSndTimer burstsnd_timer_;
 	virtual void cancel_timers() {
@@ -430,38 +427,6 @@
 
 	/* Used for ECN */
 	int ecn_;		/* Explicit Congestion Notification */
-	
-	/* Mohammad: added for Ecn-Hat */
-	int ecnhat_;            
-	int ecnhat_smooth_alpha_;
-	double ecnhat_g_;
-	double ecnhat_alpha_;
-	int ecnhat_recalc_seq;
-	int ecnhat_maxseq;
-	int ecnhat_num_marked;
-	int ecnhat_total;
-	int ecnhat_enable_beta_;
-	double ecnhat_beta_;
-	int ecnhat_quadratic_beta_;
-	int ecnhat_tcp_friendly_;
-	double ecnhat_tcp_friendly_increase_;
-	int ecnhat_not_marked;
-	double ecnhat_mark_period;
-	int dctcp_enable_ap;
-	double target_wnd;
-
-	void update_ecnhat_alpha(Packet *pkt); /* updates the ecnhat alpha value */
-
-	/*
-	 * add support to l2dct
-	 */
-	int l2dct_enable_; // 1 l2dct enabled, 0 otherwise
-	double l2dct_w_min_; // w_min, 0.125 by default
-	double l2dct_w_max_; // w_max, 2.5 by default
-	double l2dct_size_min_; // 200KB by default
-	double l2dct_size_max_; // 1MB by default
-	double l2dct_w_c_;
-
 	int cong_action_;	/* Congestion Action.  True to indicate
 				   that the sender responded to congestion. */
         int ecn_burst_;		/* True when the previous ACK packet
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp-newreno.cc ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-newreno.cc
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp-newreno.cc	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-newreno.cc	2017-06-17 16:05:28.406177587 +0800
@@ -144,10 +144,7 @@
                  * all unnecessary Fast Retransmits.
                  */
                 reset_rtx_timer(1,0);
-		/* Mohammad: cut window by half when we have 3 dup ack */
-		if (ecnhat_) 
-			slowdown(CLOSE_SSTHRESH_HALF|CLOSE_CWND_HALF); 
-                output(last_ack_ + 1, TCP_REASON_DUPACK);	
+                output(last_ack_ + 1, TCP_REASON_DUPACK);
 		dupwnd_ = numdupacks_;
                 return;
         }
@@ -221,14 +218,9 @@
         }
 	++nackpack_;
 	ts_peer_ = tcph->ts();
-	
-	
-	if (ecnhat_) 
-		update_ecnhat_alpha(pkt);
-	
+
 	if (hdr_flags::access(pkt)->ecnecho() && ecn_)
 		ecn(tcph->seqno());
-
 	recv_helper(pkt);
 	recv_frto_helper(pkt);
 	if (tcph->seqno() > last_ack_) {
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp-sink.cc ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-sink.cc
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp-sink.cc	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-sink.cc	2017-06-17 16:05:28.402179588 +0800
@@ -189,7 +189,6 @@
 #if defined(TCP_DELAY_BIND_ALL) && 0
 #else /* ! TCP_DELAY_BIND_ALL */
 	bind("maxSackBlocks_", &max_sack_blocks_); // used only by sack
-	bind("ecnhat_", &ecnhat_);
 #endif /* TCP_DELAY_BIND_ALL */
 }
 
@@ -204,7 +203,6 @@
 	delay_bind_init_one("qs_enabled_");
 	delay_bind_init_one("RFC2581_immediate_ack_");
 	delay_bind_init_one("ecn_syn_");
-	delay_bind_init_one("ecnhat_");
 #if defined(TCP_DELAY_BIND_ALL) && 0
         delay_bind_init_one("maxSackBlocks_");
 #endif /* TCP_DELAY_BIND_ALL */
@@ -222,7 +220,6 @@
         if (delay_bind_bool(varName, localName, "qs_enabled_", &qs_enabled_, tracer)) return TCL_OK;
         if (delay_bind_bool(varName, localName, "RFC2581_immediate_ack_", &RFC2581_immediate_ack_, tracer)) return TCL_OK;
 	if (delay_bind_bool(varName, localName, "ecn_syn_", &ecn_syn_ ,tracer)) return TCL_OK;
-	if (delay_bind_bool(varName, localName, "ecnhat_", &ecnhat_ ,tracer)) return TCL_OK;
 #if defined(TCP_DELAY_BIND_ALL) && 0
         if (delay_bind(varName, localName, "maxSackBlocks_", &max_sack_blocks_, tracer)) return TCL_OK;
 #endif /* TCP_DELAY_BIND_ALL */
@@ -324,16 +321,9 @@
 			(of->ect() && of->ce()) )
 		// New report of congestion.  
 		acker_->update_ecn_unacked(1);
-	if ( (sf != 0 && sf->ect()) || of->ect() ) {
-		// Set EcnEcho bit.
-		if (ecnhat_) {
-			if ( (sf != 0 && sf->ect() && sf->ce()) ||
-			     (of->ect() && of->ce()) )
-			     nf->ecnecho() = 1;
-			else
-			     nf->ecnecho() = 0;  			
-		} else nf->ecnecho() = acker_->ecn_unacked();
-	}
+	if ( (sf != 0 && sf->ect()) || of->ect() )
+		// Set EcnEcho bit.  
+		nf->ecnecho() = acker_->ecn_unacked();
 	if (!of->ect() && of->ecnecho() ||
 		(sf != 0 && !sf->ect() && sf->ecnecho()) ) {
 		 // This is the negotiation for ECN-capability.
diff -uNr ./ns-allinone-2.34/ns-2.34/tcp/tcp-sink.h ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-sink.h
--- ./ns-allinone-2.34/ns-2.34/tcp/tcp-sink.h	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tcp/tcp-sink.h	2017-06-17 16:05:28.402179588 +0800
@@ -128,7 +128,7 @@
 	double lastreset_; 	/* W.N. used for detecting packets  */
 				/* from previous incarnations */
         int ecn_syn_;           /* allow SYN/ACK packets to be ECN-capable */
-	int ecnhat_;            /* Mohammad: added to enable ECNHAT receiver behavior */
+
 };
 
 class DelAckSink;
diff -uNr ./ns-allinone-2.34/ns-2.34/tools/queue-monitor.cc ./ori-ns-allinone-2.34/ns-2.34/tools/queue-monitor.cc
--- ./ns-allinone-2.34/ns-2.34/tools/queue-monitor.cc	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tools/queue-monitor.cc	2017-06-17 16:05:28.602079571 +0800
@@ -41,8 +41,6 @@
 #include "trace.h"
 #include <math.h>
 
-#include "ip.h"
-
 int QueueMonitor::command(int argc, const char*const* argv)
 {
 	Tcl& tcl = Tcl::instance();
@@ -247,20 +245,6 @@
 		prevTime_ = now;
 	}
 
-	//Shuang: count small flow arrivals
-	hdr_ip* iph = hdr_ip::access(p);
-	int prio = iph->prio() / 1460;
-	if (prio < 100000 && pktsz > 100) {
-		karrivals_[calc_prio(prio)] ++;
-	}
-
-	//Shuang: count ack arrivals
-	//hdr_rcp* rh = hdr_rcp::access(p);
-	//if (rh->RCP_pkt_type() == RCP_ACK) {
-	//	ack_arrivals_++;
-	//}
-
-
 	barrivals_ += pktsz;
 	parrivals_++;
 	size_ += pktsz;
@@ -289,13 +273,6 @@
 	pkts_--;
 	bdepartures_ += pktsz;
 	pdepartures_++;
-	
-	//Shuang: count ack departure
-	//hdr_rcp* rh = hdr_rcp::access(p);
-	//if (rh->RCP_pkt_type() == RCP_ACK) {
-	//	ack_departures_++;
-	//}
-
 	if (bytesInt_)
 		bytesInt_->newPoint(now, double(size_));
 	if (pktsInt_)
@@ -325,19 +302,6 @@
 	bdrops_ += pktsz;
 	pdrops_++;
 
-	//Shuang: count small flow dropping
-	hdr_ip* iph = hdr_ip::access(p);
-	int prio = iph->prio() / 1460;
-	if (prio < 100000 && pktsz > 100) {
-		kdrops_[calc_prio(prio)] ++;
-	}
-	//Shuang: count ack dropping
-	//hdr_rcp* rh = hdr_rcp::access(p);
-	//if (rh->RCP_pkt_type() == RCP_ACK) {
-	//	ack_drops_++;
-	//}
-
-
 	if (pf->qs())
 		qs_drops_++;
 
@@ -349,20 +313,6 @@
 		printStats();
 }
 
-int QueueMonitor::calc_prio(int prio)
-{
-	if (prio <= 10)
-		return prio;
-	if (prio <= 100)
-		return 10 + prio / 10;
-	if (prio <= 1000)
-		return 20 + prio / 100;
-	if (prio <= 10000)
-		return 30 + prio / 1000;
-	if (prio <= 100000)
-		return 40 + prio / 10000;
-}
-
 // The procedure to estimate the rate of the incoming traffic
 void QueueMonitor::estimateRate(Packet *pkt) {
 	
@@ -498,6 +448,7 @@
  * ############################################################
  */
 
+#include "ip.h"
 QueueMonitorCompat::QueueMonitorCompat()
 {
 	memset(pkts_, 0, sizeof(pkts_));
diff -uNr ./ns-allinone-2.34/ns-2.34/tools/queue-monitor.h ./ori-ns-allinone-2.34/ns-2.34/tools/queue-monitor.h
--- ./ns-allinone-2.34/ns-2.34/tools/queue-monitor.h	2017-02-11 21:16:13.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tools/queue-monitor.h	2017-06-17 16:05:28.602079571 +0800
@@ -49,8 +49,7 @@
 		size_(0), pkts_(0),
 		parrivals_(0), barrivals_(0),
 		pdepartures_(0), bdepartures_(0),
-		pdrops_(0), pmarks_(0), bdrops_(0), num_monitor_(50),
-		ack_arrivals_(0), ack_drops_(0), ack_departures_(0),
+		pdrops_(0), pmarks_(0), bdrops_(0), 
 			 qs_pkts_(0), qs_bytes_(0), qs_drops_(0),
 		keepRTTstats_(0), maxRTT_(1), numRTTs_(0), binsPerSec_(10),
 		keepSeqnoStats_(0), maxSeqno_(1000), 
@@ -60,22 +59,7 @@
 		k_(0.1), 
 		estRate_(0.0),
 		temp_size_(0) {
-
-		//Shuang: monitor the kth drop
-		for (int i = 0; i < num_monitor_; i++) {
-			char buf[20];
-			memset(buf, 0, sizeof(buf));
-			sprintf(buf, "kdrops%d", i);
-			bind(buf, &kdrops_[i]);
-			memset(buf, 0, sizeof(buf));
-			sprintf(buf, "karrivals%d", i);
-			bind(buf, &karrivals_[i]);
-		}
-		bind("num_monitor_", &num_monitor_);
-		bind("ack_arrivals_", &ack_arrivals_);
-		bind("ack_drops_", &ack_drops_);
-		bind("ack_departures_", &ack_departures_);
-
+		
 		bind("size_", &size_);
 		bind("pkts_", &pkts_);
 		bind("parrivals_", &parrivals_);
@@ -166,12 +150,6 @@
 	int pdrops_;
 	int pmarks_;
 	int bdrops_;
-	int kdrops_[50];	//Shuang: count the num of kth drop
-	int karrivals_[50];	//Shuang: count the num of kth arrival
-	int num_monitor_;	//Shuang: maximum of k to monitor
-	int ack_arrivals_;  //Shuang: number of ack pkts arrival
-	int ack_drops_;		//Shuang: number of ack pkts dropped
-	int ack_departures_;	//Shuang: number of ack pkts departured
 
 	int qs_pkts_;			/* Number of Quick-Start packets */
 	int qs_bytes_;			/* Number of Quick-Start bytes */
@@ -214,7 +192,6 @@
 	void estimateRate(Packet *p);
 	void keepRTTstats(Packet *p);
 	void keepSeqnoStats(Packet *p);
-	int calc_prio(int prio);
 };
 
 class SnoopQueue : public Connector {
diff -uNr ./ns-allinone-2.34/ns-2.34/tools/ranvar.cc ./ori-ns-allinone-2.34/ns-2.34/tools/ranvar.cc
--- ./ns-allinone-2.34/ns-2.34/tools/ranvar.cc	2017-02-11 21:08:39.000000000 +0800
+++ ./ori-ns-allinone-2.34/ns-2.34/tools/ranvar.cc	2017-06-17 16:05:28.602079571 +0800
@@ -216,7 +216,7 @@
 	// ACM Transactions on mathematical software, Vol. 26, No. 3, Sept. 2000
 	if (alpha_ < 1) {
 		double u = rng_->uniform(1.0);
-		return GammaRandomVariable(1.0 + alpha_, beta_).value() * pow (u, 1.0 / alpha_);
+		return GammaRandomVariable::GammaRandomVariable(1.0 + alpha_, beta_).value() * pow (u, 1.0 / alpha_);
 	}
 	
 	double x, v, u;
